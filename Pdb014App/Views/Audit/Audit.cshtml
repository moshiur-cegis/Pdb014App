
@{
    ViewData["Title"] = "Audit";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<div class="row">
    <div class="offset-md-3 col-md-6 offset-md-3">
        <fieldset>
            <legend>Pole Data Audit</legend>
            <form method="post" asp-action="PoleDataImport" enctype="multipart/form-data">
                <div class="row align-content-md-center">
                    <div class="col-md-4">
                        <input type="file" id="fUpload" name="file" class="form-control" />
                    </div>
                    <div class="col-md-8">
                        <input type="submit" id="btnUpload" value="Upload" class="btn btn-success float-right" />
                    </div>
                </div>
            </form>
        </fieldset>
    </div>
</div>


@section Scripts
{
    <script type="text/javascript">
        @*$(document).ready(function () {


            $("#btnUpload").on("click",
                function () {


                    var fileExtension = ['xls', 'xlsx'];
                    var filename = $('#fUpload').val();
                    if (filename.length == 0) {
                        alert("Please select a file.");
                        return false;
                    } else {
                        var extension = filename.replace(/^.*\./, '');
                        if ($.inArray(extension, fileExtension) == -1) {
                            alert("Please select only excel files.");
                            return false;
                        }
                    }

                    var fdata = new FormData();
                    var fileUpload = $("#fUpload").get(0);
                    var files = fileUpload.files;
                    fdata.append(files[0].name, files[0]);


                    $.ajax({
                        type: "POST",
                        url: "@Url.Action("OnPostImport")",
                        //dataType: "json",
                        data: { file: fdata },
                        contentType: false,


                        success: function (response) {
                            alert("OK");
                            if (response.length == 0)
                                alert('Some error occured while uploading');
                            else {
                                $('#dvData').html(response);
                            }
                        },
                        error: function(e) {
                            $('#dvData').html(e.responseText);
                        }
                        //complete: $("#busy-indicator").fadeOut(150)
                    });
                   // return false;
                });

        });*@


        //$(document).ready(function() {
        //    $('#btnUpload').on('click',
        //        function() {
        //            var fileExtension = ['xls', 'xlsx'];
        //            var filename = $('#fUpload').val();
        //            if (filename.length == 0) {
        //                alert("Please select a file.");
        //                return false;
        //            } else {
        //                var extension = filename.replace(/^.*\./, '');
        //                if ($.inArray(extension, fileExtension) == -1) {
        //                    alert("Please select only excel files.");
        //                    return false;
        //                }
        //            }
        //            var fdata = new FormData();
        //            var fileUpload = $("#fUpload").get(0);
        //            var files = fileUpload.files;
        //            fdata.append(files[0].name, files[0]);
        //            $.ajax({
        //                type: "POST",
        //                url: "/ImportExport?handler=Import",
        //                beforeSend: function(xhr) {
        //                    xhr.setRequestHeader("XSRF-TOKEN",
        //                        $('input:hidden[name="__RequestVerificationToken"]').val());
        //                },
        //                data: fdata,
        //                contentType: false,
        //                processData: false,
        //                success: function(response) {
        //                    if (response.length == 0)
        //                        alert('Some error occured while uploading');
        //                    else {
        //                        $('#dvData').html(response);
        //                    }
        //                },
        //                error: function(e) {
        //                    $('#dvData').html(e.responseText);
        //                }
        //            });
        //        })
        //});
    </script>
}
