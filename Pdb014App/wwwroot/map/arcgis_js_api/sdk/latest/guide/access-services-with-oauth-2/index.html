<!DOCTYPE html><html><head><meta charset="utf-8"><meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="content-language" content="en"><meta name="last-modified" content="Thu Jan 09 2020 11:33:52 GMT-0800 (Pacific Standard Time)"><meta name="product" content="js-api-arcgis"><meta name="version" content="4.x"><meta name="subject" content="DEVELOPER,WEB,WEB APPLICATIONS,MOBILE"><meta name="subject_label" content="DEVELOPER,WEB,WEB APPLICATIONS,MOBILE"><meta name="sub_category" content="JavaScript API"><meta name="sub_category_label" content="ArcGIS API for JavaScript"><meta name="content_type" content="Guide"><meta name="content_type_label" content="Guide"><meta name="search-collection" content="help"><meta name="search-category" content="help-api,help-api-guide"><meta name="description" content="Build an app that uses named user login credentials to access secure services."><meta name="keywords" content="login,OAuth 2.0,security,credentials,named user,ArcGIS Traffic service,Map,MapView,item,app,2d"><title>Access services with OAuth 2.0 | ArcGIS API for JavaScript 4.14</title><link rel="shortcut icon" href="../../../../favicon.ico"><link rel="stylesheet" href="../../../assets/css/default.css"><link rel="stylesheet" href="../../../assets/css/sdk/sdks.css"></head><body><developers-account-notifications></developers-account-notifications><div class="wrapper"><header class="top-nav top-nav-hover-top"><div class="grid-container"><div class="column-24"><span class="top-nav-title font-size-1">Go to <a href="https://developers.arcgis.com/javascript/">Latest version (official documentation)</a></span></div></div></header><developers-active-toggle key="secondaryNav"></developers-active-toggle><div class="secondary-nav" data-target="secondaryNav"><div class="secondary-nav-container"><h3 class="secondary-nav-title tablet-hide"><a href="../../../" class="secondary-nav-title-link"><svg class="svg-icon" viewBox="0 0 48 53"><path d="M24.16 2.12L46 8v33.66l-22.14 9.23L2 45V11.9l22.16-9.78M24 0L0 10.6v35.92L24 53l24-10V6.48L24 0zM9 11v30h30V11zm16.33 23.4c0 2.92-1.72 4.25-4.21 4.25a4.37 4.37 0 0 1-4.23-2.58l2.29-1.39c.45.79.85 1.45 1.82 1.45s1.51-.36 1.51-1.77v-9.59h2.82zM32 38.65a5.4 5.4 0 0 1-5.13-2.88l2.29-1.33a3.07 3.07 0 0 0 2.78 1.71c1.17 0 1.91-.58 1.91-1.39 0-1-.76-1.31-2.05-1.87l-.7-.3c-2-.87-3.39-2-3.39-4.25 0-2.12 1.61-3.73 4.13-3.73a4.18 4.18 0 0 1 4 2.26l-2.2 1.41a1.91 1.91 0 0 0-1.81-1.21 1.23 1.23 0 0 0-1.35 1.21c0 .84.53 1.18 1.73 1.71l.71.3c2.39 1 3.74 2.07 3.74 4.43 0 2.54-1.99 3.93-4.66 3.93z"/></svg> JavaScript API</a> <a href="../../.." class="secondary-nav-title-link">4.14</a> <a href="../../../latest/guide/index.html" class="secondary-nav-title-link">Guide</a></h3><h3 class="secondary-nav-title tablet-show"><svg class="svg-icon" viewBox="0 0 48 53"><path d="M24.16 2.12L46 8v33.66l-22.14 9.23L2 45V11.9l22.16-9.78M24 0L0 10.6v35.92L24 53l24-10V6.48L24 0zM9 11v30h30V11zm16.33 23.4c0 2.92-1.72 4.25-4.21 4.25a4.37 4.37 0 0 1-4.23-2.58l2.29-1.39c.45.79.85 1.45 1.82 1.45s1.51-.36 1.51-1.77v-9.59h2.82zM32 38.65a5.4 5.4 0 0 1-5.13-2.88l2.29-1.33a3.07 3.07 0 0 0 2.78 1.71c1.17 0 1.91-.58 1.91-1.39 0-1-.76-1.31-2.05-1.87l-.7-.3c-2-.87-3.39-2-3.39-4.25 0-2.12 1.61-3.73 4.13-3.73a4.18 4.18 0 0 1 4 2.26l-2.2 1.41a1.91 1.91 0 0 0-1.81-1.21 1.23 1.23 0 0 0-1.35 1.21c0 .84.53 1.18 1.73 1.71l.71.3c2.39 1 3.74 2.07 3.74 4.43 0 2.54-1.99 3.93-4.66 3.93z"/></svg> JavaScript API <span class="secondary-nav-breadcrumb">Guide</span></h3><developers-active-toggle toggle="secondaryNavToggle" target="secondaryNavList"></developers-active-toggle><nav id="secondaryNavList" class="secondary-nav-list"><ul class="secondary-nav-items" data-target="secondaryNav"><li class="secondary-nav-item"><a href="../../../" class="secondary-nav-link">Home</a></li><li class="secondary-nav-item"><a href="../../../latest/guide/" class="is-active secondary-nav-link">Guide</a></li><li class="secondary-nav-item"><a href="../../../latest/sample-code/" class="secondary-nav-link">Sample Code</a></li><li class="secondary-nav-item"><a href="../../../latest/api-reference/" class="secondary-nav-link">API Reference</a></li><li class="secondary-nav-item"><a href="../../../latest/showcase/" class="secondary-nav-link">Showcase</a></li><li class="secondary-nav-item"><a href="../../../support/" class="secondary-nav-link">Support</a></li></ul></nav><button id="secondaryNavToggle" class="secondary-nav-toggle" data-toggle="secondaryNav"><svg class="svg-icon" viewBox="0 0 16 16"><path d="M15.5 5l-7 7-7-7z"/></svg><span class="secondary-nav-toggle-label">Menu</span></button></div><button tabindex="-1" class="secondary-nav-canvas" data-toggle="secondaryNav"></button></div><header class="sub-nav sub-nav-purple"><div class="grid-container"><h1 class="sub-nav-title font-size-6 avenir-light leader-2 trailer-2 text-white">Access services with OAuth 2.0</h1></div></header><div id="skip-to-content"><div class="grid-container leader-1"><div class="column-4 post-1 trailer-2 tablet-hide"><aside class="accordion side-nav column-4 guide"><a href="../../../latest/guide/" class="side-nav-link">Overview</a> <a href="../../../latest/guide/release-notes/" class="side-nav-link">Release notes</a> <a href="../../../latest/guide/get-api/" class="side-nav-link">Get the API</a> <a href="../../../latest/guide/quick-start/" class="side-nav-link">Quick Start</a><div class="js-accordion"><div class="accordion-section is-active"><h4 class="accordion-title">Tutorials</h4><nav class="accordion-content"><a href="../../../latest/guide/create-a-starter-app/" class="side-nav-link">Create a starter app</a></nav><nav class="accordion-content"><a href="../../../latest/guide/select-a-basemap/" class="side-nav-link">Select a basemap</a></nav><nav class="accordion-content"><a href="../../../latest/guide/add-layers-to-a-map/" class="side-nav-link">Add layers to a map</a></nav><nav class="accordion-content"><a href="../../../latest/guide/style-feature-layers/" class="side-nav-link">Style feature layers</a></nav><nav class="accordion-content"><a href="../../../latest/guide/configure-pop-ups/" class="side-nav-link">Configure pop-ups</a></nav><nav class="accordion-content"><a href="../../../latest/guide/query-a-feature-layer/" class="side-nav-link">Query a feature layer</a></nav><nav class="accordion-content"><a href="../../../latest/guide/filter-a-feature-layer/" class="side-nav-link">Filter a feature layer</a></nav><nav class="accordion-content"><a href="../../../latest/guide/add-a-layer-from-an-item/" class="side-nav-link">Add a layer from an item</a></nav><nav class="accordion-content"><a href="../../../latest/guide/display-a-styled-vector-basemap/" class="side-nav-link">Display a styled vector basemap</a></nav><nav class="accordion-content"><a href="../../../latest/guide/display-a-web-map/" class="side-nav-link">Display a web map</a></nav><nav class="accordion-content"><a href="../../../latest/guide/add-layers-to-a-3d-scene/" class="side-nav-link">Add layers to a 3D scene</a></nav><nav class="accordion-content"><a href="../../../latest/guide/display-a-web-scene/" class="side-nav-link">Display a web scene</a></nav><nav class="accordion-content"><a href="../../../latest/guide/get-map-coordinates/" class="side-nav-link">Get map coordinates</a></nav><nav class="accordion-content"><a href="../../../latest/guide/draw-graphics/" class="side-nav-link">Draw graphics</a></nav><nav class="accordion-content"><a href="../../../latest/guide/display-point-line-and-polygon-graphics/" class="side-nav-link">Display point, line, and polygon graphics</a></nav><nav class="accordion-content"><a href="../../../latest/guide/display-and-track-your-location/" class="side-nav-link">Display and track your location</a></nav><nav class="accordion-content"><a href="../../../latest/guide/buffer-and-intersect-geometry/" class="side-nav-link">Buffer and intersect geometry</a></nav><nav class="accordion-content"><a href="../../../latest/guide/search-for-an-address/" class="side-nav-link">Search for an address</a></nav><nav class="accordion-content"><a href="../../../latest/guide/find-places/" class="side-nav-link">Find places</a></nav><nav class="accordion-content"><a href="../../../latest/guide/driving-directions/" class="side-nav-link">Driving directions</a></nav><nav class="accordion-content"><a href="../../../latest/guide/get-a-route-and-directions/" class="side-nav-link">Get a route and directions</a></nav><nav class="accordion-content"><a href="../../../latest/guide/get-drive-time/" class="side-nav-link">Get drive time</a></nav><nav class="accordion-content"><a href="../../../latest/guide/access-services-with-oauth-2/" class="side-nav-link is-active">Access services with OAuth 2.0</a></nav></div></div><div class="js-accordion"><div class="accordion-section"><h4 class="accordion-title">Core Concepts</h4><nav class="accordion-content"><a href="../../../latest/guide/maps-and-views/" class="side-nav-link">Maps and Views</a></nav><nav class="accordion-content"><a href="../../../latest/guide/layers-and-data/" class="side-nav-link">Layers and data</a></nav><nav class="accordion-content"><a href="../../../latest/guide/programming-patterns/" class="side-nav-link">Programming patterns</a></nav></div></div><div class="js-accordion"><div class="accordion-section"><h4 class="accordion-title">Data Visualization</h4><nav class="accordion-content"><a href="../../../latest/guide/visualization-overview/" class="side-nav-link">Visualization Overview</a></nav><nav class="accordion-content"><a href="../../../latest/guide/creating-visualizations-manually/" class="side-nav-link">Creating visualizations manually</a></nav><nav class="accordion-content"><a href="../../../latest/guide/visualization-best-practices/" class="side-nav-link">Visualization best practices</a></nav><nav class="accordion-content"><a href="../../../latest/guide/esri-color-ramps/" class="side-nav-link">Esri Color Ramps</a></nav><nav class="accordion-content"><a href="../../../latest/guide/visualizing-points-3d/" class="side-nav-link">Visualizing points with 3D symbols</a></nav><nav class="accordion-content"><a href="../../../latest/guide/labeling/" class="side-nav-link">Labeling</a></nav><nav class="accordion-content"><a href="../../../latest/guide/working-with-scene-layers/" class="side-nav-link">Working with scene layers</a></nav></div></div><div class="js-accordion"><div class="accordion-section"><h4 class="accordion-title">Building your UI</h4><nav class="accordion-content"><a href="../../../latest/guide/view-ui/" class="side-nav-link">View UI</a></nav><nav class="accordion-content"><a href="../../../latest/guide/custom-widget/" class="side-nav-link">Widget Development</a></nav><nav class="accordion-content"><a href="../../../latest/guide/styling/" class="side-nav-link">Styling</a></nav></div></div><div class="js-accordion"><div class="accordion-section"><h4 class="accordion-title">Working with ArcGIS Online and Enterprise</h4><nav class="accordion-content"><a href="../../../latest/guide/working-with-platform/" class="side-nav-link">Working with the ArcGIS platform</a></nav><nav class="accordion-content"><a href="../../../latest/guide/secure-resources/" class="side-nav-link">Access Secure Resources</a></nav></div></div><div class="js-accordion"><div class="accordion-section"><h4 class="accordion-title">Developer Tooling</h4><nav class="accordion-content"><a href="../../../latest/guide/using-frameworks/" class="side-nav-link">Frameworks</a></nav><nav class="accordion-content"><a href="../../../latest/guide/angular/" class="side-nav-link">Angular</a></nav><nav class="accordion-content"><a href="../../../latest/guide/react/" class="side-nav-link">React</a></nav><nav class="accordion-content"><a href="../../../latest/guide/ember/" class="side-nav-link">Ember</a></nav><nav class="accordion-content"><a href="../../../latest/guide/vue/" class="side-nav-link">Vue</a></nav><nav class="accordion-content"><a href="../../../latest/guide/arcgis-cli/" class="side-nav-link">ArcGIS CLI</a></nav><nav class="accordion-content"><a href="../../../latest/guide/webpack/" class="side-nav-link">Webpack</a></nav><nav class="accordion-content"><a href="../../../latest/guide/esri-loader/" class="side-nav-link">esri-loader</a></nav><nav class="accordion-content"><a href="../../../latest/guide/typescript-setup/" class="side-nav-link">TypeScript Setup</a></nav></div></div><div class="js-accordion"><div class="accordion-section"><h4 class="accordion-title">Migrating from 3.x</h4><nav class="accordion-content"><a href="../../../latest/guide/choose-version/" class="side-nav-link">Choose a version</a></nav><nav class="accordion-content"><a href="../../../latest/guide/migrating/" class="side-nav-link">Migrating from 3.x to 4.14</a></nav><nav class="accordion-content"><a href="../../../latest/guide/functionality-matrix/" class="side-nav-link">3.x to 4.x functionality matrix</a></nav></div></div><div class="js-accordion"><div class="accordion-section"><h4 class="accordion-title">Reference</h4><nav class="accordion-content"><a href="../../../latest/guide/arcade/" class="side-nav-link">Arcade</a></nav><nav class="accordion-content"><a href="../../../latest/guide/cors/" class="side-nav-link">CORS</a></nav><nav class="accordion-content"><a href="../../../latest/guide/proxies/" class="side-nav-link">Proxy pages</a></nav><nav class="accordion-content"><a href="../../../latest/guide/esri-icon-font/" class="side-nav-link">Esri Icon Font</a></nav><nav class="accordion-content"><a href="../../../latest/guide/esri-web-style-symbols-2d/" class="side-nav-link">Esri Web Style Symbols (2D)</a></nav><nav class="accordion-content"><a href="../../../latest/guide/esri-web-style-symbols-3d/" class="side-nav-link">Esri Web Style Symbols (3D)</a></nav><nav class="accordion-content"><a href="../../../latest/guide/localization/" class="side-nav-link">Localization</a></nav><nav class="accordion-content"><a href="../../../latest/guide/licensing/" class="side-nav-link">Licensing &amp; Attribution</a></nav><nav class="accordion-content"><a href="../../../latest/guide/system-requirements/" class="side-nav-link">System requirements</a></nav><nav class="accordion-content"><a href="../../../latest/guide/faq/" class="side-nav-link">FAQ</a></nav><nav class="accordion-content"><a href="../../../latest/guide/migrating-from-google-maps-to-arcgis-javascript-api/" class="side-nav-link">Migrating from Google Maps API</a></nav><nav class="accordion-content"><a href="../../../latest/guide/implementing-accessor/" class="side-nav-link">Implementing Accessor</a></nav></div></div></aside><div class="column-4 js-sticky scroll-show tablet-hide" data-top="46"><a href="#" class="btn btn-fill btn-clear">Back to Top</a></div></div><div class="column-24 trailer-1 tablet-show"><select class="select-full trailer-half js-select-nav"><option value="../../../latest/guide/">Overview</option><option value="../../../latest/guide/release-notes/">Release notes</option><option value="../../../latest/guide/get-api/">Get the API</option><option value="../../../latest/guide/quick-start/">Quick Start</option><optgroup label="Tutorials"><option value="../../../latest/guide/create-a-starter-app/">Create a starter app</option><option value="../../../latest/guide/select-a-basemap/">Select a basemap</option><option value="../../../latest/guide/add-layers-to-a-map/">Add layers to a map</option><option value="../../../latest/guide/style-feature-layers/">Style feature layers</option><option value="../../../latest/guide/configure-pop-ups/">Configure pop-ups</option><option value="../../../latest/guide/query-a-feature-layer/">Query a feature layer</option><option value="../../../latest/guide/filter-a-feature-layer/">Filter a feature layer</option><option value="../../../latest/guide/add-a-layer-from-an-item/">Add a layer from an item</option><option value="../../../latest/guide/display-a-styled-vector-basemap/">Display a styled vector basemap</option><option value="../../../latest/guide/display-a-web-map/">Display a web map</option><option value="../../../latest/guide/add-layers-to-a-3d-scene/">Add layers to a 3D scene</option><option value="../../../latest/guide/display-a-web-scene/">Display a web scene</option><option value="../../../latest/guide/get-map-coordinates/">Get map coordinates</option><option value="../../../latest/guide/draw-graphics/">Draw graphics</option><option value="../../../latest/guide/display-point-line-and-polygon-graphics/">Display point, line, and polygon graphics</option><option value="../../../latest/guide/display-and-track-your-location/">Display and track your location</option><option value="../../../latest/guide/buffer-and-intersect-geometry/">Buffer and intersect geometry</option><option value="../../../latest/guide/search-for-an-address/">Search for an address</option><option value="../../../latest/guide/find-places/">Find places</option><option value="../../../latest/guide/driving-directions/">Driving directions</option><option value="../../../latest/guide/get-a-route-and-directions/">Get a route and directions</option><option value="../../../latest/guide/get-drive-time/">Get drive time</option><option value="../../../latest/guide/access-services-with-oauth-2/" selected="selected">Access services with OAuth 2.0</option></optgroup><optgroup label="Core Concepts"><option value="../../../latest/guide/maps-and-views/">Maps and Views</option><option value="../../../latest/guide/layers-and-data/">Layers and data</option><option value="../../../latest/guide/programming-patterns/">Programming patterns</option></optgroup><optgroup label="Data Visualization"><option value="../../../latest/guide/visualization-overview/">Visualization Overview</option><option value="../../../latest/guide/creating-visualizations-manually/">Creating visualizations manually</option><option value="../../../latest/guide/visualization-best-practices/">Visualization best practices</option><option value="../../../latest/guide/esri-color-ramps/">Esri Color Ramps</option><option value="../../../latest/guide/visualizing-points-3d/">Visualizing points with 3D symbols</option><option value="../../../latest/guide/labeling/">Labeling</option><option value="../../../latest/guide/working-with-scene-layers/">Working with scene layers</option></optgroup><optgroup label="Building your UI"><option value="../../../latest/guide/view-ui/">View UI</option><option value="../../../latest/guide/custom-widget/">Widget Development</option><option value="../../../latest/guide/styling/">Styling</option></optgroup><optgroup label="Working with ArcGIS Online and Enterprise"><option value="../../../latest/guide/working-with-platform/">Working with the ArcGIS platform</option><option value="../../../latest/guide/secure-resources/">Access Secure Resources</option></optgroup><optgroup label="Developer Tooling"><option value="../../../latest/guide/using-frameworks/">Frameworks</option><option value="../../../latest/guide/angular/">Angular</option><option value="../../../latest/guide/react/">React</option><option value="../../../latest/guide/ember/">Ember</option><option value="../../../latest/guide/vue/">Vue</option><option value="../../../latest/guide/arcgis-cli/">ArcGIS CLI</option><option value="../../../latest/guide/webpack/">Webpack</option><option value="../../../latest/guide/esri-loader/">esri-loader</option><option value="../../../latest/guide/typescript-setup/">TypeScript Setup</option></optgroup><optgroup label="Migrating from 3.x"><option value="../../../latest/guide/choose-version/">Choose a version</option><option value="../../../latest/guide/migrating/">Migrating from 3.x to 4.14</option><option value="../../../latest/guide/functionality-matrix/">3.x to 4.x functionality matrix</option></optgroup><optgroup label="Reference"><option value="../../../latest/guide/arcade/">Arcade</option><option value="../../../latest/guide/cors/">CORS</option><option value="../../../latest/guide/proxies/">Proxy pages</option><option value="../../../latest/guide/esri-icon-font/">Esri Icon Font</option><option value="../../../latest/guide/esri-web-style-symbols-2d/">Esri Web Style Symbols (2D)</option><option value="../../../latest/guide/esri-web-style-symbols-3d/">Esri Web Style Symbols (3D)</option><option value="../../../latest/guide/localization/">Localization</option><option value="../../../latest/guide/licensing/">Licensing &amp; Attribution</option><option value="../../../latest/guide/system-requirements/">System requirements</option><option value="../../../latest/guide/faq/">FAQ</option><option value="../../../latest/guide/migrating-from-google-maps-to-arcgis-javascript-api/">Migrating from Google Maps API</option><option value="../../../latest/guide/implementing-accessor/">Implementing Accessor</option></optgroup></select></div><main class="column-15 tablet-column-12 content-face"><div class="js-container-guide lab-content"><h2 id="overview">Overview</h2><p><strong>You will learn:</strong> how to build an app that uses named user login credentials to access secure services.</p><p>Applications can implement several <a href="https://developers.arcgis.com/documentation/core-concepts/security-and-authentication/">authentication patterns</a> based on <a href="https://developers.arcgis.com/documentation/core-concepts/security-and-authentication/what-is-oauth-2/">OAuth 2.0</a> to access<afd-term term="arcgis online">ArcGIS Online</afd-term>premium services and secure content. There are two workflows that applications can use to authenticate with ArcGIS:</p><ul><li><a href="https://developers.arcgis.com/documentation/core-concepts/security-and-authentication/signing-in-arcgis-online-users/">Named user login</a> allows users of ArcGIS Online to use their ArcGIS Online account to log into your application are similar to signing into an app with your Google and Facebook account.</li><li><a href="https://developers.arcgis.com/documentation/core-concepts/security-and-authentication/accessing-arcgis-online-services/">App login</a> allows your application to authenticate with Arcgis Online and obtain credentials to access premium services for users without ArcGIS Online accounts.</li></ul><p>You can learn more about <a href="https://developers.arcgis.com/documentation/core-concepts/security-and-authentication/signing-in-arcgis-online-users/">implementing named user logins</a> and <a href="https://developers.arcgis.com/documentation/core-concepts/security-and-authentication/accessing-arcgis-online-services/">implementing app logins</a> in the <a href="https://developers.arcgis.com/documentation/core-concepts/security-and-authentication/#authentication-patterns">authentication patterns</a> documentation.</p><p>In this tutorial you will implement OAuth 2.0 to allow users to sign in with their ArcGIS Online account so they can access the ArcGIS Traffic Layer service. Unlike our other JavaScript tutorials, you won't be able to use CodePen and you'll have to run the code locally.</p><h2 id="steps">Steps</h2><h4 id="pre-configure-oauth-2.0-for-your-app">Pre-configure OAuth 2.0 for your app</h4><ol><li><p><a href="https://developers.arcgis.comhttps://developers.arcgis.com/sign-in/?redirect_uri=https://developers.arcgis.com/latest/guide/access-services-with-oauth-2/">Sign in</a> to your ArcGIS account. If you don't already have one, <a href="/sign-up/">sign-up</a> for free.</p><a class="lab-extra-info tooltip tooltip-multiline" aria-label="You need to sign in so you can save your work."><svg class="svg-icon" viewBox="0 0 16 16"><path d="M8 .15A7.85 7.85 0 1 0 15.85 8 7.85 7.85 0 0 0 8 .15zM9 14H7v-2h2zm1.158-5.566C9.468 9.09 9 9.488 9 10.337V11H7v-1c0-2.022 2.93-2.428 2.93-4.413a1.501 1.501 0 0 0-1.58-1.624c-.832 0-1.238.323-1.449 1.315A3.624 3.624 0 0 0 6.838 6H5.105l.039-.803c.213-1.568 1.388-2.472 3.223-2.472a2.721 2.721 0 0 1 2.985 2.816 3.203 3.203 0 0 1-1.194 2.893z"/></svg></a></li><li><p>At the top right of the <strong>main menu</strong>, click <svg class="svg-icon" xmlns="http://www.w3.org/2000/svg"><use xlink:href="/assets/img/icons/navigation_sprite.svg#plus-16-f"></use></svg><svg class="svg-icon" xmlns="http://www.w3.org/2000/svg"><use xlink:href="/assets/img/icons/navigation_sprite.svg#chevron-down-16-f"></use></svg> &gt; <strong>New Application &gt; Create New Application</strong></p><ul><li><strong>Title:</strong> <code>Access Premium Services App</code></li><li><strong>Tags:</strong> <code>OAuth</code></li><li><strong>Description:</strong> <code>Access Premium Services App</code></li><li>Click <strong>Register New Application</strong></li></ul></li><li><p>Click the <strong>Authentication tab</strong> add <code>localhost</code> or your <code>server name</code> for the redirect URI:</p><aside class="js-accordion accordion"><div class="accordion-section"><span class="accordion-title"><svg class="svg-icon accordion-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M8 .15A7.85 7.85 0 1 0 15.85 8 7.85 7.85 0 0 0 8 .15zM9 12H7V6h2zm0-7H7V3h2z"/></svg><div class="accordion-content"><p>Setting the redirect URL correctly is very important. If you attempt a login attempt from anywhere other than a whitelisted (Redirect URI) location, the request will be denied.</p></div></span></div></aside><ul><li><strong>Redirect URI</strong> <code>http://localhost/</code></li></ul></li><li><p>Copy the <strong>Client ID</strong> value as you'll need this in the next step.</p></li></ol><div class="panel panel-no-border trailer-1"><p>NOTE: The terms Client ID and App ID are used interchangeably in this tutorial.</p></div><h4 id="create-your-app's-html">Create your app's HTML</h4><ol start="5"><li><p>Instead of using CodePen, create a file in your <code>//localhost</code> web directory and add the following code to create a basic starter app.</p><aside class="js-accordion accordion"><div class="accordion-section"><span class="accordion-title"><svg class="svg-icon accordion-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M8 .15A7.85 7.85 0 1 0 15.85 8 7.85 7.85 0 0 0 8 .15zM9 12H7V6h2zm0-7H7V3h2z"/></svg><div class="accordion-content"><p>If you are using Windows and IIS, use this path <code>c:\inetpub\wwwroot\privatelayer.html</code>. If you are using a Mac with Apache, use <code>/var/www/privatelayer.html</code>.</p></div></span></div></aside><br><pre><code class="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">HTML</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"Content-Type"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"text/html; charset=utf-8"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"initial-scale=1, maximum-scale=1,user-scalable=no"</span>
  /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>ArcGIS JS API Tutorials: Access traffic using OAuth2<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/esri/css/main.css"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
    <span class="hljs-selector-tag">html</span>,
    <span class="hljs-selector-tag">body</span>, <span class="hljs-selector-id">#viewDiv</span>{
      <span class="hljs-attribute">font-family</span>: Avenir Next W00;
      <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;
      <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
      <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
      <span class="hljs-attribute">margin</span>: <span class="hljs-number">0px</span>;
      <span class="hljs-attribute">padding</span>: <span class="hljs-number">0px</span>;
    }

    <span class="hljs-selector-class">.action</span> {
      <span class="hljs-attribute">color</span>: blue;
      <span class="hljs-attribute">cursor</span>: pointer;
      <span class="hljs-attribute">text-decoration</span>: underline;
    }
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"anonymousPanel"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"display: block; padding: 5px; text-align: center;"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"sign-in"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"action"</span>&gt;</span>Sign In<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span> to see live traffic.
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"personalizedPanel"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"display: none; padding: 5px; text-align: center;"</span>&gt;</span>
    Welcome <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"userId"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"font-weight: bold;"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span> <span class="hljs-symbol">&amp;nbsp;</span>-<span class="hljs-symbol">&amp;nbsp;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"sign-out"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"action"</span>&gt;</span>Sign Out<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- for the map --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"viewDiv"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"display: none;"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre></li></ol><h4 id="add-javascript-to-send-users-to-arcgis.com-to-sign-in">Add JavaScript to send users to <a href="http://arcgis.com">arcgis.com</a> to sign in</h4><p>In order for users to authenticate themselves, you need to launch the OAuth login dialog. Execute the dialog when the &quot;Sign in&quot; button is clicked.</p><ol start="6"><li><p>In the file <strong>&lt;head&gt;</strong>, add a <strong>&lt;script&gt;</strong> tag and the JavaScript below. Specify the <code>portalUrl</code> and the <code>appId</code> for the <a href="../../../latest/api-reference/esri-identity-OAuthInfo.html"><code>OAuthInfo</code></a>. Be sure to substitute your <strong>Client ID</strong> value created above for the <code>appId</code>. Use the <a href="../../../latest/api-reference/esri-identity-IdentityManager.html"><code>identifityManager</code></a> static class to register the <code>info</code> and then set up click listeners to get and destroy the credentials. Use <code>checkSignInStatus</code> method to show indicate when the user is signed in or signed out.</p><pre><code class="javascript">  &lt;script&gt;
    <span class="hljs-built_in">require</span>([
      <span class="hljs-string">"esri/portal/Portal"</span>,
      <span class="hljs-string">"esri/identity/OAuthInfo"</span>,
      <span class="hljs-string">"esri/identity/IdentityManager"</span>,
      <span class="hljs-string">"esri/Map"</span>,
      <span class="hljs-string">"esri/views/MapView"</span>,
      <span class="hljs-string">"esri/layers/MapImageLayer"</span>,
      <span class="hljs-string">"dojo/dom-style"</span>,
      <span class="hljs-string">"dojo/dom-attr"</span>,
      <span class="hljs-string">"dojo/on"</span>,
      <span class="hljs-string">"dojo/dom"</span>
    ], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">
        Portal, OAuthInfo, identityManager, Map, MapView, MapImageLayer,
        domStyle, domAttr, on, dom</span>) </span>{

      <span class="hljs-comment">// ArcGIS Online or your portal address</span>
      <span class="hljs-keyword">var</span> portalUrl = <span class="hljs-string">"https://www.arcgis.com/sharing"</span>;

      <span class="hljs-comment">// subsitute your own client ID to identify who spawned the login and check for a matching redirect URI</span>
      <span class="hljs-keyword">var</span> info = <span class="hljs-keyword">new</span> OAuthInfo({
        <span class="hljs-attr">appId</span>: <span class="hljs-string">"JTpyML5GgvA1jEoo"</span>, <span class="hljs-comment">//*** Your Client ID value goes here ***//</span>
        <span class="hljs-attr">popup</span>: <span class="hljs-literal">false</span> <span class="hljs-comment">// inline redirects don't require any additional app configuration</span>
      });

      identityManager.registerOAuthInfos([info]);

      <span class="hljs-comment">// send users to arcgis.com to login</span>
      on(dom.byId(<span class="hljs-string">"sign-in"</span>), <span class="hljs-string">"click"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        identityManager.getCredential(portalUrl);
      });

      <span class="hljs-comment">// log out and reload</span>
      on(dom.byId(<span class="hljs-string">"sign-out"</span>), <span class="hljs-string">"click"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        identityManager.destroyCredentials();
        <span class="hljs-built_in">window</span>.location.reload();
      });

      identityManager.checkSignInStatus(portalUrl).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
       dom.byId(<span class="hljs-string">'anonymousPanel'</span>).style.display = <span class="hljs-string">'none'</span>;
       dom.byId(<span class="hljs-string">'personalizedPanel'</span>).style.display = <span class="hljs-string">'block'</span>
     });

    });
  <span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre></li><li><p>Run the <a href="http://localhost/privatelayer.html">http://localhost/privatelayer.html</a> page and try to sign-in and sign-out.</p><aside class="js-accordion accordion"><div class="accordion-section"><span class="accordion-title"><svg class="svg-icon accordion-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M8 .15A7.85 7.85 0 1 0 15.85 8 7.85 7.85 0 0 0 8 .15zM9 12H7V6h2zm0-7H7V3h2z"/></svg><div class="accordion-content"><p>If you are having issues, check the <strong>Client ID</strong> value to see that it matches the one in your account. You also might need to clear your browser cache and cookies.</p></div></span></div></aside></li></ol><h4 id="create-a-map-and-add-the-traffic-service-layer-after-login-is-complete">Create a map and add the Traffic Service layer after login is complete</h4><p>The <a href="https://developers.arcgis.com/rest/network/api-reference/traffic-service.htm">ArcGIS Traffic service</a> is a premium service that can be used to visualize real time traffic speeds and incidents such as accidents, construction sites, or street closures. The service is <em>free</em>, but it does require applications to provide authentication to access it. The layer must be loaded after a user has been successfully authenticated.</p><ol><li><p>In the file, create a new function called <code>displayMap</code> that creates and adds the secure traffic layer to the map after the portal has been successfully loaded.</p><pre><code class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">displayMap</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> portal = <span class="hljs-keyword">new</span> Portal();

      <span class="hljs-comment">// Once the portal has loaded, the user is signed in</span>
      portal.load().then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        dom.byId(<span class="hljs-string">'viewDiv'</span>).style.display = <span class="hljs-string">'flex'</span>;

        <span class="hljs-keyword">var</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>({
          <span class="hljs-attr">basemap</span>: <span class="hljs-string">"topo"</span>
        });

        <span class="hljs-keyword">var</span> view = <span class="hljs-keyword">new</span> MapView({
          <span class="hljs-attr">container</span>: <span class="hljs-string">"viewDiv"</span>,
          <span class="hljs-attr">map</span>: map,
          <span class="hljs-attr">zoom</span>: <span class="hljs-number">14</span>,
          <span class="hljs-attr">center</span>: [<span class="hljs-number">-118.24</span>,<span class="hljs-number">34.05</span>]
        });

        <span class="hljs-keyword">var</span> traffic = <span class="hljs-keyword">new</span> MapImageLayer({
          <span class="hljs-attr">url</span>: <span class="hljs-string">'https://traffic.arcgis.com/arcgis/rest/services/World/Traffic/MapServer'</span>
        })
        map.add(traffic);
      });
    }
</code></pre></li><li><p>Update the existing <code>checkSignInStatus</code> method to call the <code>displayMap</code> function. This will occur after a user has successfully signed in and is authenticated.</p><aside class="js-accordion accordion"><div class="accordion-section"><span class="accordion-title"><svg class="svg-icon accordion-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M8 .15A7.85 7.85 0 1 0 15.85 8 7.85 7.85 0 0 0 8 .15zM9 12H7V6h2zm0-7H7V3h2z"/></svg><div class="accordion-content"><p>A user token will be appended automatically when fetching the premium traffic layer.</p></div></span></div></aside><pre><code class="javascript">     identityManager.checkSignInStatus(portalUrl).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
       dom.byId(<span class="hljs-string">'anonymousPanel'</span>).style.display = <span class="hljs-string">'none'</span>;
       dom.byId(<span class="hljs-string">'personalizedPanel'</span>).style.display = <span class="hljs-string">'block'</span>
       <span class="hljs-comment">//*** ADD ***//</span>
       displayMap();
     });
</code></pre></li><li><p>Run the code. The map should display live traffic in Los Angeles after you sign in.</p></li></ol><h4 id="congratulations%2C-you're-done!">Congratulations, you're done!</h4><p>Your app should look something like <a href="https://developers.arcgis.com/labs/demo/oauth.html">this</a>.</p><h2 id="challenge">Challenge</h2><h4 id="use-a-service-proxy-to-access-the-traffic-service">Use a service proxy to access the traffic service</h4><div class="panel panel-no-border trailer-1"><p>If you would like to use the &quot;App login&quot; authentication pattern to access the ArcGIS Traffic service directly and prevent the application from prompting the user to sign in, you can use a proxy service.</p><ol><li>Go to the <a href="https://developers.arcgis.com/labs/arcgisonline/set-up-authenticated-services/">Set up authenticated services</a> lab and create a proxy to access the ArcGIS Traffic Layer Service. NOTE: To set up the proxy you can use the application created in the first step or you can create a new application for all service proxies.</li><li>In the dashboard, copy the Traffic Layer proxy URL and update the application code.<pre><code class="javascript">     <span class="hljs-keyword">var</span> traffic = <span class="hljs-keyword">new</span> MapImageLayer({
       <span class="hljs-comment">//*** ADD ***//</span>
       <span class="hljs-attr">url</span>: <span class="hljs-string">"https://utility.arcgis.com/usrsvcs/appservices/&lt;your-id&gt;/rest/services/World/Traffic/MapServer"</span>
     });
</code></pre></li><li>In your app, comment out all of the OAuth code and call the <code>displayMap</code> function when the application loads.</li><li>Run the application again and it shouldn't prompt the user to sign in.</li></ol></div></div></main><div class="column-4"><section id="main-toc-large" class="panel tablet-hide trailer-1"><h5 class="avenir-regular text-dark-gray font-size--3">Content</h5><developers-toc content=".js-container-guide" container="main-toc-large" include="h2,h3,h4,h5,h6"></developers-toc></section></div></div><div class="footnote feedback right trailer-1"><a class="icon-ui-contact hide js-feedback" href="mailto:js_feedback@esri.com?subject=Feedback%20on%204.14%20-%20guide:%20Access%20services%20with%20OAuth%202.0&body=Hello,%0A%0AI%20was%20reading%20the%20ArcGIS%20API%20for%20JavaScript%20version%204.14%20documentation%20and%20have%20some%20feedback.%0A%0ADocumentation%20details:%0APage%20title:%20%7BREPLACE_TITLE%7D%0APage%20URL:%20%7BREPLACE_URL%7D%0AUser-Agent:%20%7BREPLACE_UA%7D%0A%0A">Feedback on this topic?</a></div></div></div><footer class="footer leader-0 link-dark-gray" role="contentinfo"><div class="grid-container"><nav class="column-6"><h6>ArcGIS for Developers</h6><ul class="list-plain"><li><a href="/">Home</a></li><li><a href="/features/">Features</a></li><li><a href="/documentation/">Documentation</a></li><li><a href="/support/">Support</a></li><li><a href="/pricing/">Pricing</a></li><li><a href="/startups/">Startups</a></li><li><a href="https://blogs.esri.com/esri/arcgis/category/developer/">Blog</a></li></ul></nav><nav class="column-6"><h6>ArcGIS Platform</h6><ul class="list-plain"><li><a href="http://arcgis.com">ArcGIS Online</a></li><li><a href="http://desktop.arcgis.com">ArcGIS Desktop</a></li><li><a href="http://server.arcgis.com">ArcGIS Enterprise</a></li><li><a href="http://developers.arcgis.com">ArcGIS for Developers</a></li><li><a href="http://solutions.arcgis.com">ArcGIS Solutions</a></li><li><a href="http://marketplace.arcgis.com">ArcGIS Marketplace</a></li></ul></nav><nav class="column-6"><h6>About Esri</h6><ul class="list-plain"><li><a href="http://www.esri.com/about-esri/">About Us</a></li><li><a href="http://www.esri.com/careers/">Careers</a></li><li><a href="https://blogs.esri.com/esri/esri-insider/">Insiders Blog</a></li><li><a href="http://www.esri.com/events/user-conference/index.html">User Conference</a></li><li><a href="http://www.esri.com/events/devsummit/index.html">Developer Summit</a></li></ul></nav><nav class="column-6"><a class="esri-logo" href="http://esri.com" aria-label="Esri Home"></a><div class="footer-social-nav leader-1"><a class="icon-social-twitter" aria-label="Esri on Twitter" href="https://twitter.com/Esri/"></a> <a class="icon-social-facebook" aria-label="Esri on Facebook" href="https://www.facebook.com/esrigis/"></a> <a class="icon-social-github" aria-label="Esri on GitHub" href="http://esri.github.com/"></a> <a class="icon-social-contact" aria-label="Contact Esri" href="http://www.esri.com/about-esri/contact/"></a></div></nav><div class="column-24 leader-1"><p><small><a href="http://www.esri.com/legal/copyright-trademarks">Copyright Â© 2020 Esri</a>. All rights reserved. | <a href="http://www.esri.com/legal/privacy">Privacy</a> | <a href="http://www.esri.com/legal/software-license">Terms of use</a> | <a href="/terms/faq/">FAQ</a></small></p></div></div></footer><script></script><script>var relativePath=document.URL.replace(/[-\w\d]*\.(html|css|js).*/,"../../..")</script><script src="../../../assets/js/config.js"></script><script src="../../../assets/js/preparse.js"></script><script src="../../../assets/js/developers-components/sharedComponents.js"></script><div class="js-modal modal-overlay modifier-class" data-modal="modal-keyboard-shortcuts"><div class="modal-content column-8" aria-label="modal" role="dialog"><a class="js-modal-toggle right" href="#" aria-label="close-modal"><svg xmlns="http://www.w3.org/2000/svg" width="21" height="21" viewBox="0 0 32 32" class="svg-icon"><path d="M18.404 16l9.9 9.9-2.404 2.404-9.9-9.9-9.9 9.9L3.696 25.9l9.9-9.9-9.9-9.898L6.1 3.698l9.9 9.899 9.9-9.9 2.404 2.406-9.9 9.898z"/></svg></a><h4>Keyboard shortcuts</h4><hr class="leader-0 trailer-half"><div><table class="table-plain keyboard-mappings"><thead><tr><th></th><th>Site wide shortcuts</th></tr></thead><tbody><tr><td><kbd>?</kbd></td><td>Bring up this help dialog</td></tr><tr><td><kbd>esc</kbd></td><td>Dismiss this help dialog</td></tr><tr><td><kbd>g</kbd><kbd>h</kbd></td><td>Go to Home</td></tr><tr><td><kbd>g</kbd><kbd>g</kbd></td><td>Go to Guide</td></tr><tr><td><kbd>g</kbd><kbd>a</kbd></td><td>Go to API Reference</td></tr><tr><td><kbd>g</kbd><kbd>s</kbd></td><td>Go to Sample Code</td></tr><tr><td><kbd>g</kbd><kbd>t</kbd></td><td>Scroll to top of page</td></tr><tr><td><kbd>spacebar</kbd></td><td>Scroll page down</td></tr><tr><td><kbd>shift spacebar</kbd></td><td>Scroll page up</td></tr><tr><td><kbd>g</kbd><kbd>b</kbd></td><td>Scroll to bottom of page</td></tr></tbody></table></div></div></div><script src="../../../assets/js/libs/url-search-params.js"></script><script src="../../../assets/js/calcite-web.js"></script><script src="../../../assets/js/calcite-web-extend.js"></script><script src="../../../assets/js/libs/mousetrap.js"></script><script>"function"==typeof Mousetrap&&"object"==typeof calcite&&"function"==typeof Mousetrap&&"object"==typeof calcite&&Mousetrap.bind(["g h","g g","g a","g s","?","g t","g b"],function(e,t){calcite.bus.emit("keyboard:mousetrap",{event:e,combination:t,navigation:{h:"../../../index.html",g:"../../../latest/guide/index.html",a:"../../../latest/api-reference/index.html",s:"../../../latest/sample-code/index.html"}})})</script></body></html>