<!DOCTYPE html><html><head><meta charset="utf-8"><meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="content-language" content="en"><meta name="last-modified" content="Thu Jan 09 2020 11:33:52 GMT-0800 (Pacific Standard Time)"><meta name="tags" content="2D,MapView,WebGL,animation,custom,BaseLayerViewGL2D,4.11"><meta name="product" content="js-api-arcgis"><meta name="version" content="4.x"><meta name="subject" content="DEVELOPER,WEB,WEB APPLICATIONS,MOBILE"><meta name="subject_label" content="DEVELOPER,WEB,WEB APPLICATIONS,MOBILE"><meta name="sub_category" content="JavaScript API"><meta name="sub_category_label" content="ArcGIS API for JavaScript"><meta name="content_type" content="Sample Code"><meta name="content_type_label" content="Sample Code"><meta name="search-collection" content="help"><meta name="search-category" content="help-api,help-api-sample"><meta name="description" content="Custom WebGL layer view"><meta name="keywords" content="2D,MapView,WebGL,animation,custom,BaseLayerViewGL2D,4.11"><title>Custom WebGL layer view | ArcGIS API for JavaScript 4.14</title><link rel="shortcut icon" href="../../../../favicon.ico"><link rel="stylesheet" href="../../../assets/css/default.css"></head><body><developers-account-notifications></developers-account-notifications><div class="wrapper"><header class="top-nav top-nav-hover-top"><div class="grid-container"><div class="column-24"><span class="top-nav-title font-size-1">Go to <a href="https://developers.arcgis.com/javascript/">Latest version (official documentation)</a></span></div></div></header><developers-active-toggle key="secondaryNav"></developers-active-toggle><div class="secondary-nav" data-target="secondaryNav"><div class="secondary-nav-container"><h3 class="secondary-nav-title tablet-hide"><a href="../../../" class="secondary-nav-title-link"><svg class="svg-icon" viewBox="0 0 48 53"><path d="M24.16 2.12L46 8v33.66l-22.14 9.23L2 45V11.9l22.16-9.78M24 0L0 10.6v35.92L24 53l24-10V6.48L24 0zM9 11v30h30V11zm16.33 23.4c0 2.92-1.72 4.25-4.21 4.25a4.37 4.37 0 0 1-4.23-2.58l2.29-1.39c.45.79.85 1.45 1.82 1.45s1.51-.36 1.51-1.77v-9.59h2.82zM32 38.65a5.4 5.4 0 0 1-5.13-2.88l2.29-1.33a3.07 3.07 0 0 0 2.78 1.71c1.17 0 1.91-.58 1.91-1.39 0-1-.76-1.31-2.05-1.87l-.7-.3c-2-.87-3.39-2-3.39-4.25 0-2.12 1.61-3.73 4.13-3.73a4.18 4.18 0 0 1 4 2.26l-2.2 1.41a1.91 1.91 0 0 0-1.81-1.21 1.23 1.23 0 0 0-1.35 1.21c0 .84.53 1.18 1.73 1.71l.71.3c2.39 1 3.74 2.07 3.74 4.43 0 2.54-1.99 3.93-4.66 3.93z"/></svg> JavaScript API</a> <a href="../../.." class="secondary-nav-title-link">4.14</a> <a href="../../../latest/sample-code/index.html" class="secondary-nav-title-link">Sample Code</a></h3><h3 class="secondary-nav-title tablet-show"><svg class="svg-icon" viewBox="0 0 48 53"><path d="M24.16 2.12L46 8v33.66l-22.14 9.23L2 45V11.9l22.16-9.78M24 0L0 10.6v35.92L24 53l24-10V6.48L24 0zM9 11v30h30V11zm16.33 23.4c0 2.92-1.72 4.25-4.21 4.25a4.37 4.37 0 0 1-4.23-2.58l2.29-1.39c.45.79.85 1.45 1.82 1.45s1.51-.36 1.51-1.77v-9.59h2.82zM32 38.65a5.4 5.4 0 0 1-5.13-2.88l2.29-1.33a3.07 3.07 0 0 0 2.78 1.71c1.17 0 1.91-.58 1.91-1.39 0-1-.76-1.31-2.05-1.87l-.7-.3c-2-.87-3.39-2-3.39-4.25 0-2.12 1.61-3.73 4.13-3.73a4.18 4.18 0 0 1 4 2.26l-2.2 1.41a1.91 1.91 0 0 0-1.81-1.21 1.23 1.23 0 0 0-1.35 1.21c0 .84.53 1.18 1.73 1.71l.71.3c2.39 1 3.74 2.07 3.74 4.43 0 2.54-1.99 3.93-4.66 3.93z"/></svg> JavaScript API <span class="secondary-nav-breadcrumb">Sample Code</span></h3><developers-active-toggle toggle="secondaryNavToggle" target="secondaryNavList"></developers-active-toggle><nav id="secondaryNavList" class="secondary-nav-list"><ul class="secondary-nav-items" data-target="secondaryNav"><li class="secondary-nav-item"><a href="../../../" class="secondary-nav-link">Home</a></li><li class="secondary-nav-item"><a href="../../../latest/guide/" class="secondary-nav-link">Guide</a></li><li class="secondary-nav-item"><a href="../../../latest/sample-code/" class="is-active secondary-nav-link">Sample Code</a></li><li class="secondary-nav-item"><a href="../../../latest/api-reference/" class="secondary-nav-link">API Reference</a></li><li class="secondary-nav-item"><a href="../../../latest/showcase/" class="secondary-nav-link">Showcase</a></li><li class="secondary-nav-item"><a href="../../../support/" class="secondary-nav-link">Support</a></li></ul></nav><button id="secondaryNavToggle" class="secondary-nav-toggle" data-toggle="secondaryNav"><svg class="svg-icon" viewBox="0 0 16 16"><path d="M15.5 5l-7 7-7-7z"/></svg><span class="secondary-nav-toggle-label">Menu</span></button></div><button tabindex="-1" class="secondary-nav-canvas" data-toggle="secondaryNav"></button></div><header class="sub-nav sub-nav-purple"><div class="grid-container"><h1 class="sub-nav-title font-size-6 avenir-light leader-2 trailer-2 text-white">Custom WebGL layer view</h1></div></header><div id="skip-to-content"><div class="grid-container leader-1"><div class="column-6 trailer-2 tablet-hide"><div class="search-sdk"><div class="search-sdk-section"><input type="text" autocomplete="false" spellcheck="false" class="input-search-sdk js-search-sdk-input js-search-sdk-tablet-hide" placeholder="Search for samples"></div></div><aside class="accordion side-nav js-accordion sample-code"><div class="accordion-section"><h4 class="accordion-title">Get Started</h4><nav class="accordion-content"><a href="../../../latest/sample-code/index.html" class="side-nav-link">Featured samples</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/intro-mapview/index.html" class="side-nav-link">Intro to MapView (2D)</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/intro-sceneview/index.html" class="side-nav-link">Intro to SceneView (3D)</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/intro-layers/index.html" class="side-nav-link">Intro to layers</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/intro-popup/index.html" class="side-nav-link">Intro to popups</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/intro-widgets/index.html" class="side-nav-link">Intro to widgets</a></nav></div><div class="accordion-section"><h4 class="accordion-title">Latest Samples</h4><nav class="accordion-content"><a href="../../../latest/sample-code/featurereduction-cluster/index.html" class="side-nav-link">Point clustering</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/featurereduction-cluster-visualvariables/index.html" class="side-nav-link">Point clustering with visual variables</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/featurereduction-cluster-filter/index.html" class="side-nav-link">Filter clustered points</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/featurereduction-cluster-filter-slider/index.html" class="side-nav-link">Filter clustered points with a slider</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-sm-location-scale/index.html" class="side-nav-link">Vary point sizes by scale</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-daylight/index.html" class="side-nav-link">Daylight widget</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-line-of-sight/index.html" class="side-nav-link">Line of sight widget</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/webmap-save/index.html" class="side-nav-link">Save a web map</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/view-disable-navigation/index.html" class="side-nav-link">Disable view navigation</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-timeslider-offset/index.html" class="side-nav-link">TimeSlider with timeOffset</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/time-layer/index.html" class="side-nav-link">Time-based layer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-featurelayer-collection-edits/index.html" class="side-nav-link">Add or remove graphics from a FeatureLayer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/custom-gl-tessellation-helpers/index.html" class="side-nav-link">Tessellation helpers for custom WebGL layer views</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/custom-gl-tiles/index.html" class="side-nav-link">Tiling support for custom WebGL layer views</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/custom-lv-masking/index.html" class="side-nav-link">Masking effect using a custom layer view</a></nav></div><div class="accordion-section"><h4 class="accordion-title">Mapping and Views</h4><nav class="accordion-content"><a href="../../../latest/sample-code/webmap-basic/index.html" class="side-nav-link">Load a basic web map</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/webmap-save/index.html" class="side-nav-link">Save a web map</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/webscene-basic/index.html" class="side-nav-link">Load a basic web scene</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/webscene-save/index.html" class="side-nav-link">Save a web scene</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/webscene-slides/index.html" class="side-nav-link">Web scene - slides</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/scene-local/index.html" class="side-nav-link">Create a local scene</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/scene-goto/index.html" class="side-nav-link">SceneView - goTo()</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/view-padding/index.html" class="side-nav-link">View padding</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/basemaps-portal/index.html" class="side-nav-link">Use Portal Basemaps</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/basemap-custom/index.html" class="side-nav-link">Create a custom basemap</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/webmap-swap/index.html" class="side-nav-link">Swap web maps in the same view</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/views-switch-2d-3d/index.html" class="side-nav-link">Switch view from 2D to 3D</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/views-composite-views/index.html" class="side-nav-link">Composite views</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/sceneview-background/index.html" class="side-nav-link">Custom background for SceneView</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/sceneview-underground/index.html" class="side-nav-link">Underground navigation in global mode</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/sceneview-screenshot/index.html" class="side-nav-link">Take a screenshot of a SceneView</a></nav></div><div class="accordion-section"><h4 class="accordion-title">Layers</h4><nav class="accordion-content"><a href="../../../latest/sample-code/layers-portal/index.html" class="side-nav-link">Create layer from portal item</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-vectortilelayer/index.html" class="side-nav-link">VectorTileLayer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-vectortilelayer-json/index.html" class="side-nav-link">VectorTileLayer from JSON</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-integratedmeshlayer/index.html" class="side-nav-link">IntegratedMeshLayer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-streamlayer/index.html" class="side-nav-link">StreamLayer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-kml/index.html" class="side-nav-link">KMLLayer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-osm-3d/index.html" class="side-nav-link">OpenStreetMapLayer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-webtile-3d/index.html" class="side-nav-link">WebTileLayer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-wms/index.html" class="side-nav-link">WMSLayer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-wmts/index.html" class="side-nav-link">WMTSLayer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-wmts-sublayers/index.html" class="side-nav-link">Select WMTS sublayer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-geojson/index.html" class="side-nav-link">GeoJSONLayer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-georss/index.html" class="side-nav-link">GeoRSSLayer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/building-scene-layer-slice/index.html" class="side-nav-link">BuildingSceneLayer with Slice widget</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/building-scene-layer-filter/index.html" class="side-nav-link">Filter BuildingSceneLayer</a></nav></div><div class="accordion-section"><h4 class="accordion-title">FeatureLayer</h4><nav class="accordion-content"><a href="../../../latest/sample-code/layers-featurelayer/index.html" class="side-nav-link">Intro to FeatureLayer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-featurelayer-collection/index.html" class="side-nav-link">Created from array of graphics</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-featurelayer-collection-edits/index.html" class="side-nav-link">Add or remove graphics from a FeatureLayer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/highlight-point-features/index.html" class="side-nav-link">Highlight point features</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-featurelayer-labeling-3d/index.html" class="side-nav-link">Label features using Arcade expressions</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/labels-basic/index.html" class="side-nav-link">Add labels to a FeatureLayer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/labels-multiline/index.html" class="side-nav-link">Multi-line labels</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/labels-multiple-classes/index.html" class="side-nav-link">Add multiple label classes to a layer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/featurefilter-attributes/index.html" class="side-nav-link">Filter features by attributes</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/featureeffect-geometry/index.html" class="side-nav-link">Apply effects to features</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/featurelayer-query-basic/index.html" class="side-nav-link">Basic Querying on FeatureLayer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-featurelayer-shapefile/index.html" class="side-nav-link">Created from a shapefile</a></nav></div><div class="accordion-section"><h4 class="accordion-title">SceneLayer</h4><nav class="accordion-content"><a href="../../../latest/sample-code/layers-scenelayer/index.html" class="side-nav-link">Intro to SceneLayer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-scenelayer-feature-masking/index.html" class="side-nav-link">Filter features by geometry with SceneLayer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-scenelayer-texture/index.html" class="side-nav-link">Realistic buildings</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-scenelayer-color-mix-mode/index.html" class="side-nav-link">Coloring options for textured buildings</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-scenelayer-edges/index.html" class="side-nav-link">Add edges to a SceneLayer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-scenelayer-points/index.html" class="side-nav-link">Point geometries</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-scenelayer-filter-query/index.html" class="side-nav-link">Filter and query</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-scenelayerview-query/index.html" class="side-nav-link">Query client-side 3D extents</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-scenelayerview-query-stats/index.html" class="side-nav-link">SceneLayerView - query statistics by geometry</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/highlight-scenelayer/index.html" class="side-nav-link">Highlight SceneLayer</a></nav></div><div class="accordion-section"><h4 class="accordion-title">MapImageLayer</h4><nav class="accordion-content"><a href="../../../latest/sample-code/layers-mapimagelayer/index.html" class="side-nav-link">Intro to MapImageLayer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-mapimagelayer-sublayers/index.html" class="side-nav-link">Toggle sublayer visibility</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-mapimagelayer-definitionexpression/index.html" class="side-nav-link">Set definition expressions on sublayers</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-mapimagelayer-renderers/index.html" class="side-nav-link">Set renderers on sublayers</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-mapimagelayer-dynamic-labels/index.html" class="side-nav-link">Label sublayer features</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-dynamicmaplayer/index.html" class="side-nav-link">Create dynamic map layers</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-dynamicdatalayer-table-join/index.html" class="side-nav-link">Dynamic data layer with table join</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-dynamicdatalayer-query-table/index.html" class="side-nav-link">Dynamic data layer with query table</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-sm-sublayer/index.html" class="side-nav-link">MapImageLayer - Explore data from a dynamic workspace</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-dynamicdatalayer-raster/index.html" class="side-nav-link">Dynamic data layer with raster data</a></nav></div><div class="accordion-section"><h4 class="accordion-title">CSVLayer</h4><nav class="accordion-content"><a href="../../../latest/sample-code/layers-csv/index.html" class="side-nav-link">Intro to CSVLayer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-csv-projection/index.html" class="side-nav-link">CSVLayer - Project points on the fly</a></nav></div><div class="accordion-section"><h4 class="accordion-title">ImageryLayer</h4><nav class="accordion-content"><a href="../../../latest/sample-code/layers-imagerylayer/index.html" class="side-nav-link">Intro to ImageryLayer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-imagery-pixelvalues/index.html" class="side-nav-link">Client side pixel filter</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-imagery-popup/index.html" class="side-nav-link">Server side raster function</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-imagery-renderingrule/index.html" class="side-nav-link">Client side rendering rules</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-imagery-attribute-table/index.html" class="side-nav-link">Raster attribute table</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-imagery-clientside/index.html" class="side-nav-link">Client-side chart for ImageryLayer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-imagery-coordinatesystem/index.html" class="side-nav-link">Image coordinate system</a></nav></div><div class="accordion-section"><h4 class="accordion-title">PointCloudLayer</h4><nav class="accordion-content"><a href="../../../latest/sample-code/layers-pointcloud-portal/index.html" class="side-nav-link">Intro to PointCloudLayer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-pointcloud/index.html" class="side-nav-link">Toggle visualizations</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-pointcloud-size-density/index.html" class="side-nav-link">Change point size and density</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-pointcloud-color-modulation/index.html" class="side-nav-link">Intensity color modulation</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-pointcloud-filters/index.html" class="side-nav-link">Filter points in a PointCloudLayer</a></nav></div><div class="accordion-section is-active"><h4 class="accordion-title">Custom Layers</h4><nav class="accordion-content"><a href="../../../latest/sample-code/layers-custom-tilelayer/index.html" class="side-nav-link">Custom TileLayer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-custom-dynamiclayer/index.html" class="side-nav-link">Custom DynamicLayer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-custom-lerc-2d/index.html" class="side-nav-link">Custom LERC Layer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-custom-blendlayer/index.html" class="side-nav-link">Custom BlendLayer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-custom-elevation-exaggerated/index.html" class="side-nav-link">Custom ElevationLayer - Exaggerating elevation</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-custom-elevation-thematic/index.html" class="side-nav-link">Custom ElevationLayer - Thematic data as elevation</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/custom-gl-visuals/index.html" class="side-nav-link is-active">Custom WebGL layer views</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/custom-gl-animated-lines/index.html" class="side-nav-link">Animated lines with WebGL</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/custom-gl-tessellation-helpers/index.html" class="side-nav-link">Tessellation helpers for custom WebGL layer views</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/custom-gl-tiles/index.html" class="side-nav-link">Tiling support for custom WebGL layer views</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/custom-lv-masking/index.html" class="side-nav-link">Masking effect using a custom layer view</a></nav></div><div class="accordion-section"><h4 class="accordion-title">Query</h4><nav class="accordion-content"><a href="../../../latest/sample-code/featurelayerview-query/index.html" class="side-nav-link">FeatureLayerView - query</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/query-attachments/index.html" class="side-nav-link">Query attachments</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/query-related-features/index.html" class="side-nav-link">Query related features</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/featurelayerview-query-distance/index.html" class="side-nav-link">Query statistics client-side by distance</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/featurelayerview-query-stats/index.html" class="side-nav-link">Query statistics client-side</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/highlight-features-by-geometry/index.html" class="side-nav-link">Highlight features by geometry</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/featurelayer-query/index.html" class="side-nav-link">Query features from a FeatureLayer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/featurelayerview-query-geometry/index.html" class="side-nav-link">FeatureLayerView - query statistics by geometry</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/layers-scenelayerview-query-stats/index.html" class="side-nav-link">SceneLayerView - query statistics by geometry</a></nav></div><div class="accordion-section"><h4 class="accordion-title">Editing</h4><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-editor-basic/index.html" class="side-nav-link">Edit features with the Editor widget</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-editor-configurable/index.html" class="side-nav-link">Editor widget with configurations</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/editing-applyedits/index.html" class="side-nav-link">FeatureLayer applyEdits</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/editing-groupedfeatureform/index.html" class="side-nav-link">Update Feature Attributes</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/editing-featureform-fieldvisibility/index.html" class="side-nav-link">Advanced attribute editing</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/popup-editaction/index.html" class="side-nav-link">Popup with edit action</a></nav></div><div class="accordion-section"><h4 class="accordion-title">Draw</h4><nav class="accordion-content"><a href="../../../latest/sample-code/sketch-geometries/index.html" class="side-nav-link">Sketch widget</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/sketch-update-validation/index.html" class="side-nav-link">Sketch update validation</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/draw-line/index.html" class="side-nav-link">Draw non-intersecting line</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/import-gltf/index.html" class="side-nav-link">Import glTF 3D models</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/sketch-3d/index.html" class="side-nav-link">Sketch in 3D</a></nav></div><div class="accordion-section"><h4 class="accordion-title">Visualization</h4><nav class="accordion-content"><a href="../../../latest/sample-code/playground/index.html" class="side-nav-link">Symbol Playground</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-sm-location-scale/index.html" class="side-nav-link">Vary point sizes by scale</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-location-types/index.html" class="side-nav-link">Visualize features by unique types</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-classbreaks/index.html" class="side-nav-link">Visualize data with class breaks</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-dictionary/index.html" class="side-nav-link">Visualize data with dictionary renderer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-sm-color/index.html" class="side-nav-link">Generate data-driven continuous color visualization</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-sm-types/index.html" class="side-nav-link">Generate data-driven visualization of unique values</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-sm-color-mesh/index.html" class="side-nav-link">Generate continuous color visualization for 3D buildings</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-sm-classbreaks/index.html" class="side-nav-link">Generate a class breaks visualization</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-sm-relationship/index.html" class="side-nav-link">Generate a relationship visualization</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-sm-predominance/index.html" class="side-nav-link">Generate a predominance visualization</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-sm-dotdensity/index.html" class="side-nav-link">Generate a dot density visualization</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-vv-color/index.html" class="side-nav-link">Data-driven continuous color</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-vv-size/index.html" class="side-nav-link">Data-driven continuous size</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-dot-density/index.html" class="side-nav-link">Dot density</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-heatmap/index.html" class="side-nav-link">Visualize points with a heatmap</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-heatmap-scale/index.html" class="side-nav-link">Create a scale-dependent visualization</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/cim-primitive-overrides/index.html" class="side-nav-link">Wurman dots</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-vv-extrusion/index.html" class="side-nav-link">Data-driven extrusion</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-multivariate-3d/index.html" class="side-nav-link">Multivariate visualizations (3D)</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-sm-multivariate/index.html" class="side-nav-link">Multivariate data exploration</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-buildings-3d/index.html" class="side-nav-link">Extrude buildings footprints based on real world heights</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-arcade/index.html" class="side-nav-link">Create a custom visualization using Arcade</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/cim-symbols/index.html" class="side-nav-link">CIMSymbol</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/webstylesymbol-2d/index.html" class="side-nav-link">WebStyleSymbol (2D)</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/webstylesymbol-proportional-2d/index.html" class="side-nav-link">Visualize feature layer with proportionally-sized WebStyleSymbols (2D)</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-webstylesymbol/index.html" class="side-nav-link">Visualize features with realistic WebStyleSymbols</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-realistic-water/index.html" class="side-nav-link">Realistic water visualization in 3D</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-path-3d/index.html" class="side-nav-link">Path visualization in 3D</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-point-styles/index.html" class="side-nav-link">Point styles for cities</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-label-callout/index.html" class="side-nav-link">Using callout lines with labels</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-vv-opacity-animate/index.html" class="side-nav-link">Animate opacity visual variable</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-vv-color-animate/index.html" class="side-nav-link">Animate color visual variable</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-legend-update/index.html" class="side-nav-link">Update legend text</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-update-data/index.html" class="side-nav-link">Update a renderer&#39;s attribute</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/visualization-histogram-color/index.html" class="side-nav-link">Customize ColorSlider Histogram</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/client-projection/index.html" class="side-nav-link">Client-side projection</a></nav></div><div class="accordion-section"><h4 class="accordion-title">Clustering</h4><nav class="accordion-content"><a href="../../../latest/sample-code/featurereduction-cluster/index.html" class="side-nav-link">Point clustering</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/featurereduction-cluster-visualvariables/index.html" class="side-nav-link">Point clustering with visual variables</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/featurereduction-cluster-filter/index.html" class="side-nav-link">Filter clustered points</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/featurereduction-cluster-filter-slider/index.html" class="side-nav-link">Filter clustered points with a slider</a></nav></div><div class="accordion-section"><h4 class="accordion-title">Popups</h4><nav class="accordion-content"><a href="../../../latest/sample-code/intro-popuptemplate/index.html" class="side-nav-link">Intro to PopupTemplate</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/popup-docking-position/index.html" class="side-nav-link">Dock popup positions</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/popup-multipleelements/index.html" class="side-nav-link">Multiple popup elements</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/popuptemplate-arcade/index.html" class="side-nav-link">Reference Arcade expressions in PopupTemplate</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/popuptemplate-arcade-groupby" class="side-nav-link">Summarize intersecting points in a popup</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/popuptemplate-function/index.html" class="side-nav-link">PopupTemplate with functions</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/popuptemplate-promise/index.html" class="side-nav-link">PopupTemplate with promise</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/popup-domnode/index.html" class="side-nav-link">Popup with DOM node</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/popup-actions/index.html" class="side-nav-link">Popup actions</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/popup-custom-action/index.html" class="side-nav-link">Custom popup actions per feature</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/popup-editaction/index.html" class="side-nav-link">Popup with edit action</a></nav></div><div class="accordion-section"><h4 class="accordion-title">Graphics</h4><nav class="accordion-content"><a href="../../../latest/sample-code/intro-graphics/index.html" class="side-nav-link">Intro to graphics</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/graphics-basic-3d/index.html" class="side-nav-link">Add graphics to a SceneView</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/geometry-mesh-primitives/index.html" class="side-nav-link">Working with 3D mesh primitives</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/geometry-mesh-elevation/index.html" class="side-nav-link">Low poly terrain using mesh geometry</a></nav></div><div class="accordion-section"><h4 class="accordion-title">Searching</h4><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-search-3d/index.html" class="side-nav-link">Search widget</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-search-multiplesource/index.html" class="side-nav-link">Search widget with multiple sources</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-search-customsource/index.html" class="side-nav-link">Search widget with custom source</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/tasks-query/index.html" class="side-nav-link">QueryTask</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/tasks-find/index.html" class="side-nav-link">FindTask</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/tasks-identify/index.html" class="side-nav-link">IdentifyTask</a></nav></div><div class="accordion-section"><h4 class="accordion-title">Analysis</h4><nav class="accordion-content"><a href="../../../latest/sample-code/ge-geodesicbuffer/index.html" class="side-nav-link">GeometryEngine - geodesic buffers</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/geoprocessing-viewshed/index.html" class="side-nav-link">Geoprocessing - viewshed analysis</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/geoprocessing-hotspot/index.html" class="side-nav-link">Geoprocessing - hotspot analysis</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/tasks-route/index.html" class="side-nav-link">RouteTask</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/elevation-query-points/index.html" class="side-nav-link">Query Elevation (points)</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/elevation-query/index.html" class="side-nav-link">Query Elevation (lines)</a></nav></div><div class="accordion-section"><h4 class="accordion-title">Widgets</h4><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-basemapgallery/index.html" class="side-nav-link">BasemapGallery widget</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-bookmarks/index.html" class="side-nav-link">Bookmarks widget</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-coordinateconversion/index.html" class="side-nav-link">CoordinateConversion widget</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-coordinateconversion-custom/index.html" class="side-nav-link">CoordinateConversion widget - custom formats</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-daylight/index.html" class="side-nav-link">Daylight widget</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-directions/index.html" class="side-nav-link">Directions widget</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-histogram/index.html" class="side-nav-link">Histogram widget</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-histogramrangeslider/index.html" class="side-nav-link">HistogramRangeSlider</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-layerlist/index.html" class="side-nav-link">LayerList widget</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-layerlist-actions/index.html" class="side-nav-link">LayerList widget with actions</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-legend/index.html" class="side-nav-link">Legend widget</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-layerlist-legend/index.html" class="side-nav-link">Add a Legend to LayerList</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-legend-card/index.html" class="side-nav-link">Legend widget card style</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-line-of-sight/index.html" class="side-nav-link">Line of sight widget</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-locate/index.html" class="side-nav-link">Locate button</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-measurement/index.html" class="side-nav-link">Measurement widget</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-measurement-2d/index.html" class="side-nav-link">Measurement in 2D</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-measurement-3d/index.html" class="side-nav-link">Measurement in 3D</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/building-scene-layer-slice/index.html" class="side-nav-link">BuildingSceneLayer with Slice widget</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-print/index.html" class="side-nav-link">Print widget</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-swipe/index.html" class="side-nav-link">Swipe widget</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-swipe-scroll/index.html" class="side-nav-link">Swipe widget with scroll</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-track-basic/index.html" class="side-nav-link">Track current location</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-track/index.html" class="side-nav-link">Track widget simulation</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-timeslider/index.html" class="side-nav-link">TimeSlider widget</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-timeslider-offset/index.html" class="side-nav-link">TimeSlider with timeOffset</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-expand/index.html" class="side-nav-link">Expand widget</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-feature/index.html" class="side-nav-link">Feature widget</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-feature-sidepanel/index.html" class="side-nav-link">Feature widget in a side panel</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/simple-ui/index.html" class="side-nav-link">Using the view&#39;s UI</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/view-breakpoints/index.html" class="side-nav-link">Responsive widgets</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/view-breakpoints-css/index.html" class="side-nav-link">Responsive apps using CSS</a></nav></div><div class="accordion-section"><h4 class="accordion-title">Widgets (Advanced)</h4><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-custom-widget/index.html" class="side-nav-link">Create a custom widget</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-custom-recenter/index.html" class="side-nav-link">Custom Recenter widget</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-frameworks-react/index.html" class="side-nav-link">Using widgets with React</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-frameworks-vue/index.html" class="side-nav-link">Custom widgets with Vue</a></nav></div><div class="accordion-section"><h4 class="accordion-title">More 3D</h4><nav class="accordion-content"><a href="../../../latest/sample-code/scene-toggle-elevation/index.html" class="side-nav-link">Toggle ground elevation</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/scene-shadow/index.html" class="side-nav-link">SceneView - shadow and lighting</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/sceneview-hittest/index.html" class="side-nav-link">SceneView - hitTest</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/scene-elevationinfo/index.html" class="side-nav-link">Elevation options</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/scene-elevationlayer/index.html" class="side-nav-link">ElevationLayer</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/satellites-3d/index.html" class="side-nav-link">Satellites in 3D view</a></nav></div><div class="accordion-section"><h4 class="accordion-title">Time</h4><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-timeslider/index.html" class="side-nav-link">TimeSlider widget</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/timeslider-filter/index.html" class="side-nav-link">Filter features with TimeSlider</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/widgets-timeslider-offset/index.html" class="side-nav-link">TimeSlider with timeOffset</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/time-layer/index.html" class="side-nav-link">Time-based layer</a></nav></div><div class="accordion-section"><h4 class="accordion-title">Other</h4><nav class="accordion-content"><a href="../../../latest/sample-code/animation-layer-visibility/index.html" class="side-nav-link">Animate layer visibility</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/request/index.html" class="side-nav-link">Request data from a remote server</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/identity-oauth-basic/index.html" class="side-nav-link">Access ArcGIS Online items via OAuth</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/chaining-promises/index.html" class="side-nav-link">Chaining promises</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/view-hittest/index.html" class="side-nav-link">Access features with pointer events</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/views-synchronize/index.html" class="side-nav-link">Synchronize MapView and SceneView</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/frameworks-bootstrap/index.html" class="side-nav-link">Calcite Maps and Bootstrap</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/styling-icon-fonts/index.html" class="side-nav-link">Using Esri Icon Fonts</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/watch-for-changes/index.html" class="side-nav-link">Watch for changes</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/event-explorer/index.html" class="side-nav-link">Event explorer / watch properties</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/featurelayer-queryextent/index.html" class="side-nav-link">Zoom to extent of features</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/portalitem-dragndrop/index.html" class="side-nav-link">Drag and drop portal items</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/view-disable-navigation/index.html" class="side-nav-link">Disable view navigation</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/view-disable-rotation/index.html" class="side-nav-link">Disable rotation on the view</a></nav><nav class="accordion-content"><a href="../../../latest/sample-code/view-disable-zoom/index.html" class="side-nav-link">Disable all zooming on the view</a></nav></div></aside><div class="column-6 scroll-show tablet-hide js-sticky" data-top="46"><a href="#" class="btn btn-fill btn-clear">Back to Top</a></div></div><div class="column-24 trailer-1 tablet-show"><div class="search-sdk"><div class="search-sdk-section"><input type="text" autocomplete="false" spellcheck="false" class="input-search-sdk js-search-sdk-input" placeholder="Search for samples"></div></div><select class="select-full leader-half trailer-half js-select-nav"><optgroup label="Get Started"><option value="../../../latest/sample-code/index.html">Featured samples</option><option value="../../../latest/sample-code/intro-mapview/index.html">Intro to MapView (2D)</option><option value="../../../latest/sample-code/intro-sceneview/index.html">Intro to SceneView (3D)</option><option value="../../../latest/sample-code/intro-layers/index.html">Intro to layers</option><option value="../../../latest/sample-code/intro-popup/index.html">Intro to popups</option><option value="../../../latest/sample-code/intro-widgets/index.html">Intro to widgets</option></optgroup><optgroup label="Latest Samples"><option value="../../../latest/sample-code/featurereduction-cluster/index.html">Point clustering</option><option value="../../../latest/sample-code/featurereduction-cluster-visualvariables/index.html">Point clustering with visual variables</option><option value="../../../latest/sample-code/featurereduction-cluster-filter/index.html">Filter clustered points</option><option value="../../../latest/sample-code/featurereduction-cluster-filter-slider/index.html">Filter clustered points with a slider</option><option value="../../../latest/sample-code/visualization-sm-location-scale/index.html">Vary point sizes by scale</option><option value="../../../latest/sample-code/widgets-daylight/index.html">Daylight widget</option><option value="../../../latest/sample-code/widgets-line-of-sight/index.html">Line of sight widget</option><option value="../../../latest/sample-code/webmap-save/index.html">Save a web map</option><option value="../../../latest/sample-code/view-disable-navigation/index.html">Disable view navigation</option><option value="../../../latest/sample-code/widgets-timeslider-offset/index.html">TimeSlider with timeOffset</option><option value="../../../latest/sample-code/time-layer/index.html">Time-based layer</option><option value="../../../latest/sample-code/layers-featurelayer-collection-edits/index.html">Add or remove graphics from a FeatureLayer</option><option value="../../../latest/sample-code/custom-gl-tessellation-helpers/index.html">Tessellation helpers for custom WebGL layer views</option><option value="../../../latest/sample-code/custom-gl-tiles/index.html">Tiling support for custom WebGL layer views</option><option value="../../../latest/sample-code/custom-lv-masking/index.html">Masking effect using a custom layer view</option></optgroup><optgroup label="Mapping and Views"><option value="../../../latest/sample-code/webmap-basic/index.html">Load a basic web map</option><option value="../../../latest/sample-code/webmap-save/index.html">Save a web map</option><option value="../../../latest/sample-code/webscene-basic/index.html">Load a basic web scene</option><option value="../../../latest/sample-code/webscene-save/index.html">Save a web scene</option><option value="../../../latest/sample-code/webscene-slides/index.html">Web scene - slides</option><option value="../../../latest/sample-code/scene-local/index.html">Create a local scene</option><option value="../../../latest/sample-code/scene-goto/index.html">SceneView - goTo()</option><option value="../../../latest/sample-code/view-padding/index.html">View padding</option><option value="../../../latest/sample-code/basemaps-portal/index.html">Use Portal Basemaps</option><option value="../../../latest/sample-code/basemap-custom/index.html">Create a custom basemap</option><option value="../../../latest/sample-code/webmap-swap/index.html">Swap web maps in the same view</option><option value="../../../latest/sample-code/views-switch-2d-3d/index.html">Switch view from 2D to 3D</option><option value="../../../latest/sample-code/views-composite-views/index.html">Composite views</option><option value="../../../latest/sample-code/sceneview-background/index.html">Custom background for SceneView</option><option value="../../../latest/sample-code/sceneview-underground/index.html">Underground navigation in global mode</option><option value="../../../latest/sample-code/sceneview-screenshot/index.html">Take a screenshot of a SceneView</option></optgroup><optgroup label="Layers"><option value="../../../latest/sample-code/layers-portal/index.html">Create layer from portal item</option><option value="../../../latest/sample-code/layers-vectortilelayer/index.html">VectorTileLayer</option><option value="../../../latest/sample-code/layers-vectortilelayer-json/index.html">VectorTileLayer from JSON</option><option value="../../../latest/sample-code/layers-integratedmeshlayer/index.html">IntegratedMeshLayer</option><option value="../../../latest/sample-code/layers-streamlayer/index.html">StreamLayer</option><option value="../../../latest/sample-code/layers-kml/index.html">KMLLayer</option><option value="../../../latest/sample-code/layers-osm-3d/index.html">OpenStreetMapLayer</option><option value="../../../latest/sample-code/layers-webtile-3d/index.html">WebTileLayer</option><option value="../../../latest/sample-code/layers-wms/index.html">WMSLayer</option><option value="../../../latest/sample-code/layers-wmts/index.html">WMTSLayer</option><option value="../../../latest/sample-code/layers-wmts-sublayers/index.html">Select WMTS sublayer</option><option value="../../../latest/sample-code/layers-geojson/index.html">GeoJSONLayer</option><option value="../../../latest/sample-code/layers-georss/index.html">GeoRSSLayer</option><option value="../../../latest/sample-code/building-scene-layer-slice/index.html">BuildingSceneLayer with Slice widget</option><option value="../../../latest/sample-code/building-scene-layer-filter/index.html">Filter BuildingSceneLayer</option></optgroup><optgroup label="FeatureLayer"><option value="../../../latest/sample-code/layers-featurelayer/index.html">Intro to FeatureLayer</option><option value="../../../latest/sample-code/layers-featurelayer-collection/index.html">Created from array of graphics</option><option value="../../../latest/sample-code/layers-featurelayer-collection-edits/index.html">Add or remove graphics from a FeatureLayer</option><option value="../../../latest/sample-code/highlight-point-features/index.html">Highlight point features</option><option value="../../../latest/sample-code/layers-featurelayer-labeling-3d/index.html">Label features using Arcade expressions</option><option value="../../../latest/sample-code/labels-basic/index.html">Add labels to a FeatureLayer</option><option value="../../../latest/sample-code/labels-multiline/index.html">Multi-line labels</option><option value="../../../latest/sample-code/labels-multiple-classes/index.html">Add multiple label classes to a layer</option><option value="../../../latest/sample-code/featurefilter-attributes/index.html">Filter features by attributes</option><option value="../../../latest/sample-code/featureeffect-geometry/index.html">Apply effects to features</option><option value="../../../latest/sample-code/featurelayer-query-basic/index.html">Basic Querying on FeatureLayer</option><option value="../../../latest/sample-code/layers-featurelayer-shapefile/index.html">Created from a shapefile</option></optgroup><optgroup label="SceneLayer"><option value="../../../latest/sample-code/layers-scenelayer/index.html">Intro to SceneLayer</option><option value="../../../latest/sample-code/layers-scenelayer-feature-masking/index.html">Filter features by geometry with SceneLayer</option><option value="../../../latest/sample-code/layers-scenelayer-texture/index.html">Realistic buildings</option><option value="../../../latest/sample-code/layers-scenelayer-color-mix-mode/index.html">Coloring options for textured buildings</option><option value="../../../latest/sample-code/layers-scenelayer-edges/index.html">Add edges to a SceneLayer</option><option value="../../../latest/sample-code/layers-scenelayer-points/index.html">Point geometries</option><option value="../../../latest/sample-code/layers-scenelayer-filter-query/index.html">Filter and query</option><option value="../../../latest/sample-code/layers-scenelayerview-query/index.html">Query client-side 3D extents</option><option value="../../../latest/sample-code/layers-scenelayerview-query-stats/index.html">SceneLayerView - query statistics by geometry</option><option value="../../../latest/sample-code/highlight-scenelayer/index.html">Highlight SceneLayer</option></optgroup><optgroup label="MapImageLayer"><option value="../../../latest/sample-code/layers-mapimagelayer/index.html">Intro to MapImageLayer</option><option value="../../../latest/sample-code/layers-mapimagelayer-sublayers/index.html">Toggle sublayer visibility</option><option value="../../../latest/sample-code/layers-mapimagelayer-definitionexpression/index.html">Set definition expressions on sublayers</option><option value="../../../latest/sample-code/layers-mapimagelayer-renderers/index.html">Set renderers on sublayers</option><option value="../../../latest/sample-code/layers-mapimagelayer-dynamic-labels/index.html">Label sublayer features</option><option value="../../../latest/sample-code/layers-dynamicmaplayer/index.html">Create dynamic map layers</option><option value="../../../latest/sample-code/layers-dynamicdatalayer-table-join/index.html">Dynamic data layer with table join</option><option value="../../../latest/sample-code/layers-dynamicdatalayer-query-table/index.html">Dynamic data layer with query table</option><option value="../../../latest/sample-code/visualization-sm-sublayer/index.html">MapImageLayer - Explore data from a dynamic workspace</option><option value="../../../latest/sample-code/layers-dynamicdatalayer-raster/index.html">Dynamic data layer with raster data</option></optgroup><optgroup label="CSVLayer"><option value="../../../latest/sample-code/layers-csv/index.html">Intro to CSVLayer</option><option value="../../../latest/sample-code/layers-csv-projection/index.html">CSVLayer - Project points on the fly</option></optgroup><optgroup label="ImageryLayer"><option value="../../../latest/sample-code/layers-imagerylayer/index.html">Intro to ImageryLayer</option><option value="../../../latest/sample-code/layers-imagery-pixelvalues/index.html">Client side pixel filter</option><option value="../../../latest/sample-code/layers-imagery-popup/index.html">Server side raster function</option><option value="../../../latest/sample-code/layers-imagery-renderingrule/index.html">Client side rendering rules</option><option value="../../../latest/sample-code/layers-imagery-attribute-table/index.html">Raster attribute table</option><option value="../../../latest/sample-code/layers-imagery-clientside/index.html">Client-side chart for ImageryLayer</option><option value="../../../latest/sample-code/layers-imagery-coordinatesystem/index.html">Image coordinate system</option></optgroup><optgroup label="PointCloudLayer"><option value="../../../latest/sample-code/layers-pointcloud-portal/index.html">Intro to PointCloudLayer</option><option value="../../../latest/sample-code/layers-pointcloud/index.html">Toggle visualizations</option><option value="../../../latest/sample-code/layers-pointcloud-size-density/index.html">Change point size and density</option><option value="../../../latest/sample-code/layers-pointcloud-color-modulation/index.html">Intensity color modulation</option><option value="../../../latest/sample-code/layers-pointcloud-filters/index.html">Filter points in a PointCloudLayer</option></optgroup><optgroup label="Custom Layers"><option value="../../../latest/sample-code/layers-custom-tilelayer/index.html">Custom TileLayer</option><option value="../../../latest/sample-code/layers-custom-dynamiclayer/index.html">Custom DynamicLayer</option><option value="../../../latest/sample-code/layers-custom-lerc-2d/index.html">Custom LERC Layer</option><option value="../../../latest/sample-code/layers-custom-blendlayer/index.html">Custom BlendLayer</option><option value="../../../latest/sample-code/layers-custom-elevation-exaggerated/index.html">Custom ElevationLayer - Exaggerating elevation</option><option value="../../../latest/sample-code/layers-custom-elevation-thematic/index.html">Custom ElevationLayer - Thematic data as elevation</option><option value="../../../latest/sample-code/custom-gl-visuals/index.html" selected="selected">Custom WebGL layer views</option><option value="../../../latest/sample-code/custom-gl-animated-lines/index.html">Animated lines with WebGL</option><option value="../../../latest/sample-code/custom-gl-tessellation-helpers/index.html">Tessellation helpers for custom WebGL layer views</option><option value="../../../latest/sample-code/custom-gl-tiles/index.html">Tiling support for custom WebGL layer views</option><option value="../../../latest/sample-code/custom-lv-masking/index.html">Masking effect using a custom layer view</option></optgroup><optgroup label="Query"><option value="../../../latest/sample-code/featurelayerview-query/index.html">FeatureLayerView - query</option><option value="../../../latest/sample-code/query-attachments/index.html">Query attachments</option><option value="../../../latest/sample-code/query-related-features/index.html">Query related features</option><option value="../../../latest/sample-code/featurelayerview-query-distance/index.html">Query statistics client-side by distance</option><option value="../../../latest/sample-code/featurelayerview-query-stats/index.html">Query statistics client-side</option><option value="../../../latest/sample-code/highlight-features-by-geometry/index.html">Highlight features by geometry</option><option value="../../../latest/sample-code/featurelayer-query/index.html">Query features from a FeatureLayer</option><option value="../../../latest/sample-code/featurelayerview-query-geometry/index.html">FeatureLayerView - query statistics by geometry</option><option value="../../../latest/sample-code/layers-scenelayerview-query-stats/index.html">SceneLayerView - query statistics by geometry</option></optgroup><optgroup label="Editing"><option value="../../../latest/sample-code/widgets-editor-basic/index.html">Edit features with the Editor widget</option><option value="../../../latest/sample-code/widgets-editor-configurable/index.html">Editor widget with configurations</option><option value="../../../latest/sample-code/editing-applyedits/index.html">FeatureLayer applyEdits</option><option value="../../../latest/sample-code/editing-groupedfeatureform/index.html">Update Feature Attributes</option><option value="../../../latest/sample-code/editing-featureform-fieldvisibility/index.html">Advanced attribute editing</option><option value="../../../latest/sample-code/popup-editaction/index.html">Popup with edit action</option></optgroup><optgroup label="Draw"><option value="../../../latest/sample-code/sketch-geometries/index.html">Sketch widget</option><option value="../../../latest/sample-code/sketch-update-validation/index.html">Sketch update validation</option><option value="../../../latest/sample-code/draw-line/index.html">Draw non-intersecting line</option><option value="../../../latest/sample-code/import-gltf/index.html">Import glTF 3D models</option><option value="../../../latest/sample-code/sketch-3d/index.html">Sketch in 3D</option></optgroup><optgroup label="Visualization"><option value="../../../latest/sample-code/playground/index.html">Symbol Playground</option><option value="../../../latest/sample-code/visualization-sm-location-scale/index.html">Vary point sizes by scale</option><option value="../../../latest/sample-code/visualization-location-types/index.html">Visualize features by unique types</option><option value="../../../latest/sample-code/visualization-classbreaks/index.html">Visualize data with class breaks</option><option value="../../../latest/sample-code/visualization-dictionary/index.html">Visualize data with dictionary renderer</option><option value="../../../latest/sample-code/visualization-sm-color/index.html">Generate data-driven continuous color visualization</option><option value="../../../latest/sample-code/visualization-sm-types/index.html">Generate data-driven visualization of unique values</option><option value="../../../latest/sample-code/visualization-sm-color-mesh/index.html">Generate continuous color visualization for 3D buildings</option><option value="../../../latest/sample-code/visualization-sm-classbreaks/index.html">Generate a class breaks visualization</option><option value="../../../latest/sample-code/visualization-sm-relationship/index.html">Generate a relationship visualization</option><option value="../../../latest/sample-code/visualization-sm-predominance/index.html">Generate a predominance visualization</option><option value="../../../latest/sample-code/visualization-sm-dotdensity/index.html">Generate a dot density visualization</option><option value="../../../latest/sample-code/visualization-vv-color/index.html">Data-driven continuous color</option><option value="../../../latest/sample-code/visualization-vv-size/index.html">Data-driven continuous size</option><option value="../../../latest/sample-code/visualization-dot-density/index.html">Dot density</option><option value="../../../latest/sample-code/visualization-heatmap/index.html">Visualize points with a heatmap</option><option value="../../../latest/sample-code/visualization-heatmap-scale/index.html">Create a scale-dependent visualization</option><option value="../../../latest/sample-code/cim-primitive-overrides/index.html">Wurman dots</option><option value="../../../latest/sample-code/visualization-vv-extrusion/index.html">Data-driven extrusion</option><option value="../../../latest/sample-code/visualization-multivariate-3d/index.html">Multivariate visualizations (3D)</option><option value="../../../latest/sample-code/visualization-sm-multivariate/index.html">Multivariate data exploration</option><option value="../../../latest/sample-code/visualization-buildings-3d/index.html">Extrude buildings footprints based on real world heights</option><option value="../../../latest/sample-code/visualization-arcade/index.html">Create a custom visualization using Arcade</option><option value="../../../latest/sample-code/cim-symbols/index.html">CIMSymbol</option><option value="../../../latest/sample-code/webstylesymbol-2d/index.html">WebStyleSymbol (2D)</option><option value="../../../latest/sample-code/webstylesymbol-proportional-2d/index.html">Visualize feature layer with proportionally-sized WebStyleSymbols (2D)</option><option value="../../../latest/sample-code/visualization-webstylesymbol/index.html">Visualize features with realistic WebStyleSymbols</option><option value="../../../latest/sample-code/visualization-realistic-water/index.html">Realistic water visualization in 3D</option><option value="../../../latest/sample-code/visualization-path-3d/index.html">Path visualization in 3D</option><option value="../../../latest/sample-code/visualization-point-styles/index.html">Point styles for cities</option><option value="../../../latest/sample-code/visualization-label-callout/index.html">Using callout lines with labels</option><option value="../../../latest/sample-code/visualization-vv-opacity-animate/index.html">Animate opacity visual variable</option><option value="../../../latest/sample-code/visualization-vv-color-animate/index.html">Animate color visual variable</option><option value="../../../latest/sample-code/widgets-legend-update/index.html">Update legend text</option><option value="../../../latest/sample-code/visualization-update-data/index.html">Update a renderer&#39;s attribute</option><option value="../../../latest/sample-code/visualization-histogram-color/index.html">Customize ColorSlider Histogram</option><option value="../../../latest/sample-code/client-projection/index.html">Client-side projection</option></optgroup><optgroup label="Clustering"><option value="../../../latest/sample-code/featurereduction-cluster/index.html">Point clustering</option><option value="../../../latest/sample-code/featurereduction-cluster-visualvariables/index.html">Point clustering with visual variables</option><option value="../../../latest/sample-code/featurereduction-cluster-filter/index.html">Filter clustered points</option><option value="../../../latest/sample-code/featurereduction-cluster-filter-slider/index.html">Filter clustered points with a slider</option></optgroup><optgroup label="Popups"><option value="../../../latest/sample-code/intro-popuptemplate/index.html">Intro to PopupTemplate</option><option value="../../../latest/sample-code/popup-docking-position/index.html">Dock popup positions</option><option value="../../../latest/sample-code/popup-multipleelements/index.html">Multiple popup elements</option><option value="../../../latest/sample-code/popuptemplate-arcade/index.html">Reference Arcade expressions in PopupTemplate</option><option value="../../../latest/sample-code/popuptemplate-arcade-groupby">Summarize intersecting points in a popup</option><option value="../../../latest/sample-code/popuptemplate-function/index.html">PopupTemplate with functions</option><option value="../../../latest/sample-code/popuptemplate-promise/index.html">PopupTemplate with promise</option><option value="../../../latest/sample-code/popup-domnode/index.html">Popup with DOM node</option><option value="../../../latest/sample-code/popup-actions/index.html">Popup actions</option><option value="../../../latest/sample-code/popup-custom-action/index.html">Custom popup actions per feature</option><option value="../../../latest/sample-code/popup-editaction/index.html">Popup with edit action</option></optgroup><optgroup label="Graphics"><option value="../../../latest/sample-code/intro-graphics/index.html">Intro to graphics</option><option value="../../../latest/sample-code/graphics-basic-3d/index.html">Add graphics to a SceneView</option><option value="../../../latest/sample-code/geometry-mesh-primitives/index.html">Working with 3D mesh primitives</option><option value="../../../latest/sample-code/geometry-mesh-elevation/index.html">Low poly terrain using mesh geometry</option></optgroup><optgroup label="Searching"><option value="../../../latest/sample-code/widgets-search-3d/index.html">Search widget</option><option value="../../../latest/sample-code/widgets-search-multiplesource/index.html">Search widget with multiple sources</option><option value="../../../latest/sample-code/widgets-search-customsource/index.html">Search widget with custom source</option><option value="../../../latest/sample-code/tasks-query/index.html">QueryTask</option><option value="../../../latest/sample-code/tasks-find/index.html">FindTask</option><option value="../../../latest/sample-code/tasks-identify/index.html">IdentifyTask</option></optgroup><optgroup label="Analysis"><option value="../../../latest/sample-code/ge-geodesicbuffer/index.html">GeometryEngine - geodesic buffers</option><option value="../../../latest/sample-code/geoprocessing-viewshed/index.html">Geoprocessing - viewshed analysis</option><option value="../../../latest/sample-code/geoprocessing-hotspot/index.html">Geoprocessing - hotspot analysis</option><option value="../../../latest/sample-code/tasks-route/index.html">RouteTask</option><option value="../../../latest/sample-code/elevation-query-points/index.html">Query Elevation (points)</option><option value="../../../latest/sample-code/elevation-query/index.html">Query Elevation (lines)</option></optgroup><optgroup label="Widgets"><option value="../../../latest/sample-code/widgets-basemapgallery/index.html">BasemapGallery widget</option><option value="../../../latest/sample-code/widgets-bookmarks/index.html">Bookmarks widget</option><option value="../../../latest/sample-code/widgets-coordinateconversion/index.html">CoordinateConversion widget</option><option value="../../../latest/sample-code/widgets-coordinateconversion-custom/index.html">CoordinateConversion widget - custom formats</option><option value="../../../latest/sample-code/widgets-daylight/index.html">Daylight widget</option><option value="../../../latest/sample-code/widgets-directions/index.html">Directions widget</option><option value="../../../latest/sample-code/widgets-histogram/index.html">Histogram widget</option><option value="../../../latest/sample-code/widgets-histogramrangeslider/index.html">HistogramRangeSlider</option><option value="../../../latest/sample-code/widgets-layerlist/index.html">LayerList widget</option><option value="../../../latest/sample-code/widgets-layerlist-actions/index.html">LayerList widget with actions</option><option value="../../../latest/sample-code/widgets-legend/index.html">Legend widget</option><option value="../../../latest/sample-code/widgets-layerlist-legend/index.html">Add a Legend to LayerList</option><option value="../../../latest/sample-code/widgets-legend-card/index.html">Legend widget card style</option><option value="../../../latest/sample-code/widgets-line-of-sight/index.html">Line of sight widget</option><option value="../../../latest/sample-code/widgets-locate/index.html">Locate button</option><option value="../../../latest/sample-code/widgets-measurement/index.html">Measurement widget</option><option value="../../../latest/sample-code/widgets-measurement-2d/index.html">Measurement in 2D</option><option value="../../../latest/sample-code/widgets-measurement-3d/index.html">Measurement in 3D</option><option value="../../../latest/sample-code/building-scene-layer-slice/index.html">BuildingSceneLayer with Slice widget</option><option value="../../../latest/sample-code/widgets-print/index.html">Print widget</option><option value="../../../latest/sample-code/widgets-swipe/index.html">Swipe widget</option><option value="../../../latest/sample-code/widgets-swipe-scroll/index.html">Swipe widget with scroll</option><option value="../../../latest/sample-code/widgets-track-basic/index.html">Track current location</option><option value="../../../latest/sample-code/widgets-track/index.html">Track widget simulation</option><option value="../../../latest/sample-code/widgets-timeslider/index.html">TimeSlider widget</option><option value="../../../latest/sample-code/widgets-timeslider-offset/index.html">TimeSlider with timeOffset</option><option value="../../../latest/sample-code/widgets-expand/index.html">Expand widget</option><option value="../../../latest/sample-code/widgets-feature/index.html">Feature widget</option><option value="../../../latest/sample-code/widgets-feature-sidepanel/index.html">Feature widget in a side panel</option><option value="../../../latest/sample-code/simple-ui/index.html">Using the view&#39;s UI</option><option value="../../../latest/sample-code/view-breakpoints/index.html">Responsive widgets</option><option value="../../../latest/sample-code/view-breakpoints-css/index.html">Responsive apps using CSS</option></optgroup><optgroup label="Widgets (Advanced)"><option value="../../../latest/sample-code/widgets-custom-widget/index.html">Create a custom widget</option><option value="../../../latest/sample-code/widgets-custom-recenter/index.html">Custom Recenter widget</option><option value="../../../latest/sample-code/widgets-frameworks-react/index.html">Using widgets with React</option><option value="../../../latest/sample-code/widgets-frameworks-vue/index.html">Custom widgets with Vue</option></optgroup><optgroup label="More 3D"><option value="../../../latest/sample-code/scene-toggle-elevation/index.html">Toggle ground elevation</option><option value="../../../latest/sample-code/scene-shadow/index.html">SceneView - shadow and lighting</option><option value="../../../latest/sample-code/sceneview-hittest/index.html">SceneView - hitTest</option><option value="../../../latest/sample-code/scene-elevationinfo/index.html">Elevation options</option><option value="../../../latest/sample-code/scene-elevationlayer/index.html">ElevationLayer</option><option value="../../../latest/sample-code/satellites-3d/index.html">Satellites in 3D view</option></optgroup><optgroup label="Time"><option value="../../../latest/sample-code/widgets-timeslider/index.html">TimeSlider widget</option><option value="../../../latest/sample-code/timeslider-filter/index.html">Filter features with TimeSlider</option><option value="../../../latest/sample-code/widgets-timeslider-offset/index.html">TimeSlider with timeOffset</option><option value="../../../latest/sample-code/time-layer/index.html">Time-based layer</option></optgroup><optgroup label="Other"><option value="../../../latest/sample-code/animation-layer-visibility/index.html">Animate layer visibility</option><option value="../../../latest/sample-code/request/index.html">Request data from a remote server</option><option value="../../../latest/sample-code/identity-oauth-basic/index.html">Access ArcGIS Online items via OAuth</option><option value="../../../latest/sample-code/chaining-promises/index.html">Chaining promises</option><option value="../../../latest/sample-code/view-hittest/index.html">Access features with pointer events</option><option value="../../../latest/sample-code/views-synchronize/index.html">Synchronize MapView and SceneView</option><option value="../../../latest/sample-code/frameworks-bootstrap/index.html">Calcite Maps and Bootstrap</option><option value="../../../latest/sample-code/styling-icon-fonts/index.html">Using Esri Icon Fonts</option><option value="../../../latest/sample-code/watch-for-changes/index.html">Watch for changes</option><option value="../../../latest/sample-code/event-explorer/index.html">Event explorer / watch properties</option><option value="../../../latest/sample-code/featurelayer-queryextent/index.html">Zoom to extent of features</option><option value="../../../latest/sample-code/portalitem-dragndrop/index.html">Drag and drop portal items</option><option value="../../../latest/sample-code/view-disable-navigation/index.html">Disable view navigation</option><option value="../../../latest/sample-code/view-disable-rotation/index.html">Disable rotation on the view</option><option value="../../../latest/sample-code/view-disable-zoom/index.html">Disable all zooming on the view</option></optgroup></select></div><main class="column-17 tablet-column-12 pre-1 content-face"><article><div class="js-container-sample-code"><div class="column-17 tablet-column-12 trailer-1"><iframe data-sample-code-type="2d" class="iframe-sample-code js-container-iframe-sample-code" onload='calcite.bus.emit("iframe:sample-code:load-handler")' title="Live Sample" allowfullscreen src="../../../latest/sample-code/custom-gl-visuals/live/index.html"></iframe><div class="animate-fade-in iframe-sample-code-loader is-active js-iframe-sample-code-loader"><div class="loader-content"><div class="loader-bars"></div><div class="loader-text">Loading...</div></div></div></div><div class="clearfix"></div><blockquote class="hide trailer-1 js-container-sample-code-warning"><p><span class="avenir-bold">Note:</span> Support for 3D on mobile devices may vary, view the <a href="../../../latest/guide/system-requirements/index.html">system requirements</a> for more information.</p></blockquote><div class="clearfix"><div class="trailer-1 btn-group-sample-code js-btn-group-sample-code"><button class="btn btn-hidden btn-sample-code icon-ui-download js-btn-save-file" data-save-file-name="custom-gl-visuals" data-save-file="../../../latest/sample-code/custom-gl-visuals/live/index.html">Download</button> <a class="btn btn-sample-code js-btn-sample-code-sandbox" href="../../../latest/sample-code/sandbox/index.html?sample=custom-gl-visuals">Explore in the sandbox</a> <a class="btn btn-clear btn-sample-code icon-ui-link-external js-btn-jsshare" data-jsshare-url="../../../latest/sample-code/custom-gl-visuals/live/index.html">Open in CodePen</a> <a class="btn btn-clear btn-sample-code js-btn-sample-code-view-live" href="../../../latest/sample-code/custom-gl-visuals/live/index.html">View live</a></div></div><div class="esri-md panel trailer-1"><p><strong>Important notes:</strong></p><ul><li>This sample shows experimental functionality, please read the documentation carefully before using it in a product.</li><li>This sample targets expert developers familiar with WebGL and hardware-accelerated rendering.</li></ul></div><p>This sample demonstrates how to add a custom WebGL object to a map. We will create a <em>pulsating</em> marker inspired by telecommunications iconography. It is an animated icon that people usually associate with radio transmitters and broadcasting.</p><p>Developers can plug their own WebGL rendering algorithms into a <a href="../../api-reference/esri-views-MapView.html">MapView</a> by creating custom layers and overriding the methods that are responsible for drawing on the screen. At the very least the user should subclass <a href="../../api-reference/esri-layers-Layer.html">Layer</a> or some other suitable base layer, and <a href="../../api-reference/esri-views-2d-layers-BaseLayerViewGL2D.html">BaseLayerViewGL2D</a>.</p><p>Please note that this sample is not intended to be a generic visualization technique for point graphics; to do so, it would need to honor the <a href="../../api-reference/esri-Graphic.html#symbol">Graphics.symbol</a> property, at least in the case where it is set to an instance of <a href="../../api-reference/esri-symbols-SimpleMarkerSymbol.html">SimpleMarkerSymbol</a>.</p><p>From a visualization perspective, this would mean at least honor the <a href="../../api-reference/esri-symbols-SimpleMarkerSymbol.html#type">SimpleMarkerSymbol.type</a> property, to support non-circular markers, and other properties such as <code>size</code>, <code>angle</code>, <code>offsetx</code> and <code>offsety</code> that can affect the marker position on screen.</p><h2 id="1.-subclassing-an-existing-layer-type">1. Subclassing an existing layer type</h2><p>The first step is subclassing a suitable layer type. In our case, we subclass <a href="../../api-reference/esri-layers-GraphicsLayer.html">GraphicsLayer</a> to take advantage of its <a href="../../api-reference/esri-layers-GraphicsLayer.html#graphics">graphics</a> collection, which we will use as a data source of the visualization. The only thing we really need to do is override <a href="../../api-reference/esri-layers-Layer.html#createLayerView">createLayerView()</a> to instantiate a custom WebGL layer view. Note this workflow only supports visualization in a <a href="../../api-reference/esri-views-MapView.html">MapView</a>.</p><pre><code class="js"><span class="hljs-keyword">var</span> CustomLayer = GraphicsLayer.createSubclass({
  <span class="hljs-attr">createLayerView</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">view</span>) </span>{
    <span class="hljs-comment">// We only support MapView, so we only need to return a</span>
    <span class="hljs-comment">// custom layer view for the `2d` case.</span>
    <span class="hljs-keyword">if</span> (view.type === <span class="hljs-string">"2d"</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> CustomLayerView2D({
        <span class="hljs-attr">view</span>: view,
        <span class="hljs-attr">layer</span>: <span class="hljs-keyword">this</span>
      });
    }
  }
});
</code></pre><h2 id="2.-subclassing-baselayerviewgl2d">2. Subclassing <code>BaseLayerViewGL2D</code></h2><p>We also need to subclass <code>BaseLayerViewGL2D</code>. Start by defining two static properties <code>aPosition</code> and <code>aOffset</code>, which we initialize to <code>0</code> and <code>1</code>. These will be used in calls to <code>gl.bindAttribLocation</code>, <code>gl.enableVertexAttribArray</code>, and <code>gl.vertexAttribPointer</code>.</p><pre><code class="js"><span class="hljs-comment">// Subclass the custom layer view from BaseLayerViewGL2D.</span>
<span class="hljs-keyword">var</span> CustomLayerView2D = BaseLayerViewGL2D.createSubclass({
  <span class="hljs-comment">// Locations of the two vertex attributes that we use. They</span>
  <span class="hljs-comment">// will be bound to the shader program before linking.</span>
  <span class="hljs-attr">aPosition</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">aOffset</span>: <span class="hljs-number">1</span>,
</code></pre><p>The constructor for this class will be responsible for initializing instance properties and setting up a watcher on the <code>layer.graphics</code> property.</p><p>We will then proceed to override <a href="../../api-reference/esri-views-2d-layers-BaseLayerViewGL2D.html#attach">attach()</a>, <a href="../../api-reference/esri-views-2d-layers-BaseLayerViewGL2D.html#detach">detach()</a> and <a href="../../api-reference/esri-views-2d-layers-BaseLayerViewGL2D.html#render">render()</a>. We will create all the WebGL resources such as shader programs and buffers needed for rendering in <code>attach()</code>, use them in <code>render()</code>, and finally delete them in <code>detach()</code>. We will also show how to override <a href="../../api-reference/esri-views-2d-layers-BaseLayerViewGL2D.html#hitTest">hitTest()</a> so that the user will be able to interact with the features displayed by the custom view.</p><pre><code class="js">  <span class="hljs-comment">// Called once a custom layer is added to the map.layers collection and this layer view is instantiated.</span>
  <span class="hljs-attr">attach</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    ...
  },

  <span class="hljs-comment">// Called every time a frame is rendered.</span>
  <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">renderParameters</span>) </span>{
    ...
  },

  <span class="hljs-comment">// Called once a custom layer is removed from the map.layers collection and this layer view is destroyed.</span>
  <span class="hljs-attr">detach</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    ...
  },

  <span class="hljs-comment">// Called by the map view or the popup view when hit testing is required.</span>
  <span class="hljs-attr">hitTest</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">x, y</span>) </span>{
    ...
  },
</code></pre><p>We will see that <code>render()</code> sometimes will detect a condition that calls for a complete overwrite of all vertex and index data. Since this is a fairly complex operation, we factor it out in a utility method called <code>updatePositions()</code>.</p><pre><code class="js">  <span class="hljs-comment">// Called internally from render().</span>
  <span class="hljs-attr">updatePositions</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">renderParameters</span>) </span>{
    ...
  }
});
</code></pre><h3 id="the-constructor">The constructor</h3><p>In the constructor we set up some matrices and vectors that will be used by the vertex shader to position geometries on screen. We use the <a href="http://glmatrix.net/">glMatrix</a> library to ease the process.</p><p>There are essentially two matrices involved: <code>transform</code> and <code>display</code>.</p><ul><li><code>transform</code> converts from map units (i.e. <em>meters</em>) to pixels;</li><li><code>display</code> converts from pixels to <em>clip space</em>.</li></ul><p>Ultimately only these matrices are passed to the shader, but we use a few more auxiliary vectors for their computation.</p><ul><li><code>screenTranslation</code> is a half-screen shift of pixel coordinates to take into account that the origin of the screen is not in the center of the screen, but in the upper-left corner;</li><li><code>translationToCenter</code> represents the translation that moves a map point to the center of the screen;</li><li><code>screenScaling</code> represents the conversion factor from map units to pixels.</li></ul><p>We allocate all of these objects in the constructor and store references to them so that we avoid recreating them at each frame. Some of them have fixed values in certain elements and we can take advantage of this fact by pre-assigning their values in the constructor; in each frame of the animation we only update the elements that change.</p><p>The constructor also needs to start listening to changes in the <code>layer.graphics</code> collection; every time a change is detected, the <code>needsUpdate</code> flag is set to <code>true</code> and a new render is requested.</p><pre><code class="js"><span class="hljs-keyword">this</span>.needsUpdate = <span class="hljs-literal">false</span>;

<span class="hljs-keyword">var</span> requestUpdate = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">this</span>.needsUpdate = <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">this</span>.requestRender();
}.bind(<span class="hljs-keyword">this</span>);

watchUtils.on(<span class="hljs-keyword">this</span>, <span class="hljs-string">"layer.graphics"</span>, <span class="hljs-string">"change"</span>, requestUpdate, requestUpdate, requestUpdate);
</code></pre><h3 id="overriding-attach()">Overriding <code>attach()</code></h3><p>The <code>attach()</code> override is still very much a constructor, but it has access to the WebGL context via the <code>this.context</code> member. When <code>attach()</code> is called, the WebGL context is guaranteed to be in the default state.</p><pre><code class="js"><span class="hljs-keyword">var</span> gl = <span class="hljs-keyword">this</span>.context;
</code></pre><p>We start by inlining some GLSL source code; they will be used to create a vertex shader and a fragment shader object. The vertex shader does the following:</p><ul><li>Takes the <code>a_position</code> attribute, expressed in map units, and converts it to pixels using the <code>u_transform</code> matrix;</li><li>Adds an offset (in pixels);</li><li>Finally converts the position to clip space using the <code>u_display</code> matrix.</li></ul><p>The offset is also output as a varying variable because it is needed for texturing in the fragment shader. The offset is obtained by multiplying the <code>a_offset</code> attribute by <em>70.0</em>. The exact nature and meaning of the <code>a_offset</code> attribute and how it relates to <code>a_position</code> will be discussed later; the effect of the vertex transformation formula is that of producing a <em>70x70</em> marker centered on the original position.</p><pre><code class="js"><span class="hljs-keyword">var</span> vertexSource =
  <span class="hljs-string">"precision mediump float;"</span> +
  <span class="hljs-string">"uniform mat3 u_transform;"</span> +
  <span class="hljs-string">"uniform mat3 u_display;"</span> +
  <span class="hljs-string">"attribute vec2 a_position;"</span> +
  <span class="hljs-string">"attribute vec2 a_offset;"</span> +
  <span class="hljs-string">"varying vec2 v_offset;"</span> +
  <span class="hljs-string">"const float SIZE = 70.0;"</span> +
  <span class="hljs-string">"void main() {"</span> +
  <span class="hljs-string">"    gl_Position.xy = (u_display * (u_transform * vec3(a_position, 1.0) + vec3(a_offset * SIZE, 0.0))).xy;"</span> +
  <span class="hljs-string">"    gl_Position.zw = vec2(0.0, 1.0);"</span> +
  <span class="hljs-string">"    v_offset = a_offset;"</span> +
  <span class="hljs-string">"}"</span>;
</code></pre><p>The fragment shader uses the length of the <code>v_offset</code> interpolated value as the input of a cosine-based law that modulates the transparency of the marker radially around the center. Note how we output a premultiplied color value.</p><pre><code class="js"><span class="hljs-keyword">var</span> fragmentSource =
  <span class="hljs-string">"precision mediump float;"</span> +
  <span class="hljs-string">"uniform float u_current_time;"</span> +
  <span class="hljs-string">"varying vec2 v_offset;"</span> +
  <span class="hljs-string">"const float PI = 3.14159;"</span> +
  <span class="hljs-string">"const float N_RINGS = 3.0;"</span> +
  <span class="hljs-string">"const vec3 COLOR = vec3(0.23, 0.43, 0.70);"</span> +
  <span class="hljs-string">"const float FREQ = 1.0;"</span> +
  <span class="hljs-string">"void main() {"</span> +
  <span class="hljs-string">"    float l = length(v_offset);"</span> +
  <span class="hljs-string">"    float intensity = clamp(cos(l * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (l * 2.0 * N_RINGS - FREQ * u_current_time)), 0.0, 1.0);"</span> +
  <span class="hljs-string">"    gl_FragColor = vec4(COLOR * intensity, intensity);"</span> +
  <span class="hljs-string">"}"</span>;
</code></pre><p>Once the shaders are compiled and linked, uniform locations can be retrieved and stored for later use.</p><pre><code class="js"><span class="hljs-keyword">this</span>.uTransform = gl.getUniformLocation(<span class="hljs-keyword">this</span>.program, <span class="hljs-string">"u_transform"</span>);
<span class="hljs-keyword">this</span>.uDisplay = gl.getUniformLocation(<span class="hljs-keyword">this</span>.program, <span class="hljs-string">"u_display"</span>);
<span class="hljs-keyword">this</span>.uCurrentTime = gl.getUniformLocation(<span class="hljs-keyword">this</span>.program, <span class="hljs-string">"u_current_time"</span>);
</code></pre><p>We also create the vertex and index buffer, which are empty at the beginning. The <code>indexBufferSize</code> property will keep track of the number of indices in the index buffer.</p><pre><code class="js"><span class="hljs-keyword">this</span>.vertexBuffer = gl.createBuffer();
<span class="hljs-keyword">this</span>.indexBuffer = gl.createBuffer();
<span class="hljs-keyword">this</span>.indexBufferSize = <span class="hljs-number">0</span>;
</code></pre><p>Finally, we save the current center of the view in a property called <code>centerAtLastUpdate</code>; we will see how this vector will play an important role in improving the geographical accuracy of the vertex shader.</p><pre><code class="js"><span class="hljs-keyword">this</span>.centerAtLastUpdate = vec2.fromValues(<span class="hljs-keyword">this</span>.view.state.center[<span class="hljs-number">0</span>], <span class="hljs-keyword">this</span>.view.state.center[<span class="hljs-number">1</span>]);
</code></pre><h3 id="overriding-detach()">Overriding <code>detach()</code></h3><p>This function acts as a destructor; it is called when the layer is removed from the map and the corresponding layer view must be destroyed. The <code>attach()</code> override must stop watching the <code>graphics</code> collection and dispose of the created WebGL objects. Like for <code>attach()</code>, also when <code>detach()</code> is called the WebGL state is guaranteed to be the default one.</p><pre><code class="js"><span class="hljs-keyword">this</span>.watcher.remove();

<span class="hljs-keyword">var</span> gl = <span class="hljs-keyword">this</span>.context;

gl.deleteBuffer(<span class="hljs-keyword">this</span>.vertexBuffer);
gl.deleteBuffer(<span class="hljs-keyword">this</span>.indexBuffer);
gl.deleteProgram(<span class="hljs-keyword">this</span>.program);
</code></pre><h3 id="overriding-render()">Overriding <code>render()</code></h3><p>The <code>render()</code> override has access to the WebGL context and the state of the view through the <code>renderParameters</code> object that is received as an argument.</p><pre><code class="js"><span class="hljs-keyword">var</span> gl = renderParameters.context;
<span class="hljs-keyword">var</span> state = renderParameters.state;
</code></pre><p>A very important thing to keep in mind is that <em>every time that <code>render()</code> is called, the API resets WebGL to an initial state which is <strong>almost</strong> default; you have to reconfigure it from scratch every time</em>. Also, <em>do not issue WebGL calls from event handlers, promise callbacks, and timeout/interval functions</em>; not only could it be inefficient, but you also <em>have no guarantee that the WebGL state will be what you expect when they execute</em>. In most cases, it will be not, and you may even <em>end up breaking the rendering of other layers</em>.</p><p>The only two settings in this initial state that may be non-default are:</p><ul><li>the bound framebuffer;</li><li>the viewport, which is set to match the entire framebuffer.</li></ul><p><em>The body of <code>render()</code> <strong>must not</strong> change these settings</em>.</p><p>The first thing that <code>render()</code> does is to evaluate whether we need to update the contents of the vertex and index buffers and, if needed, do it; there are two different conditions that will trigger this event and we will discuss them in detail in the next section. For the time being, we factor out the decision and the update logic itself in an auxiliary function.</p><pre><code class="js"><span class="hljs-keyword">this</span>.updatePositions(renderParameters);
</code></pre><p>The above call may empty the buffers if it determines that there is nothing to render. In this event, the work of the <code>render()</code> method is done and we can simply return.</p><pre><code class="js"><span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.indexBufferSize === <span class="hljs-number">0</span>) {
  <span class="hljs-keyword">return</span>;
}
</code></pre><p>Now we need to build the transform matrices that will be passed as uniforms to the shaders. We will use <a href="http://glmatrix.net/">glMatrix</a> to ease the process. Remember that glMatrix conventions are such that the order in which the various transformations appear in code is reversed because matrices are right-multiplied. Also, note how we include the <code>devicePixelRatio</code> in most computations; this is essential for the transformation to work properly across different screen types and browser settings.</p><p>We start by computing the <code>transform</code> matrix. The code below specifies a transformation that does the following:</p><ul><li>Moves the local origin to the center of the map;</li><li>Scales by resolution, so that map units (meters) are converted to pixels;</li><li>Rotates about the center of the screen according to the rotation of the map;</li><li>Translates of half the screen size to account for the fact that the origin of the screen is not in the center, but instead is in the upper-left corner.</li></ul><pre><code class="js">mat3.identity(<span class="hljs-keyword">this</span>.transform);
<span class="hljs-keyword">this</span>.screenTranslation[<span class="hljs-number">0</span>] = (devicePixelRatio * state.size[<span class="hljs-number">0</span>]) / <span class="hljs-number">2</span>;
<span class="hljs-keyword">this</span>.screenTranslation[<span class="hljs-number">1</span>] = (devicePixelRatio * state.size[<span class="hljs-number">1</span>]) / <span class="hljs-number">2</span>;
mat3.translate(<span class="hljs-keyword">this</span>.transform, <span class="hljs-keyword">this</span>.transform, <span class="hljs-keyword">this</span>.screenTranslation);
mat3.rotate(<span class="hljs-keyword">this</span>.transform, <span class="hljs-keyword">this</span>.transform, (<span class="hljs-built_in">Math</span>.PI * state.rotation) / <span class="hljs-number">180</span>);
<span class="hljs-keyword">this</span>.screenScaling[<span class="hljs-number">0</span>] = devicePixelRatio / view.state.resolution;
<span class="hljs-keyword">this</span>.screenScaling[<span class="hljs-number">1</span>] = -devicePixelRatio / view.state.resolution;
mat3.scale(<span class="hljs-keyword">this</span>.transform, <span class="hljs-keyword">this</span>.transform, <span class="hljs-keyword">this</span>.screenScaling);
mat3.translate(<span class="hljs-keyword">this</span>.transform, <span class="hljs-keyword">this</span>.transform, <span class="hljs-keyword">this</span>.translationToCenter);
</code></pre><p>Together with the values that were specified in advance in the constructor (see section <em>&quot;The constructor&quot;</em>), the code fragment above completely specifies the <code>transform</code> matrix, except for one component that we have not discussed yet: the <code>translationToCenter</code> vector; for the time being you can assume it being defined as follows.</p><pre><code class="js"><span class="hljs-keyword">this</span>.translationToCenter[<span class="hljs-number">0</span>] = -state.center[<span class="hljs-number">0</span>];
<span class="hljs-keyword">this</span>.translationToCenter[<span class="hljs-number">1</span>] = -state.center[<span class="hljs-number">1</span>];
</code></pre><p>The above will appear to work fine, assuming that the <code>a_position</code> attribute position is an ordinary <em>(x, y)</em> coordinate pair in the spatial reference of the view. However, things will work only at small scales; zooming in will reveal that there are some precision issues caused by the large magnitude of the values involved; marker position will appear unstable at large scales. We will see how to address this in the next section.</p><p><img src="../../../assets/img/samples/custom-gl-2d-unstable.gif" alt="custom-gl-2d-unstable"></p><p>The <code>display</code> matrix must convert from pixel to clip coordinates and we already assigned most of its elements statically; we only need to set two scale factors so that they match the (possibly changed) screen parameters.</p><pre><code class="js"><span class="hljs-keyword">this</span>.display[<span class="hljs-number">0</span>] = <span class="hljs-number">2</span> / (devicePixelRatio * state.size[<span class="hljs-number">0</span>]);
<span class="hljs-keyword">this</span>.display[<span class="hljs-number">4</span>] = <span class="hljs-number">-2</span> / (devicePixelRatio * state.size[<span class="hljs-number">1</span>]);
</code></pre><p>At this point we have everything we need to render; we bind the program, upload the uniforms, set up the the attribute pointers, bind the index buffer and configure premultiplied alpha blending. Note how we pass the current time stamp in seconds <code>performance.now() / 1000.0</code> to the shader program.</p><pre><code class="js">gl.useProgram(<span class="hljs-keyword">this</span>.program);
gl.uniformMatrix3fv(<span class="hljs-keyword">this</span>.uTransform, <span class="hljs-literal">false</span>, <span class="hljs-keyword">this</span>.transform);
gl.uniformMatrix3fv(<span class="hljs-keyword">this</span>.uDisplay, <span class="hljs-literal">false</span>, <span class="hljs-keyword">this</span>.display);
gl.uniform1f(<span class="hljs-keyword">this</span>.uCurrentTime, performance.now() / <span class="hljs-number">1000.0</span>);
gl.bindBuffer(gl.ARRAY_BUFFER, <span class="hljs-keyword">this</span>.vertexBuffer);
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, <span class="hljs-keyword">this</span>.indexBuffer);
gl.enableVertexAttribArray(<span class="hljs-keyword">this</span>.aPosition);
gl.enableVertexAttribArray(<span class="hljs-keyword">this</span>.aOffset);
gl.vertexAttribPointer(<span class="hljs-keyword">this</span>.aPosition, <span class="hljs-number">2</span>, gl.FLOAT, <span class="hljs-literal">false</span>, <span class="hljs-number">16</span>, <span class="hljs-number">0</span>);
gl.vertexAttribPointer(<span class="hljs-keyword">this</span>.aOffset, <span class="hljs-number">2</span>, gl.FLOAT, <span class="hljs-literal">false</span>, <span class="hljs-number">16</span>, <span class="hljs-number">8</span>);
gl.enable(gl.BLEND);
gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);
gl.drawElements(gl.TRIANGLES, <span class="hljs-keyword">this</span>.indexBufferSize, gl.UNSIGNED_SHORT, <span class="hljs-number">0</span>);
</code></pre><p>Finally, since we want the layer to be animated, we request another frame right away.</p><pre><code class="js"><span class="hljs-keyword">this</span>.requestRender();
</code></pre><h3 id="dealing-with-precision-issues">Dealing with precision issues</h3><p>The <code>updatePositions()</code> method is responsible for updating the position of vertices on screen. It is also responsible for implementing the logic that tackles the precision issue discussed above. It begins by retrieving some of the parameters it needs.</p><pre><code class="js"><span class="hljs-keyword">var</span> gl = renderParameters.context;
<span class="hljs-keyword">var</span> stationary = renderParameters.stationary;
<span class="hljs-keyword">var</span> state = renderParameters.state;
</code></pre><p>If the view is not stationary, <em>i.e.</em> the user is panning, rotating or zooming the map, then we compute the <code>translationToCenter</code> property as the difference between <code>centerAtLastUpdate</code> and <code>state.center</code>; note the difference with the previous formula we provided for the same variable (see section <em>&quot;Overriding render()&quot;</em>), where the <code>centerAtLastUpdate</code> term was absent and <code>translationToCenter</code> was simply the opposite of <code>state.center</code>.</p><pre><code class="js"><span class="hljs-keyword">if</span> (!stationary) {
  <span class="hljs-keyword">this</span>.translationToCenter[<span class="hljs-number">0</span>] = <span class="hljs-keyword">this</span>.centerAtLastUpdate[<span class="hljs-number">0</span>] - state.center[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">this</span>.translationToCenter[<span class="hljs-number">1</span>] = <span class="hljs-keyword">this</span>.centerAtLastUpdate[<span class="hljs-number">1</span>] - state.center[<span class="hljs-number">1</span>];
  <span class="hljs-keyword">this</span>.requestRender();
  <span class="hljs-keyword">return</span>;
}
</code></pre><p>The advantage of the formula above is that it will result in a <code>transform</code> matrix with a much smaller translation component; this in turn will enable us to encode smaller coordinates in the vertex buffer, thereby limiting the impact of precision errors, which when using floating point are proportional to the magnitude. This will solve the instability of positions at large scales.</p><p><img src="../../../assets/img/samples/custom-gl-2d-stable.gif" alt="custom-gl-2d-stable"></p><p>Next, we check if an update of the vertex positions is needed at all; if the <code>graphics</code> collection did not change, and the view is still centered where the last update occurred, no action is needed and we can return.</p><pre><code class="js"><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.needsUpdate &amp;&amp; <span class="hljs-keyword">this</span>.translationToCenter[<span class="hljs-number">0</span>] === <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-keyword">this</span>.translationToCenter[<span class="hljs-number">1</span>] === <span class="hljs-number">0</span>) {
  <span class="hljs-keyword">return</span>;
}
</code></pre><p>Otherwise, we must update the buffers. We can at this point reset the <code>needsUpdate</code> flag and record the current center in the <code>centerAtLastUpdate</code> variable.</p><pre><code class="js"><span class="hljs-keyword">this</span>.centerAtLastUpdate.set(state.center);
<span class="hljs-keyword">this</span>.translationToCenter[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;
<span class="hljs-keyword">this</span>.translationToCenter[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;
<span class="hljs-keyword">this</span>.needsUpdate = <span class="hljs-literal">false</span>;
</code></pre><p>The guards in the update logic are such that changes in the underlying data, as well as changes in the point of view, will cause a regeneration of the buffer data, but such update process is delayed until the view becomes stationary. This way we avoid constant write access to GPU video memory as the user is still panning around; also, note that simply rotating and zooming in and out does not change the center, and hence it will not result in an update of buffer data.</p><p>If the control flow made it to this point we must generate the actual buffer data. We will output a quad for each marker; each quad has <em>4</em> vertices with <em>2</em> attributes of size <em>2</em>; <code>a_position</code> expressed in map units and an <code>a_offset</code>. Note how we do not encode the absolute position of the point, but its much smaller position relative to <code>this.centerAtLastUpdate</code>. Note also that each vertex is given the same values for <code>a_position</code>; it is through the values in <code>a_offset</code> attribute that we displace each vertex to become one of the corners of the quad. For the <code>a_offset</code> attribute we use <em>-0.5</em> to signify left/top and <em>+0.5</em> to signify right/bottom; when multiplied by the constant <code>70.0</code> in the vertex shader (see the <em>&quot;Overriding attach()&quot;</em> section) this results in a square, <em>70x70</em> pixels markers.</p><pre><code class="js"><span class="hljs-keyword">var</span> graphics = <span class="hljs-keyword">this</span>.layer.graphics;

gl.bindBuffer(gl.ARRAY_BUFFER, <span class="hljs-keyword">this</span>.vertexBuffer);
<span class="hljs-keyword">var</span> vertexData = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Float32Array</span>(<span class="hljs-number">16</span> * graphics.length);

<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>;
graphics.forEach(
  <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">graphic</span>) </span>{
    <span class="hljs-keyword">var</span> point = graphic.geometry;

    <span class="hljs-comment">// The (x, y) position is relative to the encoded center.</span>
    <span class="hljs-keyword">var</span> x = point.x - <span class="hljs-keyword">this</span>.centerAtLastUpdate[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">var</span> y = point.y - <span class="hljs-keyword">this</span>.centerAtLastUpdate[<span class="hljs-number">1</span>];

    vertexData[i * <span class="hljs-number">16</span> + <span class="hljs-number">0</span>] = x;
    vertexData[i * <span class="hljs-number">16</span> + <span class="hljs-number">1</span>] = y;
    vertexData[i * <span class="hljs-number">16</span> + <span class="hljs-number">2</span>] = <span class="hljs-number">-0.5</span>;
    vertexData[i * <span class="hljs-number">16</span> + <span class="hljs-number">3</span>] = <span class="hljs-number">-0.5</span>;
    vertexData[i * <span class="hljs-number">16</span> + <span class="hljs-number">4</span>] = x;
    vertexData[i * <span class="hljs-number">16</span> + <span class="hljs-number">5</span>] = y;
    vertexData[i * <span class="hljs-number">16</span> + <span class="hljs-number">6</span>] = <span class="hljs-number">0.5</span>;
    vertexData[i * <span class="hljs-number">16</span> + <span class="hljs-number">7</span>] = <span class="hljs-number">-0.5</span>;
    vertexData[i * <span class="hljs-number">16</span> + <span class="hljs-number">8</span>] = x;
    vertexData[i * <span class="hljs-number">16</span> + <span class="hljs-number">9</span>] = y;
    vertexData[i * <span class="hljs-number">16</span> + <span class="hljs-number">10</span>] = <span class="hljs-number">-0.5</span>;
    vertexData[i * <span class="hljs-number">16</span> + <span class="hljs-number">11</span>] = <span class="hljs-number">0.5</span>;
    vertexData[i * <span class="hljs-number">16</span> + <span class="hljs-number">12</span>] = x;
    vertexData[i * <span class="hljs-number">16</span> + <span class="hljs-number">13</span>] = y;
    vertexData[i * <span class="hljs-number">16</span> + <span class="hljs-number">14</span>] = <span class="hljs-number">0.5</span>;
    vertexData[i * <span class="hljs-number">16</span> + <span class="hljs-number">15</span>] = <span class="hljs-number">0.5</span>;

    ++i;
  }.bind(<span class="hljs-keyword">this</span>)
);
</code></pre><p>For the index buffer, we produce six indices per quad: <em>0-1-2</em>, <em>1-3-2</em>, which connect the four vertices together using two right triangles sharing the hypotenuse, which together form the quad.</p><pre><code class="js">gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, <span class="hljs-keyword">this</span>.indexBuffer);

<span class="hljs-keyword">var</span> indexData = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint16Array</span>(<span class="hljs-number">6</span> * graphics.length);
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; graphics.length; ++i) {
  indexData[i * <span class="hljs-number">6</span> + <span class="hljs-number">0</span>] = i * <span class="hljs-number">4</span> + <span class="hljs-number">0</span>;
  indexData[i * <span class="hljs-number">6</span> + <span class="hljs-number">1</span>] = i * <span class="hljs-number">4</span> + <span class="hljs-number">1</span>;
  indexData[i * <span class="hljs-number">6</span> + <span class="hljs-number">2</span>] = i * <span class="hljs-number">4</span> + <span class="hljs-number">2</span>;
  indexData[i * <span class="hljs-number">6</span> + <span class="hljs-number">3</span>] = i * <span class="hljs-number">4</span> + <span class="hljs-number">1</span>;
  indexData[i * <span class="hljs-number">6</span> + <span class="hljs-number">4</span>] = i * <span class="hljs-number">4</span> + <span class="hljs-number">3</span>;
  indexData[i * <span class="hljs-number">6</span> + <span class="hljs-number">5</span>] = i * <span class="hljs-number">4</span> + <span class="hljs-number">2</span>;
}
</code></pre><p>Finally the prepared data is uploaded to the GPU using <code>gl.bufferData</code> calls. The number of indices is recorded into the property <code>indexBufferSize</code> so that when <code>gl.drawElements</code> is called we know how many elements to draw.</p><h3 id="overriding-hittest()">Overriding <code>hitTest()</code></h3><p>The custom layer view that we implemented is a visual representation of an underlying geographical dataset, the <code>layer.graphics</code> collection. The user generally expects to be able to interact with such geographical information. This can be achieved by implementing the <code>hitTest()</code> method to return the graphic that is under a given screen point <em>(x, y)</em>.</p><p>If there are no graphics on the layer we return nothing.</p><pre><code class="js"><span class="hljs-comment">// The map view.</span>
<span class="hljs-keyword">var</span> view = <span class="hljs-keyword">this</span>.view;

<span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.layer.graphics.length === <span class="hljs-number">0</span>) {
  <span class="hljs-comment">// Nothing to do.</span>
  <span class="hljs-keyword">return</span> promiseUtils.resolve(<span class="hljs-literal">null</span>);
}
</code></pre><p>Otherwise we find the closest graphic in screen space.</p><pre><code class="js"><span class="hljs-keyword">var</span> distances = <span class="hljs-keyword">this</span>.layer.graphics.map(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">graphic</span>) </span>{
  <span class="hljs-keyword">var</span> graphicPoint = view.toScreen(graphic.geometry);
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.sqrt((graphicPoint.x - x) * (graphicPoint.x - x) + (graphicPoint.y - y) * (graphicPoint.y - y));
});

<span class="hljs-keyword">var</span> minIndex = <span class="hljs-number">0</span>;

distances.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">distance, i</span>) </span>{
  <span class="hljs-keyword">if</span> (distance &lt; distances.getItemAt(minIndex)) {
    minIndex = i;
  }
});

<span class="hljs-keyword">var</span> minDistance = distances.getItemAt(minIndex);
</code></pre><p>Since all markers are circles with a diameter of 70 pixels, it is safe to say that if the minimum distance is more than 35 pixels, then nothing was hit.</p><pre><code class="js"><span class="hljs-keyword">if</span> (minDistance &gt; <span class="hljs-number">35</span>) {
  <span class="hljs-keyword">return</span> promiseUtils.resolve(<span class="hljs-literal">null</span>);
}
</code></pre><p>Otherwise it is a hit; we set the layer as the source layer for the graphic (required for the popup view to work) and we return a promise resolving to the graphic.</p><pre><code class="js"><span class="hljs-keyword">var</span> graphic = <span class="hljs-keyword">this</span>.layer.graphics.getItemAt(minIndex);
graphic.sourceLayer = <span class="hljs-keyword">this</span>.layer;
<span class="hljs-keyword">return</span> promiseUtils.resolve(graphic);
</code></pre><p><img src="../../../assets/img/samples/custom-gl-2d-popup.png" alt="custom-gl-2d-popup"></p><p>Note that in a real-world custom visualization the markers may not be round, and their size and position may depend on properties of <a href="../../api-reference/esri-symbols-SimpleMarkerSymbol.html">SimpleMarkerSymbol</a>; the hit testing logic needs to account for it so that the interaction experience matches what the user sees on the screen.</p><h2 id="additional-visualization-samples-and-resources">Additional visualization samples and resources</h2><ul><li><a href="../scene-external-renderer-threejs/index.html">Sample: Use three.js from an external renderer</a></li><li><a href="../scene-external-renderer/index.html">Sample: Extend the SceneView WebGL engine</a></li><li><a href="../custom-gl-animated-lines/index.html">Sample: Animated lines with WebGL</a></li></ul><div class="clearfix"><div class="trailer-1 btn-group-sample-code js-btn-group-sample-code"><button class="btn btn-hidden btn-sample-code icon-ui-download js-btn-save-file" data-save-file-name="custom-gl-visuals" data-save-file="../../../latest/sample-code/custom-gl-visuals/live/index.html">Download</button> <a class="btn btn-sample-code js-btn-sample-code-sandbox" href="../../../latest/sample-code/sandbox/index.html?sample=custom-gl-visuals">Explore in the sandbox</a> <a class="btn btn-clear btn-sample-code icon-ui-link-external js-btn-jsshare" data-jsshare-url="../../../latest/sample-code/custom-gl-visuals/live/index.html">Open in CodePen</a> <a class="btn btn-clear btn-sample-code js-btn-sample-code-view-live" href="../../../latest/sample-code/custom-gl-visuals/live/index.html">View live</a></div></div><div class="leader-1 padding-leader-half"><h5 class="trailer-half">Tags</h5><div class="search-sdk-results-container-tags"><a class="btn btn-search-sdk-results-tag" href="../../../latest/sample-code/custom-gl-visuals/index.html?search=2D">2D</a><a class="btn btn-search-sdk-results-tag" href="../../../latest/sample-code/custom-gl-visuals/index.html?search=MapView">MapView</a><a class="btn btn-search-sdk-results-tag" href="../../../latest/sample-code/custom-gl-visuals/index.html?search=WebGL">WebGL</a><a class="btn btn-search-sdk-results-tag" href="../../../latest/sample-code/custom-gl-visuals/index.html?search=animation">animation</a><a class="btn btn-search-sdk-results-tag" href="../../../latest/sample-code/custom-gl-visuals/index.html?search=custom">custom</a><a class="btn btn-search-sdk-results-tag" href="../../../latest/sample-code/custom-gl-visuals/index.html?search=BaseLayerViewGL2D">BaseLayerViewGL2D</a><a class="btn btn-search-sdk-results-tag" href="../../../latest/sample-code/custom-gl-visuals/index.html?search=4.11">4.11</a></div></div></div><div class="search-sdk-results hide js-search-sdk-results"><h1 class="js-search-sdk-results-header">Sample search results</h1><div class="js-search-sdk-results-tags"></div><div class="trailer-1 clearfix"><div class="right js-toggle-view"><button class="view-toggle-btn is-active btn-grouped js-toggle-view-btn icon-ui-basemap icon-ui-flush" data-toggle-view-target="cards"></button> <button class="view-toggle-btn btn-grouped js-toggle-view-btn icon-ui-table icon-ui-flush" data-toggle-view-target="table"></button></div></div><div class="block-group block-group-4-up tablet-block-group-3-up phone-block-group-1-up js-search-sdk-results-cards"></div><table class="table table-striped hide js-search-sdk-results-table"><thead><tr><th>Title</th><th>Sample</th></tr></thead><tbody></tbody></table></div><div class="panel-no-border hide js-search-sdk-no-results"></div><div class="loader js-loader"><div class="loader-content"><div class="loader-bars"></div><div class="loader-text">Loading...</div></div></div></article></main></div><div class="footnote feedback right trailer-1"><a class="icon-ui-contact hide js-feedback" href="mailto:js_feedback@esri.com?subject=Feedback%20on%204.14%20-%20sample-code:%20Custom%20WebGL%20layer%20view&body=Hello,%0A%0AI%20was%20reading%20the%20ArcGIS%20API%20for%20JavaScript%20version%204.14%20documentation%20and%20have%20some%20feedback.%0A%0ADocumentation%20details:%0APage%20title:%20%7BREPLACE_TITLE%7D%0APage%20URL:%20%7BREPLACE_URL%7D%0AUser-Agent:%20%7BREPLACE_UA%7D%0A%0A">Feedback on this topic?</a></div></div></div><footer class="footer leader- link-dark-gray" role="contentinfo"><div class="grid-container"><nav class="column-6"><h6>ArcGIS for Developers</h6><ul class="list-plain"><li><a href="/">Home</a></li><li><a href="/features/">Features</a></li><li><a href="/documentation/">Documentation</a></li><li><a href="/support/">Support</a></li><li><a href="/pricing/">Pricing</a></li><li><a href="/startups/">Startups</a></li><li><a href="https://blogs.esri.com/esri/arcgis/category/developer/">Blog</a></li></ul></nav><nav class="column-6"><h6>ArcGIS Platform</h6><ul class="list-plain"><li><a href="http://arcgis.com">ArcGIS Online</a></li><li><a href="http://desktop.arcgis.com">ArcGIS Desktop</a></li><li><a href="http://server.arcgis.com">ArcGIS Enterprise</a></li><li><a href="http://developers.arcgis.com">ArcGIS for Developers</a></li><li><a href="http://solutions.arcgis.com">ArcGIS Solutions</a></li><li><a href="http://marketplace.arcgis.com">ArcGIS Marketplace</a></li></ul></nav><nav class="column-6"><h6>About Esri</h6><ul class="list-plain"><li><a href="http://www.esri.com/about-esri/">About Us</a></li><li><a href="http://www.esri.com/careers/">Careers</a></li><li><a href="https://blogs.esri.com/esri/esri-insider/">Insiders Blog</a></li><li><a href="http://www.esri.com/events/user-conference/index.html">User Conference</a></li><li><a href="http://www.esri.com/events/devsummit/index.html">Developer Summit</a></li></ul></nav><nav class="column-6"><a class="esri-logo" href="http://esri.com" aria-label="Esri Home"></a><div class="footer-social-nav leader-1"><a class="icon-social-twitter" aria-label="Esri on Twitter" href="https://twitter.com/Esri/"></a> <a class="icon-social-facebook" aria-label="Esri on Facebook" href="https://www.facebook.com/esrigis/"></a> <a class="icon-social-github" aria-label="Esri on GitHub" href="http://esri.github.com/"></a> <a class="icon-social-contact" aria-label="Contact Esri" href="http://www.esri.com/about-esri/contact/"></a></div></nav><div class="column-24 leader-1"><p><small><a href="http://www.esri.com/legal/copyright-trademarks">Copyright  2020 Esri</a>. All rights reserved. | <a href="http://www.esri.com/legal/privacy">Privacy</a> | <a href="http://www.esri.com/legal/software-license">Terms of use</a> | <a href="/terms/faq/">FAQ</a></small></p></div></div></footer><script></script><script>var relativePath=document.URL.replace(/[-\w\d]*\.(html|css|js).*/,"../../..")</script><script src="../../../assets/js/config.js"></script><script src="../../../assets/js/preparse.js"></script><script src="../../../assets/js/developers-components/sharedComponents.js"></script><script src="../../../assets/js/libs/FileSaver.js"></script><div class="js-modal modal-overlay modifier-class" data-modal="modal-keyboard-shortcuts"><div class="modal-content columns-16" aria-label="modal" role="dialog"><a class="js-modal-toggle right" href="#" aria-label="close-modal"><svg xmlns="http://www.w3.org/2000/svg" width="21" height="21" viewBox="0 0 32 32" class="svg-icon"><path d="M18.404 16l9.9 9.9-2.404 2.404-9.9-9.9-9.9 9.9L3.696 25.9l9.9-9.9-9.9-9.898L6.1 3.698l9.9 9.899 9.9-9.9 2.404 2.406-9.9 9.898z"/></svg></a><h4>Keyboard shortcuts</h4><hr class="leader-0 trailer-half"><div class="column-7"><table class="table-plain keyboard-mappings"><thead><tr><th></th><th>Site wide shortcuts</th></tr></thead><tbody><tr><td><kbd>?</kbd></td><td>Bring up this help dialog</td></tr><tr><td><kbd>esc</kbd></td><td>Dismiss this help dialog</td></tr><tr><td><kbd>g</kbd><kbd>h</kbd></td><td>Go to Home</td></tr><tr><td><kbd>g</kbd><kbd>g</kbd></td><td>Go to Guide</td></tr><tr><td><kbd>g</kbd><kbd>a</kbd></td><td>Go to API Reference</td></tr><tr><td><kbd>g</kbd><kbd>s</kbd></td><td>Go to Sample Code</td></tr><tr><td><kbd>g</kbd><kbd>t</kbd></td><td>Scroll to top of page</td></tr><tr><td><kbd>spacebar</kbd></td><td>Scroll page down</td></tr><tr><td><kbd>shift spacebar</kbd></td><td>Scroll page up</td></tr><tr><td><kbd>g</kbd><kbd>b</kbd></td><td>Scroll to bottom of page</td></tr></tbody></table></div><div class="column-7"><table class="table-plain keyboard-mappings"><thead><tr><th></th><th>Sample Code</th></tr></thead><tbody><tr><td><kbd>/</kbd></td><td>Focus search</td></tr><tr><td><kbd>esc</kbd></td><td>Remove search focus</td></tr><tr><td><kbd>enter</kbd></td><td>Focus first search result</td></tr><tr><td><kbd>e</kbd><kbd>s</kbd></td><td>Explore in the Sandbox</td></tr><tr><td><kbd>s</kbd></td><td>Share in online code editor</td></tr><tr><td><kbd>v</kbd><kbd>l</kbd></td><td>View live example</td></tr></tbody></table></div></div></div><script src="../../../assets/js/libs/url-search-params.js"></script><script src="../../../assets/js/calcite-web.js"></script><script src="../../../assets/js/calcite-web-extend.js"></script><script src="../../../assets/js/libs/mousetrap.js"></script><script>"function"==typeof Mousetrap&&"object"==typeof calcite&&"function"==typeof Mousetrap&&"object"==typeof calcite&&Mousetrap.bind(["/","e s","s","v l","g h","g g","g a","g s","?","g t","g b"],function(e,t){calcite.bus.emit("keyboard:mousetrap",{event:e,combination:t,navigation:{h:"../../../index.html",g:"../../../latest/guide/index.html",a:"../../../latest/api-reference/index.html",s:"../../../latest/sample-code/index.html"}})})</script></body></html>