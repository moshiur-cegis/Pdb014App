// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.14/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/graphics/featureConversionUtils":function(){define("require exports ../../core/Error ../../core/Logger ../../geometry/support/jsonUtils ./OptimizedFeature ./OptimizedFeatureSet ./OptimizedGeometry".split(" "),function(D,a,u,n,b,c,f,k){function r(a,l){return a?l?4:3:l?3:2}function v(a,l,b,c){if(a){if(b)return l&&c?Y:ba;if(l&&c)return W}else if(l&&c)return ba;return sa}function z(a,l){return Math.round((l-a.translate[0])/a.scale[0])}function t(a,l){return Math.round((a.translate[1]-
l)/a.scale[1])}function G(a,l){return l*a.scale[0]+a.translate[0]}function B(a,l){return a.translate[1]-l*a.scale[1]}function C(a){a=a.coords;return{x:a[0],y:a[1]}}function I(a,l){a.coords[0]=l.x;a.coords[1]=l.y;return a}function A(a){a=a.coords;return{x:a[0],y:a[1],z:a[2]}}function e(a,l){a.coords[0]=l.x;a.coords[1]=l.y;a.coords[2]=l.z;return a}function q(a){a=a.coords;return{x:a[0],y:a[1],m:a[2]}}function h(a,l){a.coords[0]=l.x;a.coords[1]=l.y;a.coords[2]=l.m;return a}function m(a){a=a.coords;return{x:a[0],
y:a[1],z:a[2],m:a[3]}}function p(a,l){a.coords[0]=l.x;a.coords[1]=l.y;a.coords[2]=l.z;a.coords[3]=l.m;return a}function E(a,l){return a&&l?p:a?e:l?h:I}function w(a,l,b){if(!a)return null;for(var c=r(l,b),e=[],h=0;h<a.coords.length;h+=c){for(var q=[],m=0;m<c;m++)q.push(a.coords[h+m]);e.push(q)}return l?b?{points:e,hasZ:l,hasM:b}:{points:e,hasZ:l}:b?{points:e,hasM:b}:{points:e}}function K(a,l,b){void 0===b&&(b=r(l.hasZ,l.hasM));a.lengths[0]=l.points.length;var c=a.coords,e=0,h=0;for(l=l.points;h<l.length;h++)for(var q=
l[h],m=0;m<b;m++)c[e++]=q[m];return a}function aa(a,l,b){if(!a)return null;var c=r(l,b),e=a.coords,h=[],q=0,m=0;for(a=a.lengths;m<a.length;m++){for(var p=a[m],k=[],F=0;F<p;F++){for(var f=[],X=0;X<c;X++)f.push(e[q++]);k.push(f)}h.push(k)}return l?b?{paths:h,hasZ:l,hasM:b}:{paths:h,hasZ:l}:b?{paths:h,hasM:b}:{paths:h}}function ia(a,l,b){void 0===b&&(b=r(l.hasZ,l.hasM));var c=a.lengths,e=a.coords,h=0,q=0;for(l=l.paths;q<l.length;q++){for(var m=l[q],p=0,k=m;p<k.length;p++)for(var F=k[p],f=0;f<b;f++)e[h++]=
F[f];c.push(m.length)}return a}function Q(a,l,b){if(!a)return null;var c=r(l,b),e=a.coords,h=[],q=0,m=0;for(a=a.lengths;m<a.length;m++){for(var p=a[m],k=[],F=0;F<p;F++){for(var f=[],X=0;X<c;X++)f.push(e[q++]);k.push(f)}h.push(k)}return l?b?{rings:h,hasZ:l,hasM:b}:{rings:h,hasZ:l}:b?{rings:h,hasM:b}:{rings:h}}function H(a,b,c,e){void 0===c&&(c=b.hasZ);void 0===e&&(e=b.hasM);l(a,b.rings,c,e);return a}function l(a,l,b,c){b=r(b,c);c=a.lengths;for(var e=a.coords,h=0,q=c.length=e.length=0;q<l.length;q++){for(var m=
l[q],p=0,k=m;p<k.length;p++)for(var F=k[p],f=0;f<b;f++)e[h++]=F[f];c.push(m.length)}return a}function F(a,l,b,e,h,q){a.length=0;if(!b){for(e=0;e<l.length;e++)h=l[e],a.push(new c.default(null,h.attributes,null,h.attributes[q]));return a}switch(b){case "esriGeometryPoint":e=E(e,h);for(h=0;h<l.length;h++){var m=l[h];b=m.geometry;var m=m.attributes,p=void 0;b&&(p=e(new k.default,b));a.push(new c.default(p,m,null,m[q]))}break;case "esriGeometryMultipoint":e=r(e,h);for(h=0;h<l.length;h++)m=l[h],b=m.geometry,
m=m.attributes,p=void 0,b&&(p=K(new k.default,b,e)),a.push(new c.default(p,m,null,m[q]));break;case "esriGeometryPolyline":e=r(e,h);for(h=0;h<l.length;h++)m=l[h],b=m.geometry,m=m.attributes,p=void 0,b&&(p=ia(new k.default,b,e)),a.push(new c.default(p,m,null,m[q]));break;case "esriGeometryPolygon":for(b=0;b<l.length;b++){var f=l[b],m=f.geometry,p=f.centroid,f=f.attributes,F=void 0;m&&(F=H(new k.default,m,e,h));p?a.push(new c.default(F,f,I(new k.default,p),f[q])):a.push(new c.default(F,f,null,f[q]))}break;
default:ta.error("convertToFeatureSet:unknown-geometry",new u("Unable to parse unknown geometry type '"+b+"'")),a.length=0}return a}function N(a,l,b,e,c){a.length=0;switch(b){case "esriGeometryPoint":b=C;e&&c?b=m:e?b=A:c&&(b=q);for(e=0;e<l.length;e++){var h=l[e];c=h.geometry;h=h.attributes;c=c?b(c):null;a.push({attributes:h,geometry:c})}break;case "esriGeometryMultipoint":for(b=0;b<l.length;b++){var p=l[b],h=p.geometry,p=p.attributes,f=void 0;h&&(f=w(h,e,c));a.push({attributes:p,geometry:f})}break;
case "esriGeometryPolyline":for(b=0;b<l.length;b++)p=l[b],h=p.geometry,p=p.attributes,f=void 0,h&&(f=aa(h,e,c)),a.push({attributes:p,geometry:f});break;case "esriGeometryPolygon":for(b=0;b<l.length;b++){var f=l[b],p=f.geometry,h=f.attributes,k=f.centroid,f=void 0;p&&(f=Q(p,e,c));k?(p=C(k),a.push({attributes:h,centroid:p,geometry:f})):a.push({attributes:h,geometry:f})}break;default:ta.error("convertToFeatureSet:unknown-geometry",new u("Unable to parse unknown geometry type '"+b+"'"))}return a}function ma(a,
l,b,e,c,h,m,p){void 0===m&&(m=b);void 0===p&&(p=e);a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!l||!l.coords.length)return null;c=za[c];var q=l.coords;l=l.lengths;var f=r(b,e),k=r(b&&m,e&&p);b=v(b,e,m,p);if(!l.length)return b(a.coords,q,0,0,z(h,q[0]),t(h,q[1])),a.lengths.length&&(a.lengths.length=0),a.coords.length=f,a;for(var F,E=0,A,B=0,w=0;w<l.length;w++){var C=l[w];if(!(C<c)){var H=0;A=B;p=e=z(h,q[E]);F=m=t(h,q[E+1]);b(a.coords,q,A,E,p,F);H++;E+=f;A+=k;for(var V=
1;V<C;V++,E+=f)if(p=z(h,q[E]),F=t(h,q[E+1]),p!==e||F!==m)b(a.coords,q,A,E,p-e,F-m),A+=k,H++,e=p,m=F;H>=c&&(a.lengths.push(H),B=A)}}a.coords.length=B;return a.coords.length?a:null}function V(a,l,b,e,c,h,m){for(var p=e,q=0,f,k=h+b;k<m;k+=b){f=l[k];var F=l[k+1],E=l[m],A=l[m+1],B=l[h],w=l[h+1],C=E-B,r=A-w;if(0!==C||0!==r){var H=((f-B)*C+(F-w)*r)/(C*C+r*r);1<H?(B=E,w=A):0<H&&(B+=C*H,w+=r*H)}C=f-B;r=F-w;f=C*C+r*r;f>p&&(q=k,p=f)}p>e&&(q-h>b&&V(a,l,b,e,c,h,q),c(a,l,a.length,q,l[q],l[q+1]),m-q>b&&V(a,l,b,
e,c,q,m))}function Z(a,l,b,e,c){var h=l.coords,m=l.lengths,q=b?e?Y:ba:e?ba:sa;b=r(b,e);if(!h.length)return a!==l&&(a.lengths.length=0,a.coords.length=0),a;if(!m.length)return q(a.coords,h,0,0,G(c,h[0]),B(c,h[1])),a!==l&&(a.lengths.length=0,a.coords.length=b),a;var p=c.scale;e=p[0];for(var p=p[1],f=0,k=0;k<m.length;k++){var F=m[k];a.lengths[k]=F;var E=G(c,h[f]),A=B(c,h[f+1]);q(a.coords,h,f,f,E,A);for(var f=f+b,w=1;w<F;w++,f+=b)E+=h[f]*e,A-=h[f+1]*p,q(a.coords,h,f,f,E,A)}a!==l&&(a.lengths.length=m.length,
a.coords.length=h.length);return a}Object.defineProperty(a,"__esModule",{value:!0});var ta=n.getLogger("esri.tasks.support.optimizedFeatureSet"),za={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},sa=function(a,l,b,e,h,c){a[b]=h;a[b+1]=c},ba=function(a,l,b,e,h,c){a[b]=h;a[b+1]=c;a[b+2]=l[e+2]},W=function(a,l,b,e,h,c){a[b]=h;a[b+1]=c;a[b+2]=l[e+3]},Y=function(a,l,b,e,h,c){a[b]=h;a[b+1]=c;a[b+2]=l[e+2];a[b+3]=l[e+3]};a.quantizeX=z;a.quantizeY=t;a.hydrateX=
G;a.hydrateY=B;a.convertToPoint=function(a,l,b){return a?l?b?m(a):A(a):b?q(a):C(a):null};a.convertFromPoint=function(a,l,b){void 0===b&&(b=E(null!=l.z,null!=l.m));return b(a,l)};a.convertToMultipoint=w;a.convertFromMultipoint=K;a.convertToPolyline=aa;a.convertFromPolyline=ia;a.convertToPolygon=Q;a.convertFromPolygon=H;a.convertFromNestedArray=l;var L=[],S=[];a.convertFromFeature=function(a,l,b,e,h){L[0]=a;a=F(S,L,l,b,e,h)[0];L.length=S.length=0;return a};a.convertFromFeatures=F;a.convertToFeature=
function(a,l,b,e){S[0]=a;N(L,S,l,b,e);a=L[0];L.length=S.length=0;return a};a.convertFromGeometry=function(a,l,e){if(!a)return null;var h=new k.default;"hasZ"in a&&null==l&&(l=a.hasZ);"hasM"in a&&null==e&&(e=a.hasM);if(b.isPoint(a))return E(null!=l?l:null!=a.z,null!=e?e:null!=a.m)(h,a);if(b.isPolygon(a))return H(h,a,l,e);if(b.isPolyline(a))return ia(h,a,r(l,e));if(b.isMultipoint(a))return K(h,a,r(l,e));ta.error("convertFromGeometry:unknown-geometry",new u("Unable to parse unknown geometry type '"+
a+"'"))};a.convertToGeometry=function(a,l,b,e){a=a&&("coords"in a?a:a.geometry);if(!a)return null;switch(l){case "esriGeometryPoint":return l=C,b&&e?l=m:b?l=A:e&&(l=q),l(a);case "esriGeometryMultipoint":return w(a,b,e);case "esriGeometryPolyline":return aa(a,b,e);case "esriGeometryPolygon":return Q(a,b,e);default:ta.error("convertToGeometry:unknown-geometry",new u("Unable to parse unknown geometry type '"+l+"'"))}};a.convertToFeatures=N;a.convertToFeatureSet=function(a){var l=a.objectIdFieldName,
b=a.spatialReference,e=a.transform,h=a.fields,c=a.hasM,m=a.hasZ,q=a.geometryType,p=a.exceededTransferLimit;a={features:N([],a.features,q,m,c),fields:h,geometryType:q,objectIdFieldName:l,spatialReference:b};e&&(a.transform=e);p&&(a.exceededTransferLimit=p);c&&(a.hasM=c);m&&(a.hasZ=m);return a};a.convertFromFeatureSet=function(a,l){var b=new f.default,e=a.hasM,h=a.hasZ,c=a.features,m=a.objectIdFieldName,q=a.spatialReference,p=a.geometryType,k=a.exceededTransferLimit,E=a.transform;b.fields=a.fields;
b.geometryType=p;b.objectIdFieldName=m||l;b.spatialReference=q;if(!b.objectIdFieldName)return ta.error(new u("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),b;c&&F(b.features,c,p,h,e,b.objectIdFieldName);k&&(b.exceededTransferLimit=k);e&&(b.hasM=e);h&&(b.hasZ=h);E&&(b.transform=E);return b};a.hydrateOptimizedFeatureSet=function(a){var l=a.transform,b=a.hasM,e=a.hasZ;if(!l)return a;for(var h=0,c=a.features;h<c.length;h++){var m=c[h];m.geometry&&Z(m.geometry,m.geometry,
b,e,l);m.centroid&&Z(m.centroid,m.centroid,b,e,l)}a.transform=null;return a};a.quantizeOptimizedFeatureSet=function(a,l){var b=l.geometryType,e=l.features,h=l.hasM,m=l.hasZ;if(!a)return l;for(var p=0;p<e.length;p++){var q=e[p],f=new c.default(new k.default,q.attributes);ma(f.geometry,q.geometry,h,m,b,a);q.centroid&&(f.centroid=new k.default,ma(f.centroid,q.centroid,h,m,"esriGeometryPoint",a));e[p]=f}l.transform=a;return l};a.quantizeOptimizedGeometry=ma;a.generalizeOptimizedGeometry=function(a,l,
b,e,h,c,m,p){void 0===m&&(m=b);void 0===p&&(p=e);a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!l||!l.coords.length)return null;h=za[h];var q=l.coords;l=l.lengths;var f=r(b,e),k=r(b&&m,e&&p);b=v(b,e,m,p);if(!l.length)return b(a.coords,q,0,0,q[0],q[1]),a.lengths.length&&(a.lengths.length=0),a.coords.length=f,a;e=0;c*=c;for(m=0;m<l.length;m++){p=l[m];if(!(p<h)){var F=a.coords.length/k,E=e,A=e+(p-1)*f;b(a.coords,q,a.coords.length,E,q[E],q[E+1]);V(a.coords,q,f,c,b,E,A);
b(a.coords,q,a.coords.length,A,q[A],q[A+1]);E=a.coords.length/k-F;E>=h?a.lengths.push(E):a.coords.length=F*k}e+=p*f}return a.coords.length?a:null};a.getBoundsOptimizedGeometry=function(a,l,b,e){b=r(b,e);var h=e=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,m=Number.NEGATIVE_INFINITY;if(l&&l.coords){l=l.coords;for(var q=0;q<l.length;q+=b){var p=l[q],f=l[q+1];e=Math.min(e,p);c=Math.max(c,p);h=Math.min(h,f);m=Math.max(m,f)}}a[0]=e;a[1]=h;a[2]=c;a[3]=m;return a};a.getQuantizedBoundsOptimizedGeometry=
function(a,l,b,e){b=r(b,e);e=l.coords;var h=Number.POSITIVE_INFINITY,c=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY,q=Number.NEGATIVE_INFINITY,p=0,f=0;for(l=l.lengths;f<l.length;f++)for(var k=l[f],F=e[p],E=e[p+1],h=Math.min(F,h),c=Math.min(E,c),m=Math.max(F,m),q=Math.max(E,q),p=p+b,A=1;A<k;A++,p+=b){var w=e[p],B=e[p+1],F=F+w,E=E+B;0>w&&(h=Math.min(h,F));0<w&&(m=Math.max(m,F));0>B?c=Math.min(c,E):0<B&&(q=Math.max(q,E))}a[0]=h;a[1]=c;a[2]=m;a[3]=q;return a};a.hydrateOptimizedGeometry=Z;a.removeZMValues=
function(a,l,b,e,h,c){var m,q=r(b,e);b=v(b,e,h,c);e=l.coords;a.coords.length=0;a.lengths.length=0;(m=a.lengths).push.apply(m,l.lengths);for(l=0;l<e.length;l+=q)b(a.coords,e,a.coords.length,l,e[l],e[l+1]);return a};a.removeCollinearVectices=function(a,l,b,e,h){if(!l||!l.coords||!l.coords.length)return null;b=za[b];var c=l.coords;l=l.lengths;var m=v(e,h,e,h);e=r(e,h);for(var q=h=0,p=0,f=0,k=0;k<l.length;k++){var F=l[k],q=f;m(a.coords,c,q,h,c[h],c[h+1]);h+=e;var E=c[h],A=c[h+1],w=E,B=A,C=A/E,q=q+e;m(a.coords,
c,q,h,w,B);h+=e;for(var H=2;H<F;H++){var E=c[h],A=c[h+1],V=A/E,n=C===V||!isFinite(C)&&!isFinite(V),C=n&&isFinite(V)?0<=C&&0<=V||0>=C&&0>=V:0<=B&&0<=A||0>=B&&0>=A;n&&C?(w+=E,B+=A):(w=E,B=A,q+=e);m(a.coords,c,q,h,w,B);h+=e;C=V}q+=e;F=(q-f)/e;F>=b&&(a.lengths[p]=F,f=q,p++)}a.coords.length>q&&(a.coords.length=q);a.lengths.length>p&&(a.lengths.length=p);return a.coords.length?a:null}})},"esri/layers/graphics/data/FeatureStore":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Error ../../../core/Evented ../../../core/Logger ../../../core/maybe ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./BoundsStore ./executeTileQuery ./optimizedFeatureQueryEngineAdapter".split(" "),
function(D,a,u,n,b,c,f,k,r,v,z,t,G,B,C,I,A){Object.defineProperty(a,"__esModule",{value:!0});var e=r.getLogger("esri.layers.graphics.data.FeatureStore");D=function(){function a(a){this.geometryInfo=a;this._boundsStore=new C.BoundsStore;this._featuresById=new Map;this._markedIds=new Set;this.events=new k;this.featureAdapter=A.optimizedFeatureQueryEngineAdapter}Object.defineProperty(a.prototype,"geometryType",{get:function(){return this.geometryInfo.geometryType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"hasM",{get:function(){return this.geometryInfo.hasM},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasZ",{get:function(){return this.geometryInfo.hasZ},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"numFeatures",{get:function(){return this._featuresById.size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fullBounds",{get:function(){var a=this;if(!this.numFeatures)return null;var b=t.create(t.NEGATIVE_INFINITY);this._featuresById.forEach(function(e){if(e=
a._boundsStore.get(e.objectId))b[0]=Math.min(e[0],b[0]),b[1]=Math.min(e[1],b[1]),b[2]=Math.max(e[2],b[2]),b[3]=Math.max(e[3],b[3])});return b},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"storeStatistics",{get:function(){var a=0;this._featuresById.forEach(function(b){b.geometry&&b.geometry.coords&&(a+=b.geometry.coords.length)});return{featureCount:this._featuresById.size,vertexCount:a/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}},enumerable:!0,configurable:!0});a.prototype.add=
function(a){this._add(a);this._emitChanged()};a.prototype.addMany=function(a){for(var b=0;b<a.length;b++)this._add(a[b]);this._emitChanged()};a.prototype.clear=function(){this._featuresById.clear();this._boundsStore.clear();this._emitChanged()};a.prototype.removeById=function(a){a=this._featuresById.get(a);if(!a)return null;this._remove(a);this._emitChanged();return a};a.prototype.removeManyById=function(a){this._boundsStore.invalidateIndex();for(var b=0;b<a.length;b++){var e=this._featuresById.get(a[b]);
e&&this._remove(e)}this._emitChanged()};a.prototype.forEachBounds=function(a,b,e){for(var c=0;c<a.length;c++){var h=this._boundsStore.get(a[c].objectId);h&&b(z.fromRect(e,h))}};a.prototype.getFeature=function(a){return this._featuresById.get(a)};a.prototype.has=function(a){return this._featuresById.has(a)};a.prototype.forEach=function(a){this._featuresById.forEach(function(b){return a(b)})};a.prototype.forEachInBounds=function(a,b){var e=this;this._boundsStore.forEachInBounds(a,function(a){b(e._featuresById.get(a))})};
a.prototype.startMarkingUsedFeatures=function(){this._boundsStore.invalidateIndex();this._markedIds.clear()};a.prototype.sweep=function(){var a=this,b=!1;this._featuresById.forEach(function(e,c){a._markedIds.has(c)||(b=!0,a._remove(e))});this._markedIds.clear();b&&this._emitChanged()};a.prototype.executeTileQuery=function(a,b,e){return n(this,void 0,void 0,function(){var c,h,q,m,p,f,k,l,F,A,B,C,r,n;return u(this,function(E){c=e.returnGeometry;h=e.returnCentroid;q=e.returnOutline;m=e.pixelBuffer;p=
new Set;f=[];k=m*a.resolution;l=t.pad(a.bounds,k,t.create());I.createTileFeatures(f,p,this.geometryInfo,this,l,c,h,q,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[a.bounds[0],a.bounds[3]]});if("esriGeometryPoint"===this.geometryType||h)if(F=G.getInfo(b))A=F.valid,B=A[0],C=A[1],l[0]<B&&(r=t.fromValues(C-k,l[1],C,l[3]),I.createTileFeatures(f,p,this.geometryInfo,this,r,c,h,q,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[C,a.bounds[3]]})),l[2]>C&&
(n=t.fromValues(B,l[1],B+k,l[3]),I.createTileFeatures(f,p,this.geometryInfo,this,n,c,h,q,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[B-C+a.bounds[0],a.bounds[3]]}));f.sort(function(a,l){return a.localId-l.localId});return[2,{features:f,objectIds:p}]})})};a.prototype._emitChanged=function(){this.events.emit("changed",void 0)};a.prototype._add=function(a){if(a){var b=a.objectId;if(null==b)e.error(new f("featurestore:invalid-feature","feature id is missing",{feature:a}));
else{var c=this._featuresById.get(b),h;this._markedIds.add(b);if(c)a.localId=c.localId,h=this._boundsStore.get(b),this._boundsStore.delete(b);else if(v.isSome(this.onFeatureAdd))this.onFeatureAdd(a);a.geometry&&a.geometry.coords&&a.geometry.coords.length?(h=B.getBoundsOptimizedGeometry(h||t.create(),a.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),this._boundsStore.set(b,h)):this._boundsStore.set(b,null);this._featuresById.set(b,a)}}};a.prototype._remove=function(a){if(v.isSome(this.onFeatureRemove))this.onFeatureRemove(a);
this._markedIds.delete(a.objectId);this._boundsStore.delete(a.objectId);this._featuresById.delete(a.objectId);return a};return a}();a.default=D})},"esri/layers/graphics/data/BoundsStore":function(){define(["require","exports","../../../core/has","../../../core/libs/rbush/rbush","@dojo/framework/shim/Promise"],function(D,a,u,n){Object.defineProperty(a,"__esModule",{value:!0});var b={minX:0,minY:0,maxX:0,maxY:0};D=function(){function a(){var a=this;this._indexInvalid=!1;this._boundsToLoad=[];this._boundsById=
new Map;this._idByBounds=new Map;this._index=n(9,u("csp-restrictions")?function(a){return{minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]}}:["[0]","[1]","[2]","[3]"]);this._loadIndex=function(){if(a._indexInvalid){var b=Array(a._idByBounds.size),c=0;a._idByBounds.forEach(function(a,f){b[c++]=f});a._indexInvalid=!1;a._index.clear();a._index.load(b)}else a._boundsToLoad.length&&(a._index.load(a._boundsToLoad.filter(function(b){return a._idByBounds.has(b)})),a._boundsToLoad.length=0)}}a.prototype.clear=function(){this._indexInvalid=
!1;this._boundsToLoad.length=0;this._boundsById.clear();this._idByBounds.clear();this._index.clear()};a.prototype.delete=function(a){var b=this._boundsById.get(a);this._boundsById.delete(a);b&&(this._idByBounds.delete(b),this._indexInvalid||this._index.remove(b))};a.prototype.forEachInBounds=function(a,c){this._loadIndex();var f=0,k=this._index;b.minX=a[0];b.minY=a[1];b.maxX=a[2];b.maxY=a[3];for(a=k.search(b);f<a.length;f++)c(this._idByBounds.get(a[f]))};a.prototype.get=function(a){return this._boundsById.get(a)};
a.prototype.has=function(a){return this._boundsById.has(a)};a.prototype.invalidateIndex=function(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)};a.prototype.set=function(a,b){if(!this._indexInvalid){var c=this._boundsById.get(a);c&&(this._index.remove(c),this._idByBounds.delete(c))}this._boundsById.set(a,b);b&&(this._idByBounds.set(b,a),this._indexInvalid||this._boundsToLoad.push(b))};return a}();a.BoundsStore=D})},"esri/core/libs/rbush/rbush":function(){define(["../quickselect/quickselect"],
function(D){function a(b,c){if(!(this instanceof a))return new a(b,c);this._maxEntries=Math.max(4,b||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));c&&("function"===typeof c?this.toBBox=c:this._initFormat(c));this.clear()}function u(a,b){n(a,0,a.children.length,b,a)}function n(a,c,f,k,e){e||(e=t(null));e.minX=Infinity;e.minY=Infinity;e.maxX=-Infinity;e.maxY=-Infinity;for(var q;c<f;c++)q=a.children[c],b(e,a.leaf?k(q):q);return e}function b(a,b){a.minX=Math.min(a.minX,b.minX);a.minY=
Math.min(a.minY,b.minY);a.maxX=Math.max(a.maxX,b.maxX);a.maxY=Math.max(a.maxY,b.maxY);return a}function c(a,b){return a.minX-b.minX}function f(a,b){return a.minY-b.minY}function k(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function r(a){return a.maxX-a.minX+(a.maxY-a.minY)}function v(a,b){return a.minX<=b.minX&&a.minY<=b.minY&&b.maxX<=a.maxX&&b.maxY<=a.maxY}function z(a,b){return b.minX<=a.maxX&&b.minY<=a.maxY&&b.maxX>=a.minX&&b.maxY>=a.minY}function t(a){return{children:a,height:1,leaf:!0,minX:Infinity,
minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function G(a,b,c,f,e){for(var q=[b,c],h;q.length;)c=q.pop(),b=q.pop(),c-b<=f||(h=b+Math.ceil((c-b)/f/2)*f,D(a,h,b,c,e),q.push(b,h,h,c))}a.prototype={all:function(){return this._all(this.data,[])},search:function(a){var b=this.data,c=[],f=this.toBBox;if(!z(a,b))return c;for(var e=[],q,h,m,p;b;){q=0;for(h=b.children.length;q<h;q++)m=b.children[q],p=b.leaf?f(m):m,z(a,p)&&(b.leaf?c.push(m):v(a,p)?this._all(m,c):e.push(m));b=e.pop()}return c},collides:function(a){var b=
this.data,c=this.toBBox;if(!z(a,b))return!1;for(var f=[],e,q,h,m;b;){e=0;for(q=b.children.length;e<q;e++)if(h=b.children[e],m=b.leaf?c(h):h,z(a,m)){if(b.leaf||v(a,m))return!0;f.push(h)}b=f.pop()}return!1},load:function(a){if(!a||!a.length)return this;if(a.length<this._minEntries){for(var b=0,c=a.length;b<c;b++)this.insert(a[b]);return this}a=this._build(a.slice(),0,a.length-1,0);this.data.children.length?this.data.height===a.height?this._splitRoot(this.data,a):(this.data.height<a.height&&(b=this.data,
this.data=a,a=b),this._insert(a,this.data.height-a.height-1,!0)):this.data=a;return this},insert:function(a){a&&this._insert(a,this.data.height-1);return this},clear:function(){this.data=t([]);return this},remove:function(a,b){if(!a)return this;for(var c=this.data,f=this.toBBox(a),e=[],q=[],h,m,p,k;c||e.length;){c||(c=e.pop(),m=e[e.length-1],h=q.pop(),k=!0);if(c.leaf){a:{p=a;var w=c.children,r=b;if(r){for(var n=0;n<w.length;n++)if(r(p,w[n])){p=n;break a}p=-1}else p=w.indexOf(p)}if(-1!==p){c.children.splice(p,
1);e.push(c);this._condense(e);break}}k||c.leaf||!v(c,f)?m?(h++,c=m.children[h],k=!1):c=null:(e.push(c),q.push(h),h=0,m=c,c=c.children[0])}return this},toBBox:function(a){return a},compareMinX:c,compareMinY:f,toJSON:function(){return this.data},fromJSON:function(a){this.data=a;return this},_all:function(a,b){for(var c=[];a;)a.leaf?b.push.apply(b,a.children):c.push.apply(c,a.children),a=c.pop();return b},_build:function(a,b,c,f){var e=c-b+1,q=this._maxEntries,h;if(e<=q)return h=t(a.slice(b,c+1)),u(h,
this.toBBox),h;f||(f=Math.ceil(Math.log(e)/Math.log(q)),q=Math.ceil(e/Math.pow(q,f-1)));h=t([]);h.leaf=!1;h.height=f;var e=Math.ceil(e/q),q=e*Math.ceil(Math.sqrt(q)),m,p,k;for(G(a,b,c,q,this.compareMinX);b<=c;b+=q)for(p=Math.min(b+q-1,c),G(a,b,p,e,this.compareMinY),m=b;m<=p;m+=e)k=Math.min(m+e-1,p),h.children.push(this._build(a,m,k,f-1));u(h,this.toBBox);return h},_chooseSubtree:function(a,b,c,f){for(var e,q,h,m,p,E,A,r;;){f.push(b);if(b.leaf||f.length-1===c)break;A=r=Infinity;e=0;for(q=b.children.length;e<
q;e++)h=b.children[e],p=k(h),E=(Math.max(h.maxX,a.maxX)-Math.min(h.minX,a.minX))*(Math.max(h.maxY,a.maxY)-Math.min(h.minY,a.minY))-p,E<r?(r=E,A=p<A?p:A,m=h):E===r&&p<A&&(A=p,m=h);b=m||b.children[0]}return b},_insert:function(a,c,f){var k=this.toBBox;f=f?a:k(a);var k=[],e=this._chooseSubtree(f,this.data,c,k);e.children.push(a);for(b(e,f);0<=c;)if(k[c].children.length>this._maxEntries)this._split(k,c),c--;else break;this._adjustParentBBoxes(f,k,c)},_split:function(a,b){var c=a[b],f=c.children.length,
e=this._minEntries;this._chooseSplitAxis(c,e,f);f=this._chooseSplitIndex(c,e,f);f=t(c.children.splice(f,c.children.length-f));f.height=c.height;f.leaf=c.leaf;u(c,this.toBBox);u(f,this.toBBox);b?a[b-1].children.push(f):this._splitRoot(c,f)},_splitRoot:function(a,b){this.data=t([a,b]);this.data.height=a.height+1;this.data.leaf=!1;u(this.data,this.toBBox)},_chooseSplitIndex:function(a,b,c){var f,e,q,h,m,p,E;m=p=Infinity;for(f=b;f<=c-b;f++)e=n(a,0,f,this.toBBox),q=n(a,f,c,this.toBBox),h=Math.max(0,Math.min(e.maxX,
q.maxX)-Math.max(e.minX,q.minX))*Math.max(0,Math.min(e.maxY,q.maxY)-Math.max(e.minY,q.minY)),e=k(e)+k(q),h<m?(m=h,E=f,p=e<p?e:p):h===m&&e<p&&(p=e,E=f);return E},_chooseSplitAxis:function(a,b,k){var A=a.leaf?this.compareMinX:c,e=a.leaf?this.compareMinY:f,q=this._allDistMargin(a,b,k,A);b=this._allDistMargin(a,b,k,e);q<b&&a.children.sort(A)},_allDistMargin:function(a,c,f,k){a.children.sort(k);k=this.toBBox;var e=n(a,0,c,k),q=n(a,f-c,f,k),h=r(e)+r(q),m,p;for(m=c;m<f-c;m++)p=a.children[m],b(e,a.leaf?k(p):
p),h+=r(e);for(m=f-c-1;m>=c;m--)p=a.children[m],b(q,a.leaf?k(p):p),h+=r(q);return h},_adjustParentBBoxes:function(a,c,f){for(;0<=f;f--)b(c[f],a)},_condense:function(a){for(var b=a.length-1,c;0<=b;b--)0===a[b].children.length?0<b?(c=a[b-1].children,c.splice(c.indexOf(a[b]),1)):this.clear():u(a[b],this.toBBox)},_initFormat:function(a){var b=["return a"," - b",";"];this.compareMinX=new Function("a","b",b.join(a[0]));this.compareMinY=new Function("a","b",b.join(a[1]));this.toBBox=new Function("a","return {minX: a"+
a[0]+", minY: a"+a[1]+", maxX: a"+a[2]+", maxY: a"+a[3]+"};")}};return a})},"esri/core/libs/quickselect/quickselect":function(){define([],function(){function D(n,b,c,f,k){for(;f>c;){if(600<f-c){var r=f-c+1,v=b-c+1,z=Math.log(r),t=.5*Math.exp(2*z/3),z=.5*Math.sqrt(z*t*(r-t)/r)*(0>v-r/2?-1:1);D(n,b,Math.max(c,Math.floor(b-v*t/r+z)),Math.min(f,Math.floor(b+(r-v)*t/r+z)),k)}r=n[b];v=c;t=f;a(n,c,b);for(0<k(n[f],r)&&a(n,c,f);v<t;){a(n,v,t);v++;for(t--;0>k(n[v],r);)v++;for(;0<k(n[t],r);)t--}0===k(n[c],r)?
a(n,c,t):(t++,a(n,t,f));t<=b&&(c=t+1);b<=t&&(f=t-1)}}function a(a,b,c){var f=a[b];a[b]=a[c];a[c]=f}function u(a,b){return a<b?-1:a>b?1:0}return function(a,b,c,f,k){D(a,b,c||0,f||a.length-1,k||u)}})},"esri/layers/graphics/data/executeTileQuery":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../geometry/support/aaBoundingRect ../featureConversionUtils ../OptimizedGeometry ./QueryEngine ./utils".split(" "),
function(D,a,u,n,b,c,f,k,r,v){function z(a,b,c,e,q,h){a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!b||!b.coords.length)return null;var m=b.coords;b=b.lengths;if(!b.length)return a.coords[0]=f.quantizeX(h,m[0]),a.coords[1]=f.quantizeY(h,m[1]),a.coords.length=c,a;for(var p,k,w,r,A=0,n,t=0,H=0;H<b.length;H++){var l=b[H];if(!(l<e)){n=t;w=p=f.quantizeX(h,m[A]);r=k=f.quantizeY(h,m[A+1]);a.coords[n]=w;a.coords[n+1]=r;A+=c;w=f.quantizeX(h,m[A]);r=f.quantizeY(h,m[A+1]);var F=
w-p,N=r-k,v=N/F;n+=2;a.coords[n]=F;a.coords[n+1]=N;p=w;k=r;for(var A=A+c,V=2;V<l;V++){w=f.quantizeX(h,m[A]);r=f.quantizeY(h,m[A+1]);if(w!==p||r!==k){p=w-p;k=r-k;var Z=k/p,v=v===Z||!isFinite(v)&&!isFinite(Z),ta=(0<=N&&0<=k||0>=N&&0>=k)&&(0<=F&&0<=p||0>=F&&0>=p);v&&(q||ta)?(F+=p,N+=k):(F=p,N=k,n+=2);a.coords[n]=F;a.coords[n+1]=N;v=Z;p=w;k=r}A+=c}w=(n+2-t)/2;w>=e&&(a.lengths.push(w),t=n+2)}}a.coords.length>t&&(a.coords.length=t);return a.coords.length?a:null}Object.defineProperty(a,"__esModule",{value:!0});
var t=new k.default,G={esriGeometryPoint:f.convertToPoint,esriGeometryPolyline:f.convertToPolyline,esriGeometryPolygon:f.convertToPolygon,esriGeometryMultipoint:f.convertToMultipoint};a.executeTileQueryForIds=function(a,b,f){b=c.pad(b.bounds,f.pixelBuffer*b.resolution,c.create());var e=[];a.featureStore.forEachInBounds(b,function(b){return e.push(a.featureAdapter.getObjectId(b))});return e};a.createTileFeatures=function(a,b,c,e,f,h,m,p,k){var q=G[c.geometryType],E=B[c.geometryType],A="esriGeometryPolygon"===
c.geometryType&&!p,n=c.hasZ?c.hasM?4:3:c.hasM?3:2;m&&!h?e.forEachInBounds(f,function(e){if(!b.has(e.objectId)){var h=v.getCentroid(c,e,k),l=e.attributes;h&&(b.add(e.objectId),a.push(new r.Feature(l,e.localId,null,h)))}}):h&&!m?e.forEachInBounds(f,function(c){if(!b.has(c.objectId)){var e=c.attributes,l=q(z(t,c.geometry,n,E,A,k),!1,!1);l&&(b.add(c.objectId),a.push(new r.Feature(e,c.localId,l,null)))}}):e.forEachInBounds(f,function(e){if(!b.has(e.objectId)){var h=v.getCentroid(c,e,k),l=e.attributes,
f=q(z(t,e.geometry,n,E,A,k),!1,!1);f&&h&&(b.add(e.objectId),a.push(new r.Feature(l,e.localId,f,h)))}})};var B={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0};a.quantizeOptimizedGeometryForDisplay=z})},"esri/layers/graphics/data/QueryEngine":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/iteratorUtils ../../../core/lang ../../../core/Logger ../../../core/MemCache ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ./attributeSupport ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./spatialQuerySupport ./timeSupport ./utils ../../support/FieldsIndex ../../support/PromiseQueue".split(" "),
function(D,a,u,n,b,c,f,k,r,v,z,t,G,B,C,I,A,e,q,h,m,p,E,w,K,aa){Object.defineProperty(a,"__esModule",{value:!0});var ia=r.getLogger("esri.layers.graphics.data.QueryEngine");D=function(){return function(a,b,l,c,e){void 0===b&&(b=null);this.attributes=a;this.geometry=l;this.centroid=c;this.filterFlags=e;this.groupId=-1;this.localId=b}}();a.Feature=D;var Q=new Set,H=new v.MemCacheStorage(2E6),l=0;D=function(){function a(a){var b=this;this.capabilities={query:h.queryCapabilities};this.geometryType=a.geometryType;
this.hasM=a.hasM;this.hasZ=a.hasZ;this.objectIdField=a.objectIdField;this.spatialReference=a.spatialReference;this.definitionExpression=a.definitionExpression;this.cacheSpatialQueries=a.cacheSpatialQueries||!1;this.featureStore=a.featureStore;this._changeHandle=this.featureStore.events.on("changed",function(){return b.clearCache()});this.timeInfo=a.timeInfo;this.cacheSpatialQueries&&(this._geometryQueryCache=new v.MemCache(l++ +"$$",H));this.fieldsIndex=new K(a.fields);a.scheduler&&a.task&&(this._frameQueue=
new aa.PromiseQueue,this._frameTask=a.scheduler.registerTask(a.task,function(a){return b._update(a)},function(){return 0<b._frameQueue.length}))}a.prototype.destroy=function(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null);this.clearCache();this._geometryQueryCache&&this._geometryQueryCache.destroy();this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null);this.fieldsIndex.destroy()};Object.defineProperty(a.prototype,
"featureAdapter",{get:function(){return this.featureStore.featureAdapter},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fullExtent",{get:function(){var a=this.featureStore.fullBounds;return a?{xmin:a[0],ymin:a[1],xmax:a[2],ymax:a[3],spatialReference:w.cleanFromGeometryEngine(this.spatialReference)}:null},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"timeExtent",{get:function(){return this.timeInfo?this._timeExtent?this._timeExtent:this._timeExtent=E.getTimeExtent(this.timeInfo,
this.featureStore):null},enumerable:!0,configurable:!0});a.prototype.clearCache=function(){this._geometryQueryCache&&this._geometryQueryCache.clear();this._timeExtent=this._allItems=null};a.prototype.executeQuery=function(a,l){void 0===a&&(a={});return b(this,void 0,void 0,function(){var b,l,c;return n(this,function(e){switch(e.label){case 0:b=k.clone(a),e.label=1;case 1:return e.trys.push([1,14,,15]),[4,this._schedule()];case 2:return e.sent(),[4,w.normalizeQuery(b,this.definitionExpression,this.spatialReference)];
case 3:return b=e.sent(),[4,this._reschedule()];case 4:return e.sent(),[4,this._checkQuerySupport(b)];case 5:return b=e.sent(),[4,this._reschedule()];case 6:return e.sent(),[4,this._executeGeometryQuery(b)];case 7:return l=e.sent(),[4,this._reschedule()];case 8:return e.sent(),[4,l.executeObjectIdsQuery(b)];case 9:return l=e.sent(),[4,this._reschedule()];case 10:return e.sent(),[4,l.executeTimeQuery(b)];case 11:return l=e.sent(),[4,this._reschedule()];case 12:return e.sent(),[4,l.executeAttributesQuery(b)];
case 13:return l=e.sent(),[3,15];case 14:c=e.sent();if(c!==w.QUERY_ENGINE_EMPTY_RESULT)throw c;l=new m.default([],null,this);return[3,15];case 15:return[2,l.createQueryResponse(b)]}})})};a.prototype.executeQueryForCount=function(a,l){void 0===a&&(a={});return b(this,void 0,void 0,function(){var b,l,c;return n(this,function(e){switch(e.label){case 0:b=k.clone(a),b.returnGeometry=!1,b.returnCentroid=!1,b.outSR=null,e.label=1;case 1:return e.trys.push([1,14,,15]),[4,this._schedule()];case 2:return e.sent(),
[4,w.normalizeQuery(b,this.definitionExpression,this.spatialReference)];case 3:return b=e.sent(),[4,this._reschedule()];case 4:return e.sent(),[4,this._checkQuerySupport(b)];case 5:return b=e.sent(),[4,this._reschedule()];case 6:return e.sent(),[4,this._executeGeometryQuery(b)];case 7:return l=e.sent(),[4,this._reschedule()];case 8:return e.sent(),[4,l.executeObjectIdsQuery(b)];case 9:return l=e.sent(),[4,this._reschedule()];case 10:return e.sent(),[4,l.executeTimeQuery(b)];case 11:return l=e.sent(),
[4,this._reschedule()];case 12:return e.sent(),[4,l.executeAttributesQuery(b)];case 13:return l=e.sent(),[2,l.size];case 14:c=e.sent();if(c!==w.QUERY_ENGINE_EMPTY_RESULT)throw c;return[2,0];case 15:return[2]}})})};a.prototype.executeQueryForExtent=function(a,l){void 0===a&&(a={});return b(this,void 0,void 0,function(){var b,l,c,e,h,f,p,m;return n(this,function(E){switch(E.label){case 0:b=k.clone(a),c=b.outSR,E.label=1;case 1:return E.trys.push([1,14,,15]),[4,this._schedule()];case 2:return E.sent(),
[4,w.normalizeQuery(b,this.definitionExpression,this.spatialReference)];case 3:return b=E.sent(),[4,this._reschedule()];case 4:return E.sent(),[4,this._checkQuerySupport(b)];case 5:return b=E.sent(),b.returnGeometry=!0,b.returnCentroid=!1,b.outSR=null,[4,this._reschedule()];case 6:return E.sent(),[4,this._executeGeometryQuery(b)];case 7:return l=E.sent(),[4,this._reschedule()];case 8:return E.sent(),[4,l.executeObjectIdsQuery(b)];case 9:return l=E.sent(),[4,this._reschedule()];case 10:return E.sent(),
[4,l.executeTimeQuery(b)];case 11:return l=E.sent(),[4,this._reschedule()];case 12:return E.sent(),[4,l.executeAttributesQuery(b)];case 13:l=E.sent();e=l.size;if(!e)return[2,{count:e,extent:null}];G.set(N,G.NEGATIVE_INFINITY);this.featureStore.forEachBounds(l.items,function(a){return G.expand(N,a)},F);h={xmin:N[0],ymin:N[1],xmax:N[3],ymax:N[4],spatialReference:w.cleanFromGeometryEngine(this.spatialReference)};this.hasZ&&isFinite(N[2])&&isFinite(N[5])&&(h.zmin=N[2],h.zmax=N[5]);f=q.project(h,l.spatialReference,
c);f.spatialReference=w.cleanFromGeometryEngine(c||this.spatialReference);0===f.xmax-f.xmin&&(p=t.getMetersPerUnitForSR(f.spatialReference),f.xmin-=p,f.xmax+=p);0===f.ymax-f.ymin&&(p=t.getMetersPerUnitForSR(f.spatialReference),f.ymin-=p,f.ymax+=p);this.hasZ&&null!=f.zmin&&null!=f.zmax&&0===f.zmax-f.zmin&&(p=t.getMetersPerUnitForSR(f.spatialReference),f.zmin-=p,f.zmax+=p);return[2,{count:e,extent:f}];case 14:m=E.sent();if(m===w.QUERY_ENGINE_EMPTY_RESULT)return[2,{count:0,extent:null}];throw m;case 15:return[2]}})})};
a.prototype.executeQueryForIds=function(a,l){void 0===a&&(a={});return b(this,void 0,void 0,function(){return n(this,function(b){return[2,this.executeQueryForIdSet(a,l).then(function(a){return f.valuesOfSet(a)})]})})};a.prototype.executeQueryForIdSet=function(a,l){void 0===a&&(a={});return b(this,void 0,void 0,function(){var b,l,c,e,f,h,p,q;return n(this,function(m){switch(m.label){case 0:b=k.clone(a),b.returnGeometry=!1,b.returnCentroid=!1,b.outSR=null,m.label=1;case 1:return m.trys.push([1,13,,
14]),[4,this._schedule()];case 2:return m.sent(),[4,w.normalizeQuery(b,this.definitionExpression,this.spatialReference)];case 3:return b=m.sent(),[4,this._reschedule()];case 4:return m.sent(),[4,this._executeGeometryQuery(b)];case 5:return l=m.sent(),[4,this._reschedule()];case 6:return m.sent(),[4,l.executeObjectIdsQuery(b)];case 7:return l=m.sent(),[4,this._reschedule()];case 8:return m.sent(),[4,l.executeTimeQuery(b)];case 9:return l=m.sent(),[4,this._reschedule()];case 10:return m.sent(),[4,l.executeAttributesQuery(b)];
case 11:return l=m.sent(),[4,this._reschedule()];case 12:m.sent();c=l.items;e=new Set;f=0;for(h=c;f<h.length;f++)p=h[f],e.add(l.featureAdapter.getObjectId(p));return[2,e];case 13:q=m.sent();if(q===w.QUERY_ENGINE_EMPTY_RESULT)return[2,new Set];throw q;case 14:return[2]}})})};a.prototype.executeQueryForLatestObservations=function(a,b){var l=this;if(this.timeInfo)return this.executeQuery(a,b).then(function(a){return l._filterLatest(a,l.timeInfo)});ia.error(new c("invalid-query","Unable to make time-based query as the underlying service does include TimeInfo"))};
a.prototype._schedule=function(a){return b(this,void 0,void 0,function(){return n(this,function(b){return this._frameQueue?[2,this._frameQueue.push(a).then(function(a){return a})]:[2,a]})})};a.prototype._reschedule=function(a){return b(this,void 0,void 0,function(){return n(this,function(b){return this._frameQueue?[2,this._frameQueue.unshift(a).then(function(a){return a})]:[2,a]})})};a.prototype._update=function(a){for(this._budget=a;!a.done&&this._frameQueue&&this._frameQueue.process();)a.madeProgress();
this._budget=null};a.prototype._filterLatest=function(a,b){var l=b.trackIdField,c=b.startTimeField;b=b.endTimeField||c;for(var c=new Map,e=[],f=0,h=a.features;f<h.length;f++){var m=h[f],p=m.attributes[l],q=m.attributes[b];(!c.has(p)||c.get(p).attributes[b]<q)&&c.set(p,m)}c.forEach(function(a){return e.push(a)});return u({},a,{features:e})};a.prototype._getAll=function(){if(!this._allItems){var a=[];this.featureStore.forEach(function(b){return a.push(b)});this._allItems=new m.default(a,null,this)}return this._allItems};
a.prototype._executeGeometryQuery=function(a){return b(this,void 0,void 0,function(){var l,c,e,f,h,q,k,F,E,r,w,H,N,t,v,K,V,Q,G,B,ma,aa,z,C,ia=this;return n(this,function(Z){switch(Z.label){case 0:l=a.geometry;c=a.outSR;e=a.spatialRel;f=A.isValid(c)&&!A.equals(this.spatialReference,c);if(h=this.cacheSpatialQueries?f?JSON.stringify({geometry:l,spatialRelationship:e,outSpatialReference:c}):JSON.stringify({geometry:l,spatialRelationship:e}):null)if(q=this._geometryQueryCache.get(h),void 0!==q)return[2,
q];k=function(l){return b(ia,void 0,void 0,function(){var b;return n(this,function(e){switch(e.label){case 0:return f&&(a.returnGeometry||a.returnCentroid)?[4,l.project(c)]:[3,2];case 1:return b=e.sent(),h&&this._geometryQueryCache.put(h,b,b.size||1),[2,b];case 2:return h&&this._geometryQueryCache.put(h,l,l.size||1),[2,l]}})})};if(!l)return[2,k(this._getAll())];F=this.featureAdapter;if("esriSpatialRelDisjoint"!==e)return[3,5];E=this._searchFeatures(this._getQueryBBoxes(l));if(!E.length)return[2,k(this._getAll())];
H=new Set;N=0;for(t=E;N<t.length;N++)v=t[N],H.add(F.getObjectId(v));return[4,this._reschedule(H)];case 1:return H=Z.sent(),K=0,r=Array(H.size),this.featureStore.forEach(function(a){return r[K++]=a}),w=H,[4,this._reschedule()];case 2:return Z.sent(),[4,p.getSpatialQueryOperator(e,l,this)];case 3:return V=Z.sent(),Q=function(a){return!w.has(F.getObjectId(a))||V(F.getGeometry(a))},B=m.default.bind,[4,this._runSpatialFilter(r,Q)];case 4:return G=new (B.apply(m.default,[void 0,Z.sent(),l,this])),[2,k(G)];
case 5:return ma=this._searchFeatures(this._getQueryBBoxes(l)),ma.length?(aa=this._canExecuteSoloPass(l,a))?[2,k(new m.default(ma,l,this))]:[4,p.getSpatialQueryOperator(e,l,this)]:(G=new m.default([],l,this),h&&this._geometryQueryCache.put(h,G,G.size||1),[2,G]);case 6:return z=Z.sent(),[4,this._runSpatialFilter(ma,function(a){return z(F.getGeometry(a))})];case 7:return C=Z.sent(),[2,k(new m.default(C,l,this))]}})})};a.prototype._runSpatialFilter=function(a,l){return b(this,void 0,void 0,function(){var c,
e,f,h=this;return n(this,function(m){if(!l)return[2,a];if(!this._budget)return[2,a.filter(function(a){return l(a)})];c=0;e=[];f=function(){return b(h,void 0,void 0,function(){var b;return n(this,function(h){switch(h.label){case 0:if(!(c<a.length))return[3,3];b=a[c];l(b)&&e.push(b);return this._budget.done?[4,this._reschedule()]:[3,2];case 1:return h.sent(),[2,f()];case 2:return++c,[3,0];case 3:return[2]}})})};return[2,this._reschedule().then(function(){return f()}).then(function(){return e})]})})};
a.prototype._canExecuteSoloPass=function(a,b){var l=this.geometryType;b=b.spatialRel;return p.canQueryWithRBush(a)&&("esriSpatialRelEnvelopeIntersects"===b||"esriGeometryPoint"===l&&("esriSpatialRelIntersects"===b||"esriSpatialRelContains"===b||"esriSpatialRelWithin"===b))};a.prototype._getQueryBBoxes=function(a){if(p.canQueryWithRBush(a)){if(I.isExtent(a))return[B.fromValues(a.xmin,a.ymin,a.xmax,a.ymax)];if(I.isPolygon(a))return a.rings.map(function(a){return B.fromValues(Math.min(a[0][0],a[2][0]),
Math.min(a[0][1],a[2][1]),Math.max(a[0][0],a[2][0]),Math.max(a[0][1],a[2][1]))})}return[C.getBoundsXY(B.create(),a)]};a.prototype._searchFeatures=function(a){for(var b=0;b<a.length;b++)this.featureStore.forEachInBounds(a[b],function(a){Q.add(a)});var l=Array(Q.size),c=0;Q.forEach(function(a){return l[c++]=a});Q.clear();return l};a.prototype._checkQuerySupport=function(a){return b(this,void 0,void 0,function(){return n(this,function(b){if(0>a.distance||null!=a.geometryPrecision||a.multipatchOption||
a.pixelSize||a.relationParam||a.text)throw new c("feature-store:unsupported-query","Unsupported query options",{query:a});return[2,z.all([this._checkAttributesQuerySupport(a),this._checkStatisticsQuerySupport(a),p.checkSpatialQuerySupport(a,this.geometryType,this.spatialReference),q.checkProjectionSupport(this.spatialReference,a.outSR)]).then(function(){return a})]})})};a.prototype._checkAttributesQuerySupport=function(a){var b=a.outFields,l=a.orderByFields,f=a.returnDistinctValues;l&&0<l.length&&
(l=l.map(function(a){return-1<a.indexOf(" ASC")?a.split(" ASC")[0]:-1<a.indexOf(" DESC")?a.split(" DESC")[0]:a}),e.validateFields(this.fieldsIndex,l,"orderByFields contains missing fields"));if(b&&0<b.length)e.validateFields(this.fieldsIndex,b,"outFields contains missing fields");else if(f)throw new c("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:a});e.validateWhere(this.fieldsIndex,a.where)};a.prototype._checkStatisticsQuerySupport=function(a){return b(this,
void 0,void 0,function(){var b,l,f,h,m,q,p,k,F,E,r,w;return n(this,function(A){b=a.outStatistics;l=a.groupByFieldsForStatistics;f=a.having;h=l&&l.length;m=b&&b.length;if(f){if(!h||!m)throw new c("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:a});e.validateHaving(this.fieldsIndex,f,b)}if(m){if(q=b.some(function(a){return"exceedslimit"===a.statisticType}))return[2];p=b.map(function(a){return a.onStatisticField});e.validateFields(this.fieldsIndex,
p,"onStatisticFields contains missing fields");h&&e.validateFields(this.fieldsIndex,l,"groupByFieldsForStatistics contains missing fields");k=0;for(F=b;k<F.length;k++)if(E=F[k],r=E.onStatisticField,w=E.statisticType,(!h||"count"!==w)&&r&&e.hasInvalidFieldType(r,this.fieldsIndex))throw new c("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:E,query:a});}return[2]})})};return a}();a.default=D;var F=G.create(),N=G.create()})},"esri/layers/graphics/data/attributeSupport":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/Error ../../../core/iteratorUtils ../../../core/sql/WhereClauseCache".split(" "),
function(D,a,u,n,b,c){function f(a,b){return a?v.get(a,b):null}function k(a,b,c,v){void 0===v&&(v=!0);for(var t=[],A=0;A<b.length;A++){var e=b[A];if("*"!==e&&!a.has(e))if(v){var q=r(e);try{var h=f(q,a);if(!h)throw new n("feature-store:unsupported-query","invalid SQL expression",{where:q});if(!h.isStandardized)throw new n("feature-store:unsupported-query","expression is not standard",{clause:h});k(a,h.fieldNames,"expression contains missing fields")}catch(m){if((q=m&&m.details)&&(q.clause||q.where))throw m;
q&&q.missingFields?t.push.apply(t,q.missingFields):t.push(e)}}else t.push(e)}if(t.length)throw new n("feature-store:unsupported-query",c,{missingFields:t});}function r(a){return a.split(" as ")[0]}Object.defineProperty(a,"__esModule",{value:!0});var v=new c.WhereClauseCache(50,500),z=b.createSetFromValues("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeDate".split(" "));a.validateWhere=function(a,b){if(!b)return!0;
var c=v.get(b,a);if(!c)throw new n("feature-store:unsupported-query","invalid SQL expression",{where:b});if(!c.isStandardized)throw new n("feature-store:unsupported-query","where clause is not standard",{where:b});k(a,c.fieldNames,"where clause contains missing fields");return!0};a.validateHaving=function(a,b,c){if(!b)return!0;var f=v.get(b,a);if(!f)throw new n("feature-store:unsupported-query","invalid SQL expression",{having:b});if(!f.isAggregate)throw new n("feature-store:unsupported-query","having does not contain a valid aggregate function",
{having:b});k(a,f.fieldNames,"having contains missing fields");if(!f.getExpressions().every(function(b){var f=b.aggregateType;b=b.field;var e=a.has(b)&&a.get(b).name;return c.some(function(b){var c=b.onStatisticField;b=b.statisticType;return(a.has(c)&&a.get(c).name)===e&&b.toLowerCase().trim()===f})}))throw new n("feature-store:unsupported-query","expressions in having should also exist in outStatistics",{having:b});return!0};a.getWhereClause=f;a.validateFields=k;a.getExpressionFromFieldName=r;a.getAliasFromFieldName=
function(a){return a.split(" as ")[1]};a.hasInvalidFieldType=function(a,b){return(a=b.get(a))?!z.has(a.type):!1}})},"esri/core/sql/WhereClauseCache":function(){define(["require","exports","../ItemCache","./WhereClause"],function(D,a,u,n){Object.defineProperty(a,"__esModule",{value:!0});D=function(){function a(a,b){this._cache=new u(a);this._invalidCache=new u(b)}a.prototype.get=function(a,b){var c=b.uid+":"+a,f=this._cache.get(c);if(f)return f;if(void 0!==this._invalidCache.get(c))return null;try{var v=
n.WhereClause.create(a,b);this._cache.put(c,v);return v}catch(z){return this._invalidCache.put(c,null),null}};return a}();a.WhereClauseCache=D})},"esri/core/ItemCache":function(){define(["require","exports","./MemCache"],function(D,a,u){return function(){function a(a,c){this._storage=new u.MemCacheStorage;this._storage.maxSize=a;c&&this._storage.registerRemoveFunc("",c)}a.prototype.put=function(a,c){this._storage.put(a,c,1,1)};a.prototype.pop=function(a){return this._storage.pop(a)};a.prototype.get=
function(a){return this._storage.get(a)};a.prototype.clear=function(){this._storage.clearAll()};a.prototype.destroy=function(){this._storage.clearAll()};return a}()})},"esri/core/sql/WhereClause":function(){define("require exports ../has ../iteratorUtils ./AggregateFunctions ./StandardizedFunctions ./WhereGrammar".split(" "),function(D,a,u,n,b,c,f){function k(a,b){a+="";return a.length>=b?a:Array(b-a.length+1).join("0")+a}function r(a,b,c,e,f,h,m,p,q){void 0===c&&(c="0");void 0===e&&(e="0");void 0===
f&&(f="0");void 0===h&&(h="0");void 0===m&&(m="");void 0===p&&(p="0");void 0===q&&(q="0");return"+"===m||"-"===m?(a=k(parseInt(a,10),4)+"-"+k(parseInt(b,10),2)+"-"+k(parseInt(c,10),2),b="",10>parseFloat(h)&&(b="0"),e=k(parseInt(e,10),2)+":"+k(parseInt(f,10),2)+":"+(b+parseFloat(h).toString()),m=""+m+k(parseInt(p,10),2)+":"+k(parseInt(q,10),2),new Date(a+"T"+e+m)):new Date(parseInt(a,10),parseInt(b,10),parseInt(c,10),parseInt(e,10),parseInt(f,10),parseFloat(h))}function v(a){var b=w.exec(a);if(null!==
b){a=b[1];var c=b[2],e=b[3],f=b[4],h=b[5],m=b[6];return r(a,c,e,f,h,m)}b=K.exec(a);if(null!==b){a=b[1];var c=b[2],e=b[3],f=b[4],h=b[5],m=b[6],p=b[7],q=b[8],b=b[9];return r(a,c,e,f,h,m,p,q,b)}b=aa.exec(a);if(null!==b)return a=b[1],c=b[2],e=b[3],f=b[4],h=b[5],p=b[6],q=b[7],b=b[8],r(a,c,e,f,h,"0",p,q,b);b=ia.exec(a);if(null!==b)return a=b[1],c=b[2],e=b[3],f=b[4],h=b[5],r(a,c,e,f,h);b=E.exec(a);if(null!==b)return a=b[1],c=b[2],e=b[3],r(a,c,e);throw Error("SQL Invalid Timestamp");}function z(a){a=E.exec(a);
if(null===a)throw Error("SQL Invalid Date");var b=a[2],c=a[3];return new Date(parseInt(a[1],10),parseInt(b,10)-1,parseInt(c,10))}function t(a){return Array.isArray(a)?a:[a]}function G(a){return null!==a?!0!==a:null}function B(a,b){return null!=a&&null!=b?!0===a&&!0===b:!1===a||!1===b?!1:null}function C(a,b){return null!=a&&null!=b?!0===a||!0===b:!0===a||!0===b?!0:null}function I(a,b){if(null==a)return null;for(var l=!1,c=0;c<b.length;c++){var e=b[c];if(null==e)l=null;else if(a===e){l=!0;break}}return l}
function A(a,b,c){if(null==a)return null;for(var l="",e=0,f=0;f<b.length;f++){var h=b.charAt(f);switch(e){case 0:h===c?e=1:l=0<="-[]/{}()*+?.\\^$|".indexOf(h)?l+("\\"+h):"%"===h?l+".*":"_"===h?l+".":l+h;break;case 1:l=0<="-[]/{}()*+?.\\^$|".indexOf(h)?l+("\\"+h):l+h,e=0}}return(new RegExp("^"+l+"$")).test(a)}function e(a){return a instanceof Date?a.valueOf():a}function q(a,b,c){if(null==b||null==c)return null;b=e(b);c=e(c);switch(a){case "\x3c\x3e":return b!==c;case "\x3d":return b===c;case "\x3e":return b>
c;case "\x3c":return b<c;case "\x3e\x3d":return b>=c;case "\x3c\x3d":return b<=c}}function h(a){for(var b=[],c={},e=0;e<a.length;e++){var f=a[e],h=f.toLowerCase();void 0===c[h]&&(b.push(f),c[h]=1)}return b}function m(a,b,e){if(b instanceof c.SqlInterval)if(e instanceof Date)switch(a){case "+":return new Date(b.valueInMilliseconds()+e.getTime());case "-":return b.valueInMilliseconds()-e.getTime();case "*":return b.valueInMilliseconds()*e.getTime();case "/":return b.valueInMilliseconds()/e.getTime()}else if(e instanceof
c.SqlInterval)switch(a){case "+":return c.SqlInterval.createFromMilliseconds(b.valueInMilliseconds()+e.valueInMilliseconds());case "-":return c.SqlInterval.createFromMilliseconds(b.valueInMilliseconds()-e.valueInMilliseconds());case "*":return b.valueInMilliseconds()*e.valueInMilliseconds();case "/":return b.valueInMilliseconds()/e.valueInMilliseconds()}else b=b.valueInMilliseconds();else if(e instanceof c.SqlInterval)if(b instanceof Date)switch(a){case "+":return new Date(e.valueInMilliseconds()+
b.getTime());case "-":return new Date(b.getTime()-e.valueInMilliseconds());case "*":return b.getTime()*e.valueInMilliseconds();case "/":return b.getTime()/e.valueInMilliseconds()}else e=e.valueInMilliseconds();else if(b instanceof Date&&"number"===typeof e)switch(e*=864E5,b=b.getTime(),a){case "+":return new Date(b+e);case "-":return new Date(b-e);case "*":return new Date(b*e);case "/":return new Date(b/e)}else if(e instanceof Date&&"number"===typeof b)switch(b*=864E5,e=e.getTime(),a){case "+":return new Date(b+
e);case "-":return new Date(b-e);case "*":return new Date(b*e);case "/":return new Date(b/e)}switch(a){case "+":return b+e;case "-":return b-e;case "*":return b*e;case "/":return b/e}}function p(a,b,e,c){a=c.getAttribute(a,b);return null!=a&&1===e[b]?new Date(a):a}Object.defineProperty(a,"__esModule",{value:!0});var E=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,w=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,K=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,
aa=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,ia=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,Q=function(){function a(){}a.makeBool=function(a){return!0===a};a.featureValue=function(a,b,e,c){return p(a,b,e,c)};a.equalsNull=function(a){return null===a};a.applyLike=function(a,b,e){return A(a,b,e)};a.ensureArray=function(a){return t(a)};a.applyIn=function(a,b){return I(a,b)};a.currentDate=function(){var a=new Date;a.setHours(0,0,0,0);return a};a.makeSqlInterval=
function(a,b,e){return c.SqlInterval.createFromValueAndQualifer(a,b,e)};a.convertInterval=function(a){return a instanceof c.SqlInterval?a.valueInMilliseconds():a};a.currentTimestamp=function(){return new Date};a.compare=function(a,b,e){return q(a,b,e)};a.calculate=function(a,b,e){return m(a,b,e)};a.makeComparable=function(a){return e(a)};a.evaluateFunction=function(a,b){return c.evaluateFunction(a,b)};a.lookup=function(a,b){a=b[a];return void 0===a?null:a};a.between=function(a,b){return null==a||
null==b[0]||null==b[1]?null:a>=b[0]&&a<=b[1]};a.notbetween=function(a,b){return null==a||null==b[0]||null==b[1]?null:a<b[0]||a>b[1]};a.ternaryNot=function(a){return G(a)};a.ternaryAnd=function(a,b){return B(a,b)};a.ternaryOr=function(a,b){return C(a,b)};return a}();D=function(){function k(a,b){this.fieldsIndex=b;this.datefields={};this.parameters={};this.parseTree=f.WhereGrammar.parse(a);a=this.extractExpressionInfo(b);b=a.isStandardized;var e=a.isAggregate;this.referencedFieldNames=a.referencedFieldNames;
this.isStandardized=b;this.isAggregate=e}k.create=function(a,b){return new k(a,b)};Object.defineProperty(k.prototype,"fieldNames",{get:function(){return this.referencedFieldNames},enumerable:!0,configurable:!0});k.prototype.testSet=function(b,e){void 0===e&&(e=a.defaultAttributeAdapter);for(var c={},l=function(a){c[a]=b.map(function(b){return e.getAttribute(b,a)})},f=0,h=this.fieldNames;f<h.length;f++)l(h[f]);return!!this.evaluateNode(this.parseTree,{attributes:c},a.defaultAttributeAdapter)};k.prototype.calculateValue=
function(b,e){void 0===e&&(e=a.defaultAttributeAdapter);b=this.evaluateNode(this.parseTree,b,e);return b instanceof c.SqlInterval?b.valueInMilliseconds()/864E5:b};k.prototype.calculateValueCompiled=function(b,e){void 0===e&&(e=a.defaultAttributeAdapter);if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(b,this.parameters,e,this.datefields);if(u("csp-restrictions"))return this.calculateValue(b,e);this.compileMe();return this.parseTree._compiledVersion(b,this.parameters,
e,this.datefields)};k.prototype.testFeature=function(b,e){void 0===e&&(e=a.defaultAttributeAdapter);return!!this.evaluateNode(this.parseTree,b,e)};k.prototype.testFeatureCompiled=function(b,e){void 0===e&&(e=a.defaultAttributeAdapter);if(void 0===this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(b,this.parameters,e,this.datefields);if(u("csp-restrictions"))return this.testFeature(b,e);this.compileMe();return!!this.parseTree._compiledVersion(b,this.parameters,e,this.datefields)};
k.prototype.getFunctions=function(){var a=[];this.visitAll(this.parseTree,function(b){"function"===b.type&&a.push(b.name.toLowerCase())});return h(a)};k.prototype.getExpressions=function(){var a=new Map;this.visitAll(this.parseTree,function(b){if("function"===b.type){var e=b.name.toLowerCase();b=b.args.value[0];if("column_ref"===b.type){b=b.column;var c=e+"-"+b;a.has(c)||a.set(c,{aggregateType:e,field:b})}}});return n.valuesOfMap(a)};k.prototype.getVariables=function(){var a=[];this.visitAll(this.parseTree,
function(b){"param"===b.type&&a.push(b.value.toLowerCase())});return h(a)};k.prototype.compileMe=function(){var a="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter","datefields",a)).bind(Q)};k.prototype.extractExpressionInfo=function(a){var e=this,l=[],f=!0,m=!0;this.visitAll(this.parseTree,function(h){switch(h.type){case "column_ref":var p=h.column.toUpperCase();if("CURRENT_DATE"!==
p&&"CURRENT_TIMESTAMP"!==p){var q=(p=a.get(h.column))&&p.name;!p||"date"!==p.type&&"esriFieldTypeDate"!==p.type||(e.datefields[p.name]=1);void 0!==q?(l.push(q),h.column=q):l.push(h.column)}break;case "function":p=h.name,h=h.args.value.length,f&&(f=c.isStandardized(p,h)),m&&(m=b.isAggregate(p,h))}});return{referencedFieldNames:h(l),isStandardized:f,isAggregate:m}};k.prototype.visitAll=function(a,b){if(null!=a)switch(b(a),a.type){case "when_clause":this.visitAll(a.operand,b);this.visitAll(a.value,b);
break;case "case_expression":for(var e=0,c=a.clauses;e<c.length;e++){var l=c[e];this.visitAll(l,b)}"simple"===a.format&&this.visitAll(a.operand,b);null!==a.else&&this.visitAll(a.else,b);break;case "expr_list":e=0;for(a=a.value;e<a.length;e++)l=a[e],this.visitAll(l,b);break;case "unary_expr":this.visitAll(a.expr,b);break;case "binary_expr":this.visitAll(a.left,b);this.visitAll(a.right,b);break;case "function":this.visitAll(a.args,b)}};k.prototype.evaluateNodeToJavaScript=function(a){switch(a.type){case "interval":return"this.makeSqlInterval("+
this.evaluateNodeToJavaScript(a.value)+", "+JSON.stringify(a.qualifier)+","+JSON.stringify(a.op)+")";case "case_expression":var b="";if("simple"===a.format)for(var e="this.makeComparable("+this.evaluateNodeToJavaScript(a.operand)+")",b="( ",c=0;c<a.clauses.length;c++)b+=" ("+e+" \x3d\x3d\x3d this.makeComparable("+this.evaluateNodeToJavaScript(a.clauses[c].operand)+")) ? ("+this.evaluateNodeToJavaScript(a.clauses[c].value)+") : ";else for(b="( ",c=0;c<a.clauses.length;c++)b+=" this.makeBool("+this.evaluateNodeToJavaScript(a.clauses[c].operand)+
")\x3d\x3d\x3dtrue ? ("+this.evaluateNodeToJavaScript(a.clauses[c].value)+") : ";b=null!==a.else?b+this.evaluateNodeToJavaScript(a.else):b+"null";return b+" )";case "param":return"this.lookup("+JSON.stringify(a.value.toLowerCase())+",lookups)";case "expr_list":b="[";e=0;for(a=a.value;e<a.length;e++)c=a[e],"["!==b&&(b+=","),b+=this.evaluateNodeToJavaScript(c);return b+"]";case "unary_expr":return"this.ternaryNot("+this.evaluateNodeToJavaScript(a.expr)+")";case "binary_expr":switch(a.operator){case "AND":return"this.ternaryAnd("+
this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")";case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")))";case "IN":return"this.applyIn("+
this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+
")";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+
this.evaluateNodeToJavaScript(a.right)+")";case "*":case "-":case "+":case "/":return"this.calculate("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")"}throw Error("Not Supported Operator "+a.operator);case "null":case "bool":case "string":case "number":return JSON.stringify(a.value);case "date":return"(new Date("+z(a.value).getTime().toString()+"))";case "timestamp":return"(new Date("+v(a.value).getTime().toString()+"))";case "column_ref":return"CURRENT_DATE"===
a.column.toUpperCase()?"this.currentDate()":"CURRENT_TIMESTAMP"===a.column.toUpperCase()?"this.currentTimestamp()":"this.featureValue(feature,"+JSON.stringify(a.column)+",datefields,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(a.name)+","+this.evaluateNodeToJavaScript(a.args)+")"}throw Error("Unsupported sql syntax "+a.type);};k.prototype.evaluateNode=function(a,h,f){switch(a.type){case "interval":return h=this.evaluateNode(a.value,h,f),c.SqlInterval.createFromValueAndQualifer(h,
a.qualifier,a.op);case "case_expression":if("simple"===a.format)for(var l=e(this.evaluateNode(a.operand,h,f)),k=0;k<a.clauses.length;k++){if(l===e(this.evaluateNode(a.clauses[k].operand,h,f)))return this.evaluateNode(a.clauses[k].value,h,f)}else for(k=0;k<a.clauses.length;k++)if(!0===this.evaluateNode(a.clauses[k].operand,h,f))return this.evaluateNode(a.clauses[k].value,h,f);return null!==a.else?this.evaluateNode(a.else,h,f):null;case "param":return this.parameters[a.value.toLowerCase()];case "expr_list":l=
[];k=0;for(a=a.value;k<a.length;k++){var E=a[k];l.push(this.evaluateNode(E,h,f))}return l;case "unary_expr":return G(this.evaluateNode(a.expr,h,f));case "binary_expr":switch(a.operator){case "AND":return B(this.evaluateNode(a.left,h,f),this.evaluateNode(a.right,h,f));case "OR":return C(this.evaluateNode(a.left,h,f),this.evaluateNode(a.right,h,f));case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return null===this.evaluateNode(a.left,h,f);case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");
return null!==this.evaluateNode(a.left,h,f);case "IN":return l=t(this.evaluateNode(a.right,h,f)),I(this.evaluateNode(a.left,h,f),l);case "NOT IN":return l=t(this.evaluateNode(a.right,h,f)),G(I(this.evaluateNode(a.left,h,f),l));case "BETWEEN":return l=this.evaluateNode(a.left,h,f),a=this.evaluateNode(a.right,h,f),null==l||null==a[0]||null==a[1]?null:l>=e(a[0])&&l<=e(a[1]);case "NOTBETWEEN":return l=this.evaluateNode(a.left,h,f),a=this.evaluateNode(a.right,h,f),null==l||null==a[0]||null==a[1]?null:
l<e(a[0])||l>e(a[1]);case "LIKE":return A(this.evaluateNode(a.left,h,f),this.evaluateNode(a.right,h,f),a.escape);case "NOT LIKE":return G(A(this.evaluateNode(a.left,h,f),this.evaluateNode(a.right,h,f),a.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return q(a.operator,this.evaluateNode(a.left,h,f),this.evaluateNode(a.right,h,f));case "-":case "+":case "*":case "/":return m(a.operator,this.evaluateNode(a.left,h,f),this.evaluateNode(a.right,h,f))}throw Error("Not Supported Operator "+
a.operator);case "null":case "bool":case "string":case "number":return a.value;case "date":return z(a.value);case "timestamp":return v(a.value);case "column_ref":return"CURRENT_DATE"===a.column.toUpperCase()?(E=new Date,E.setHours(0,0,0,0),E):"CURRENT_TIMESTAMP"===a.column.toUpperCase()?new Date:p(h,a.column,this.datefields,f);case "function":return h=this.evaluateNode(a.args,h,f),this.isAggregate?b.aggregateFunction(a.name,h):c.evaluateFunction(a.name,h)}throw Error("Unsupported sql syntax "+a.type);
};return k}();a.WhereClause=D;a.defaultAttributeAdapter={getAttribute:function(a,b){return(a&&"object"===typeof a.attributes?a.attributes:a)[b]}}})},"esri/core/sql/AggregateFunctions":function(){define(["require","exports"],function(D,a){function u(a){for(var b=0,c=0;c<a.length;c++)b+=a[c];return b/a.length}function n(a){for(var b=u(a),c=a.length,r=0,n=0;n<a.length;n++)r+=Math.pow(a[n]-b,2);return 1<c?r/(c-1):0}Object.defineProperty(a,"__esModule",{value:!0});a.aggregateFunction=function(a,f){var c=
b[a.toLowerCase()];if(null==c)throw Error("Function Not Recognised");if(f.length<c.minParams||f.length>c.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return c.evaluate(f)};a.isAggregate=function(a,f){a=b[a.toLowerCase()];return null!=a&&f>=a.minParams&&f<=a.maxParams};var b={min:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.min.apply(Math,a[0])}},max:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.max.apply(Math,
a[0])}},avg:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:u(a[0])}},sum:{minParams:1,maxParams:1,evaluate:function(a){if(null==a[0])a=null;else{a=a[0];for(var b=0,c=0;c<a.length;c++)b+=a[c];a=b}return a}},stddev:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sqrt(n(a[0]))}},count:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].length}},var:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:n(a[0])}}}})},
"esri/core/sql/StandardizedFunctions":function(){define(["require","exports","../string"],function(D,a,u){Object.defineProperty(a,"__esModule",{value:!0});D=function(){function a(){this.op="+";this.minute=this.year=this.month=this.hour=this.second=this.day=0}a.fixDefaults=function(a){if(null!==a.precision||null!==a.secondary)throw Error("Primary and Secondary SqlInterval qualifiers not supported");};a.createFromMilliseconds=function(b){var c=new a;c.second=b/1E3;return c};a.createFromValueAndQualifer=
function(b,f,k){var c=null,n=new a;n.op="-"===k?"-":"+";if("interval-period"===f.type){a.fixDefaults(f);if("year"===f.period||"month"===f.period)throw Error("Year-Month Intervals not supported");if(/^[0-9]{1,}$/.test(b))n[f.period]=parseFloat(b);else throw Error("Illegal Interval");}else{a.fixDefaults(f.start);a.fixDefaults(f.end);if("year"===f.start.period||"month"===f.start.period)throw Error("Year-Month Intervals not supported");if("year"===f.end.period||"month"===f.end.period)throw Error("Year-Month Intervals not supported");
switch(f.start.period){case "day":switch(f.end.period){case "hour":c=/^[0-9]{1,} [0-9]{1,}$/;if(c.test(b))n[f.start.period]=parseFloat(b.split(" ")[0]),n[f.end.period]=parseFloat(b.split(" ")[1]);else throw Error("Illegal Interval");break;case "minute":c=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$/;if(c.test(b))n[f.start.period]=parseFloat(b.split(" ")[0]),b=b.split(" ")[1].split(":"),n.hour=parseFloat(b[0]),n.minute=parseFloat(b[1]);else throw Error("Illegal Interval");break;case "second":c=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;
if(c.test(b))n[f.start.period]=parseFloat(b.split(" ")[0]),b=b.split(" ")[1].split(":"),n.hour=parseFloat(b[0]),n.minute=parseFloat(b[1]),n.second=parseFloat(b[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "hour":switch(f.end.period){case "minute":c=/^[0-9]{1,}:[0-9]{1,}$/;if(c.test(b))n.hour=parseFloat(b.split(":")[0]),n.minute=parseFloat(b.split(":")[1]);else throw Error("Illegal Interval");break;case "second":c=/^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;
if(c.test(b))b=b.split(":"),n.hour=parseFloat(b[0]),n.minute=parseFloat(b[1]),n.second=parseFloat(b[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "minute":switch(f.end.period){case "second":c=/^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(c.test(b))b=b.split(":"),n.minute=parseFloat(b[0]),n.second=parseFloat(b[1]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;default:throw"Invalid Interval.";}}return n};a.prototype.valueInMilliseconds=
function(){return("-"===this.op?-1:1)*(1E3*this.second+6E4*this.minute+36E5*this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)};return a}();a.SqlInterval=D;a.evaluateFunction=function(a,c){var b=n[a.toLowerCase()];if(null==b)throw Error("Function Not Recognised");if(c.length<b.minParams||c.length>b.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return b.evaluate(c)};a.isStandardized=function(a,c){a=n[a.toLowerCase()];return null!=a&&c>=a.minParams&&
c<=a.maxParams};var n={extract:{minParams:2,maxParams:2,evaluate:function(a){var b=a[0];a=a[1];if(null==a)return null;if(a instanceof Date)switch(b.toUpperCase()){case "SECOND":return a.getSeconds();case "MINUTE":return a.getMinutes();case "HOUR":return a.getHours();case "DAY":return a.getDate();case "MONTH":return a.getMonth()+1;case "YEAR":return a.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,maxParams:3,evaluate:function(a){if(2===a.length){var b=
a[0],f=a[1];return null==b||null==f?null:b.toString().substring(f-1)}if(3===a.length)return b=a[0],f=a[1],a=a[2],null==b||null==f||null==a?null:0>=a?"":b.toString().substring(f-1,f+a-1)}},position:{minParams:2,maxParams:2,evaluate:function(a){var b=a[0];a=a[1];return null==b||null==a?null:a.indexOf(b)+1}},trim:{minParams:2,maxParams:3,evaluate:function(a){var b=3===a.length,f=b?a[1]:" ",b=b?a[2]:a[1];if(null==f||null==b)return null;f="("+u.escapeRegExpString(f)+")";switch(a[0]){case "BOTH":return b.replace(new RegExp("^"+
f+"*|"+f+"*$","g"),"");case "LEADING":return b.replace(new RegExp("^"+f+"*","g"),"");case "TRAILING":return b.replace(new RegExp(f+"*$","g"),"")}throw Error("Invalid Parameter for call to TRIM");}},abs:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.abs(a[0])}},ceiling:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.ceil(a[0])}},floor:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.floor(a[0])}},log:{minParams:1,maxParams:1,
evaluate:function(a){return null==a[0]?null:Math.log(a[0])}},log10:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.log(a[0])*Math.LOG10E}},sin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sin(a[0])}},cos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.cos(a[0])}},tan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.tan(a[0])}},asin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?
null:Math.asin(a[0])}},acos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.acos(a[0])}},atan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.atan(a[0])}},sign:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:0<a[0]?1:0>a[1]?-1:0}},power:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:Math.pow(a[0],a[1])}},mod:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:a[0]%
a[1]}},round:{minParams:1,maxParams:2,evaluate:function(a){var b=a[0];a=2===a.length?Math.pow(10,a[1]):1;return null==b?null:Math.round(b*a)/a}},truncate:{minParams:1,maxParams:2,evaluate:function(a){return null==a[0]?null:1===a.length?parseInt(a[0].toFixed(0),10):parseFloat(a[0].toFixed(a[1]))}},char_length:{minParams:1,maxParams:1,evaluate:function(a){return"string"===typeof a[0]||a[0]instanceof String?a[0].length:0}},concat:{minParams:1,maxParams:Infinity,evaluate:function(a){for(var b="",f=0;f<
a.length;f++){if(null==a[f])return null;b+=a[f].toString()}return b}},lower:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toLowerCase()}},upper:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toUpperCase()}}}})},"esri/core/sql/WhereGrammar":function(){define(["require","exports","./sql92grammar"],function(D,a,u){Object.defineProperty(a,"__esModule",{value:!0});D=function(){function a(){}a.parse=function(a){return u.parse(a)};
return a}();a.WhereGrammar=D})},"esri/core/sql/sql92grammar":function(){define([],function(){function D(a,u,n,b){this.message=a;this.expected=u;this.found=n;this.location=b;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,D)}(function(a,u){function n(){this.constructor=a}n.prototype=u.prototype;a.prototype=new n})(D,Error);D.buildMessage=function(a,u){function n(a){return a.charCodeAt(0).toString(16).toUpperCase()}function b(a){return a.replace(/\\/g,
"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+n(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+n(a)})}function c(a){return a.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+n(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,
function(a){return"\\x"+n(a)})}var f={literal:function(a){return'"'+b(a.text)+'"'},"class":function(a){var b="",f;for(f=0;f<a.parts.length;f++)b+=a.parts[f]instanceof Array?c(a.parts[f][0])+"-"+c(a.parts[f][1]):c(a.parts[f]);return"["+(a.inverted?"^":"")+b+"]"},any:function(a){return"any character"},end:function(a){return"end of input"},other:function(a){return a.description}};return"Expected "+function(a){var b=Array(a.length),c;for(c=0;c<a.length;c++){var k=c,n;n=a[c];n=f[n.type](n);b[k]=n}b.sort();
if(0<b.length){for(a=c=1;c<b.length;c++)b[c-1]!==b[c]&&(b[a]=b[c],a++);b.length=a}switch(b.length){case 1:return b[0];case 2:return b[0]+" or "+b[1];default:return b.slice(0,-1).join(", ")+", or "+b[b.length-1]}}(a)+" but "+(u?'"'+b(u)+'"':"end of input")+" found."};return{SyntaxError:D,parse:function(a,u){function n(a,d){return{type:"literal",text:a,ignoreCase:d}}function b(a,d,b){return{type:"class",parts:a,inverted:d,ignoreCase:b}}function c(d){var b=Ga[d],g;if(!b){for(g=d-1;!Ga[g];)g--;b=Ga[g];
for(b={line:b.line,column:b.column};g<d;)10===a.charCodeAt(g)?(b.line++,b.column=1):b.column++,g++;Ga[d]=b}return b}function f(a,d){var b=c(a),g=c(d);return{start:{offset:a,line:b.line,column:b.column},end:{offset:d,line:g.line,column:g.column}}}function k(a){g<ka||(g>ka&&(ka=g,Qa=[]),Qa.push(a))}function r(){var a,b,e;a=g;b=y();b!==d?(b=z(),b!==d?(e=y(),e!==d?a=b:(g=a,a=d)):(g=a,a=d)):(g=a,a=d);return a}function v(){var a,b,e,c,h,f,m,p;a=g;b=z();if(b!==d){e=[];c=g;h=y();h!==d?(f=Aa(),f!==d?(m=y(),
m!==d?(p=z(),p!==d?c=h=[h,f,m,p]:(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d);for(;c!==d;)e.push(c),c=g,h=y(),h!==d?(f=Aa(),f!==d?(m=y(),m!==d?(p=z(),p!==d?c=h=[h,f,m,p]:(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d);if(e!==d){a={type:"expr_list"};b=[b];for(c=0;c<e.length;c++)b.push(e[c][3]);a.value=b}else g=a,a=d}else g=a,a=d;return a}function z(){var a,b,e,c,h,f,m,p;a=g;b=t();if(b!==d){e=[];c=g;h=y();h!==d?(f=la(),f!==d?(m=y(),m!==d?(p=t(),p!==d?c=h=[h,f,m,p]:(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d);
for(;c!==d;)e.push(c),c=g,h=y(),h!==d?(f=la(),f!==d?(m=y(),m!==d?(p=t(),p!==d?c=h=[h,f,m,p]:(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d);e!==d?a=b=Ba(b,e):(g=a,a=d)}else g=a,a=d;return a}function t(){var a,b,e,c,h,f,m,p;a=g;b=G();if(b!==d){e=[];c=g;h=y();h!==d?(f=da(),f!==d?(m=y(),m!==d?(p=G(),p!==d?c=h=[h,f,m,p]:(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d);for(;c!==d;)e.push(c),c=g,h=y(),h!==d?(f=da(),f!==d?(m=y(),m!==d?(p=G(),p!==d?c=h=[h,f,m,p]:(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d);e!==d?a=b=
Ba(b,e):(g=a,a=d)}else g=a,a=d;return a}function G(){var b,e,c,h,f;b=g;e=ha();e===d&&(e=g,33===a.charCodeAt(g)?(c=$c,g++):(c=d,0===x&&k(ad)),c!==d?(h=g,x++,61===a.charCodeAt(g)?(f=cb,g++):(f=d,0===x&&k(db)),x--,f===d?h=void 0:(g=h,h=d),h!==d?e=c=[c,h]:(g=e,e=d)):(g=e,e=d));e!==d?(c=y(),c!==d?(h=G(),h!==d?b=e={type:"unary_expr",operator:"NOT",expr:h}:(g=b,b=d)):(g=b,b=d)):(g=b,b=d);if(b===d)if(b=g,e=A(),e!==d)if(c=y(),c!==d){var m,p,l;c=[];h=g;f=y();f!==d?(m=B(),m!==d?(p=y(),p!==d?(l=A(),l!==d?h=f=
[f,m,p,l]:(g=h,h=d)):(g=h,h=d)):(g=h,h=d)):(g=h,h=d);if(h!==d)for(;h!==d;)c.push(h),h=g,f=y(),f!==d?(m=B(),m!==d?(p=y(),p!==d?(l=A(),l!==d?h=f=[f,m,p,l]:(g=h,h=d)):(g=h,h=d)):(g=h,h=d)):(g=h,h=d);else c=d;c!==d&&(c={type:"arithmetic",tail:c});c===d&&(c=g,h=I(),h!==d?(f=y(),f!==d?(f=ea(),f!==d?(f=y(),f!==d?(f=v(),f!==d?(m=y(),m!==d?(m=fa(),m!==d?c=h={op:h,right:f}:(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d),c===d&&(c=g,h=I(),h!==d?(f=y(),f!==d?(f=ea(),f!==d?(f=y(),f!==
d?(f=fa(),f!==d?c=h={op:h,right:{type:"expr_list",value:[]}}:(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d),c===d&&(c=g,h=I(),h!==d?(f=y(),f!==d?(f=aa(),f!==d?c=h={op:h,right:f}:(g=c,c=d)):(g=c,c=d)):(g=c,c=d))),c===d&&(c=g,f=ha(),f!==d?(h=y(),h!==d?(h=ja(),h!==d?(m=y(),m!==d?(m=A(),m!==d?(p=y(),p!==d?(p=da(),p!==d?(f=y(),f!==d?(f=A(),f!==d?c=f={op:"NOT"+h,right:{type:"expr_list",value:[m,f]}}:(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d),
c===d&&(c=g,f=ja(),f!==d?(h=y(),h!==d?(h=A(),h!==d?(m=y(),m!==d?(m=da(),m!==d?(p=y(),p!==d?(p=A(),p!==d?c=f={op:f,right:{type:"expr_list",value:[h,p]}}:(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d)),c===d&&(c=g,h=S(),h!==d?(f=y(),f!==d?(f=ha(),f!==d?(f=y(),f!==d?(f=A(),f!==d?c=h={op:h+"NOT",right:f}:(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d),c===d&&(c=g,h=S(),h!==d?(f=y(),f!==d?(f=A(),f!==d?c=h={op:h,right:f}:(g=c,c=d)):(g=c,c=d)):(g=c,c=d)),c===d&&(c=g,h=
C(),h!==d?(f=y(),f!==d?(f=N(),f!==d?(m=y(),m!==d?(m=g,a.substr(g,6).toLowerCase()===bd?(p=a.substr(g,6),g+=6):(p=d,0===x&&k(cd)),p!==d?(p=g,x++,l=w(),x--,l===d?p=void 0:(g=p,p=d),p!==d?m="ESCAPE":(g=m,m=d)):(g=m,m=d),m!==d?(m=y(),m!==d?(m=ma(),m!==d?c=h={op:h,right:f,escape:m.value}:(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d),c===d&&(c=g,h=C(),h!==d?(f=y(),f!==d?(f=N(),f!==d?c=h={op:h,right:f,escape:""}:(g=c,c=d)):(g=c,c=d)):(g=c,c=d))))));c===d&&(c=null);c!==d?(b=
e,e=c,""==e||void 0==e||null==e?e=b:(c=null,e=c="arithmetic"==e.type?Ba(b,e.tail):eb(e.op,b,e.right,e.escape)),b=e):(g=b,b=d)}else g=b,b=d;else g=b,b=d;return b}function B(){var b;a.substr(g,2)===fb?(b=fb,g+=2):(b=d,0===x&&k(dd));b===d&&(62===a.charCodeAt(g)?(b=ed,g++):(b=d,0===x&&k(fd)),b===d&&(a.substr(g,2)===gb?(b=gb,g+=2):(b=d,0===x&&k(gd)),b===d&&(a.substr(g,2)===hb?(b=hb,g+=2):(b=d,0===x&&k(hd)),b===d&&(60===a.charCodeAt(g)?(b=id,g++):(b=d,0===x&&k(jd)),b===d&&(61===a.charCodeAt(g)?(b=cb,g++):
(b=d,0===x&&k(db)),b===d&&(a.substr(g,2)===ib?(b=ib,g+=2):(b=d,0===x&&k(kd))))))));return b}function C(){var a,b,c,e;a=a=g;b=ha();b!==d?(c=y(),c!==d?(e=X(),e!==d?a=b=[b,c,e]:(g=a,a=d)):(g=a,a=d)):(g=a,a=d);a!==d&&(a=a[0]+" "+a[2]);a===d&&(a=X());return a}function I(){var a,b,c,e;a=a=g;b=ha();b!==d?(c=y(),c!==d?(e=L(),e!==d?a=b=[b,c,e]:(g=a,a=d)):(g=a,a=d)):(g=a,a=d);a!==d&&(a=a[0]+" "+a[2]);a===d&&(a=L());return a}function A(){var a,b,c,h,f,m,p,l;a=g;b=q();if(b!==d){c=[];h=g;f=y();f!==d?(m=e(),m!==
d?(p=y(),p!==d?(l=q(),l!==d?h=f=[f,m,p,l]:(g=h,h=d)):(g=h,h=d)):(g=h,h=d)):(g=h,h=d);for(;h!==d;)c.push(h),h=g,f=y(),f!==d?(m=e(),m!==d?(p=y(),p!==d?(l=q(),l!==d?h=f=[f,m,p,l]:(g=h,h=d)):(g=h,h=d)):(g=h,h=d)):(g=h,h=d);c!==d?a=b=Ba(b,c):(g=a,a=d)}else g=a,a=d;return a}function e(){var b;43===a.charCodeAt(g)?(b=cc,g++):(b=d,0===x&&k(dc));b===d&&(45===a.charCodeAt(g)?(b=ec,g++):(b=d,0===x&&k(fc)));return b}function q(){var a,b,c,e,f,p,l,q;a=g;b=m();if(b!==d){c=[];e=g;f=y();f!==d?(p=h(),p!==d?(l=y(),
l!==d?(q=m(),q!==d?e=f=[f,p,l,q]:(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d);for(;e!==d;)c.push(e),e=g,f=y(),f!==d?(p=h(),p!==d?(l=y(),l!==d?(q=m(),q!==d?e=f=[f,p,l,q]:(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d);c!==d?a=b=Ba(b,c):(g=a,a=d)}else g=a,a=d;return a}function h(){var b;42===a.charCodeAt(g)?(b=ld,g++):(b=d,0===x&&k(md));b===d&&(47===a.charCodeAt(g)?(b=nd,g++):(b=d,0===x&&k(od)));return b}function m(){var b,c,e,h,f,m,l;l=ma();if(l===d){var q,n,A,r;q=g;var t,F,B,G;t=g;F=za();F!==d?(B=sa(),B!==
d?(G=ba(),G!==d?t=F=parseFloat(F+B+G):(g=t,t=d)):(g=t,t=d)):(g=t,t=d);t===d&&(t=g,F=za(),F!==d?(B=sa(),B!==d?t=F=parseFloat(F+B):(g=t,t=d)):(g=t,t=d),t===d&&(t=g,F=za(),F!==d?(B=ba(),B!==d?t=F=parseFloat(F+B):(g=t,t=d)):(g=t,t=d),t===d&&(t=g,F=za(),F!==d&&(F=parseFloat(F)),t=F)));n=t;n!==d?(A=g,x++,r=E(),x--,r===d?A=void 0:(g=A,A=d),A!==d?q=n={type:"number",value:n}:(g=q,q=d)):(g=q,q=d);l=q;if(l===d){var H,C;H=g;var u,D,I,W;u=g;a.substr(g,4).toLowerCase()===pd?(D=a.substr(g,4),g+=4):(D=d,0===x&&k(qd));
D!==d?(I=g,x++,W=w(),x--,W===d?I=void 0:(g=I,I=d),I!==d?u=D=[D,I]:(g=u,u=d)):(g=u,u=d);C=u;C!==d&&(C={type:"bool",value:!0});H=C;if(H===d){H=g;var S,X,Y,ka;S=g;a.substr(g,5).toLowerCase()===rd?(X=a.substr(g,5),g+=5):(X=d,0===x&&k(sd));X!==d?(Y=g,x++,ka=w(),x--,ka===d?Y=void 0:(g=Y,Y=d),Y!==d?S=X=[X,Y]:(g=S,S=d)):(g=S,S=d);C=S;C!==d&&(C={type:"bool",value:!1});H=C}l=H;if(l===d){var ha,da,la,ja,Ba;da=g;a.substr(g,4).toLowerCase()===td?(la=a.substr(g,4),g+=4):(la=d,0===x&&k(ud));la!==d?(ja=g,x++,Ba=
w(),x--,Ba===d?ja=void 0:(g=ja,ja=d),ja!==d?da=la=[la,ja]:(g=da,da=d)):(g=da,da=d);ha=da;ha!==d&&(ha={type:"null",value:null});l=ha;if(l===d){var wa,Aa,Ga,Ea;wa=g;var Ha,ya,jb,Qa;Ha=g;a.substr(g,4).toLowerCase()===vd?(ya=a.substr(g,4),g+=4):(ya=d,0===x&&k(wd));ya!==d?(jb=g,x++,Qa=w(),x--,Qa===d?jb=void 0:(g=jb,jb=d),jb!==d?Ha=ya="DATE":(g=Ha,Ha=d)):(g=Ha,Ha=d);Aa=Ha;Aa!==d?(Ga=y(),Ga!==d?(Ea=N(),Ea!==d?wa=Aa={type:"date",value:Ea.value}:(g=wa,wa=d)):(g=wa,wa=d)):(g=wa,wa=d);l=wa;if(l===d){var xa,
gc,ab,hc;xa=g;var Ia,Hb,kb,bb;Ia=g;a.substr(g,9).toLowerCase()===xd?(Hb=a.substr(g,9),g+=9):(Hb=d,0===x&&k(yd));Hb!==d?(kb=g,x++,bb=w(),x--,bb===d?kb=void 0:(g=kb,kb=d),kb!==d?Ia=Hb="TIMESTAMP":(g=Ia,Ia=d)):(g=Ia,Ia=d);gc=Ia;gc!==d?(ab=y(),ab!==d?(hc=N(),hc!==d?xa=gc={type:"timestamp",value:hc.value}:(g=xa,xa=d)):(g=xa,xa=d)):(g=xa,xa=d);l=xa;if(l===d){var O,Ra,Ib,ua,Jb,Sa,cb,ic;O=g;Ra=$a();Ra!==d?(Ib=y(),Ib!==d?(45===a.charCodeAt(g)?(ua=ec,g++):(ua=d,0===x&&k(fc)),ua===d&&(43===a.charCodeAt(g)?(ua=
cc,g++):(ua=d,0===x&&k(dc))),ua!==d?(Jb=y(),Jb!==d?(Sa=N(),Sa!==d?(cb=y(),cb!==d?(ic=Q(),ic!==d?O=Ra={type:"interval",value:Sa,qualifier:ic,op:ua}:(g=O,O=d)):(g=O,O=d)):(g=O,O=d)):(g=O,O=d)):(g=O,O=d)):(g=O,O=d)):(g=O,O=d);O===d&&(O=g,Ra=$a(),Ra!==d?(Ib=y(),Ib!==d?(ua=N(),ua!==d?(Jb=y(),Jb!==d?(Sa=Q(),Sa!==d?O=Ra={type:"interval",value:ua,qualifier:Sa,op:""}:(g=O,O=d)):(g=O,O=d)):(g=O,O=d)):(g=O,O=d)):(g=O,O=d));l=O}}}}}}b=l;if(b===d){var T,jc,db,eb,fb,kc,gb,hb,ib,lc,ub,vb;T=g;var Ja,Kb,lb,wb;Ja=
g;a.substr(g,7).toLowerCase()===zd?(Kb=a.substr(g,7),g+=7):(Kb=d,0===x&&k(Ad));Kb!==d?(lb=g,x++,wb=w(),x--,wb===d?lb=void 0:(g=lb,lb=d),lb!==d?Ja=Kb="EXTRACT":(g=Ja,Ja=d)):(g=Ja,Ja=d);jc=Ja;if(jc!==d)if(db=y(),db!==d)if(eb=ea(),eb!==d)if(fb=y(),fb!==d){var na;na=vc();na===d&&(na=wc(),na===d&&(na=xc(),na===d&&(na=yc(),na===d&&(na=zc(),na===d&&(na=Fa())))));kc=na;kc!==d?(gb=y(),gb!==d?(hb=Oa(),hb!==d?(ib=y(),ib!==d?(lc=z(),lc!==d?(ub=y(),ub!==d?(vb=fa(),vb!==d?T=jc={type:"function",name:"extract",args:{type:"expr_list",
value:[{type:"string",value:kc},lc]}}:(g=T,T=d)):(g=T,T=d)):(g=T,T=d)):(g=T,T=d)):(g=T,T=d)):(g=T,T=d)):(g=T,T=d)}else g=T,T=d;else g=T,T=d;else g=T,T=d;else g=T,T=d;b=T;if(b===d){var R,mc,xb,yb,zb,Lb,Ab,Bb,Cb,Mb,Db,ga,Ta,nc,oc,pc;R=g;var Ka,Nb,mb,Eb;Ka=g;a.substr(g,9).toLowerCase()===Bd?(Nb=a.substr(g,9),g+=9):(Nb=d,0===x&&k(Cd));Nb!==d?(mb=g,x++,Eb=w(),x--,Eb===d?mb=void 0:(g=mb,mb=d),mb!==d?Ka=Nb="SUBSTRING":(g=Ka,Ka=d)):(g=Ka,Ka=d);mc=Ka;if(mc!==d)if(xb=y(),xb!==d)if(yb=ea(),yb!==d)if(zb=y(),
zb!==d)if(Lb=z(),Lb!==d)if(Ab=y(),Ab!==d)if(Bb=Oa(),Bb!==d)if(Cb=y(),Cb!==d)if(Mb=z(),Mb!==d)if(Db=y(),Db!==d){ga=g;var La,Ob,nb,Ac;La=g;a.substr(g,3).toLowerCase()===Dd?(Ob=a.substr(g,3),g+=3):(Ob=d,0===x&&k(Ed));Ob!==d?(nb=g,x++,Ac=w(),x--,Ac===d?nb=void 0:(g=nb,nb=d),nb!==d?La=Ob="FOR":(g=La,La=d)):(g=La,La=d);Ta=La;Ta!==d?(nc=y(),nc!==d?(oc=z(),oc!==d?(pc=y(),pc!==d?ga=Ta=[Ta,nc,oc,pc]:(g=ga,ga=d)):(g=ga,ga=d)):(g=ga,ga=d)):(g=ga,ga=d);ga===d&&(ga=null);ga!==d?(Ta=fa(),Ta!==d?R=mc={type:"function",
name:"substring",args:{type:"expr_list",value:ga?[Lb,Mb,ga[2]]:[Lb,Mb]}}:(g=R,R=d)):(g=R,R=d)}else g=R,R=d;else g=R,R=d;else g=R,R=d;else g=R,R=d;else g=R,R=d;else g=R,R=d;else g=R,R=d;else g=R,R=d;else g=R,R=d;else g=R,R=d;b=R;if(b===d){var J,Ua,Pb,Qb,Rb,oa,Sb,Va,Tb,Ub,Bc,qc,Cc,Dc;J=g;Ua=Pa();Ua!==d?(Pb=y(),Pb!==d?(Qb=ea(),Qb!==d?(Rb=y(),Rb!==d?(oa=ia(),oa===d&&(oa=null),oa!==d?(Sb=y(),Sb!==d?(Va=z(),Va!==d?(Tb=y(),Tb!==d?(Ub=Oa(),Ub!==d?(Bc=y(),Bc!==d?(qc=z(),qc!==d?(Cc=y(),Cc!==d?(Dc=fa(),Dc!==
d?J=Ua={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==oa?"BOTH":oa},Va,qc]}}:(g=J,J=d)):(g=J,J=d)):(g=J,J=d)):(g=J,J=d)):(g=J,J=d)):(g=J,J=d)):(g=J,J=d)):(g=J,J=d)):(g=J,J=d)):(g=J,J=d)):(g=J,J=d)):(g=J,J=d)):(g=J,J=d);J===d&&(J=g,Ua=Pa(),Ua!==d?(Pb=y(),Pb!==d?(Qb=ea(),Qb!==d?(Rb=y(),Rb!==d?(oa=ia(),oa===d&&(oa=null),oa!==d?(Sb=y(),Sb!==d?(Va=z(),Va!==d?(Tb=y(),Tb!==d?(Ub=fa(),Ub!==d?J=Ua={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",
value:null==oa?"BOTH":oa},Va]}}:(g=J,J=d)):(g=J,J=d)):(g=J,J=d)):(g=J,J=d)):(g=J,J=d)):(g=J,J=d)):(g=J,J=d)):(g=J,J=d)):(g=J,J=d));b=J;if(b===d){var U,rc,Ec,Fc,Gc,sc,Hc,Ic,Jc,tc,Kc,Lc;U=g;var Ma,Vb,ob,Mc;Ma=g;a.substr(g,8).toLowerCase()===Fd?(Vb=a.substr(g,8),g+=8):(Vb=d,0===x&&k(Gd));Vb!==d?(ob=g,x++,Mc=w(),x--,Mc===d?ob=void 0:(g=ob,ob=d),ob!==d?Ma=Vb="POSITION":(g=Ma,Ma=d)):(g=Ma,Ma=d);rc=Ma;rc!==d?(Ec=y(),Ec!==d?(Fc=ea(),Fc!==d?(Gc=y(),Gc!==d?(sc=z(),sc!==d?(Hc=y(),Hc!==d?(Ic=L(),Ic!==d?(Jc=y(),
Jc!==d?(tc=z(),tc!==d?(Kc=y(),Kc!==d?(Lc=fa(),Lc!==d?U=rc={type:"function",name:"position",args:{type:"expr_list",value:[sc,tc]}}:(g=U,U=d)):(g=U,U=d)):(g=U,U=d)):(g=U,U=d)):(g=U,U=d)):(g=U,U=d)):(g=U,U=d)):(g=U,U=d)):(g=U,U=d)):(g=U,U=d)):(g=U,U=d);b=U;if(b===d){var ca,Wb,Nc,Oc,Pc,Wa,Qc,Rc;ca=g;var pa,pb,qb,va;pa=g;pa=pb=p();if(pa===d)if(pa=g,96===a.charCodeAt(g)?(pb=Sc,g++):(pb=d,0===x&&k(Tc)),pb!==d){qb=[];Uc.test(a.charAt(g))?(va=a.charAt(g),g++):(va=d,0===x&&k(Vc));if(va!==d)for(;va!==d;)qb.push(va),
Uc.test(a.charAt(g))?(va=a.charAt(g),g++):(va=d,0===x&&k(Vc));else qb=d;qb!==d?(96===a.charCodeAt(g)?(va=Sc,g++):(va=d,0===x&&k(Tc)),va!==d?pa=pb=qb.join(""):(g=pa,pa=d)):(g=pa,pa=d)}else g=pa,pa=d;Wb=pa;Wb!==d?(Nc=y(),Nc!==d?(Oc=ea(),Oc!==d?(Pc=y(),Pc!==d?(Wa=v(),Wa===d&&(Wa=null),Wa!==d?(Qc=y(),Qc!==d?(Rc=fa(),Rc!==d?ca=Wb={type:"function",name:Wb,args:Wa?Wa:{type:"expr_list",value:[]}}:(g=ca,ca=d)):(g=ca,ca=d)):(g=ca,ca=d)):(g=ca,ca=d)):(g=ca,ca=d)):(g=ca,ca=d)):(g=ca,ca=d);b=ca;if(b===d){var Xb,
M,Xa,Yb,Ya,Zb,Ca,qa,rb,Wc,Xc;M=g;Xa=Fb();if(Xa!==d)if(Yb=y(),Yb!==d)if(Ya=z(),Ya!==d)if(Zb=y(),Zb!==d){Ca=[];for(qa=Z();qa!==d;)Ca.push(qa),qa=Z();Ca!==d?(qa=y(),qa!==d?(rb=Gb(),rb!==d?M=Xa={type:"case_expression",format:"simple",operand:Ya,clauses:Ca,else:null}:(g=M,M=d)):(g=M,M=d)):(g=M,M=d)}else g=M,M=d;else g=M,M=d;else g=M,M=d;else g=M,M=d;if(M===d)if(M=g,Xa=Fb(),Xa!==d)if(Yb=y(),Yb!==d)if(Ya=z(),Ya!==d)if(Zb=y(),Zb!==d){Ca=[];for(qa=Z();qa!==d;)Ca.push(qa),qa=Z();Ca!==d?(qa=y(),qa!==d?(rb=ta(),
rb!==d?(Wc=y(),Wc!==d?(Xc=Gb(),Xc!==d?M=Xa={type:"case_expression",format:"simple",operand:Ya,clauses:Ca,else:rb.value}:(g=M,M=d)):(g=M,M=d)):(g=M,M=d)):(g=M,M=d)):(g=M,M=d)}else g=M,M=d;else g=M,M=d;else g=M,M=d;else g=M,M=d;Xb=M;if(Xb===d){var P,Za,$b,Da,ra,sb,Yc,Zc;P=g;Za=Fb();if(Za!==d)if($b=y(),$b!==d){Da=[];for(ra=V();ra!==d;)Da.push(ra),ra=V();Da!==d?(ra=y(),ra!==d?(sb=Gb(),sb!==d?P=Za={type:"case_expression",format:"searched",clauses:Da,else:null}:(g=P,P=d)):(g=P,P=d)):(g=P,P=d)}else g=P,
P=d;else g=P,P=d;if(P===d)if(P=g,Za=Fb(),Za!==d)if($b=y(),$b!==d){Da=[];for(ra=V();ra!==d;)Da.push(ra),ra=V();Da!==d?(ra=y(),ra!==d?(sb=ta(),sb!==d?(Yc=y(),Yc!==d?(Zc=Gb(),Zc!==d?P=Za={type:"case_expression",format:"searched",clauses:Da,else:sb.value}:(g=P,P=d)):(g=P,P=d)):(g=P,P=d)):(g=P,P=d)):(g=P,P=d)}else g=P,P=d;else g=P,P=d;Xb=P}b=Xb;if(b===d){var tb,Na,uc,ac,bc;Na=g;uc=E();if(uc!==d){ac=[];for(bc=K();bc!==d;)ac.push(bc),bc=K();ac!==d?Na=uc+=ac.join(""):(g=Na,Na=d)}else g=Na,Na=d;tb=Na;tb!==
d&&(tb={type:"column_ref",table:"",column:tb});b=tb;b===d&&(b=aa(),b===d&&(b=g,c=ea(),c!==d?(e=y(),e!==d?(h=z(),h!==d?(f=y(),f!==d?(m=fa(),m!==d?(h.paren=!0,b=c=h):(g=b,b=d)):(g=b,b=d)):(g=b,b=d)):(g=b,b=d)):(g=b,b=d)))}}}}}}}return b}function p(){var a,b,c,e;a=g;b=E();if(b!==d){c=[];for(e=w();e!==d;)c.push(e),e=w();c!==d?a=b+=c.join(""):(g=a,a=d)}else g=a,a=d;return a}function E(){var b;Hd.test(a.charAt(g))?(b=a.charAt(g),g++):(b=d,0===x&&k(Id));return b}function w(){var b;Jd.test(a.charAt(g))?(b=
a.charAt(g),g++):(b=d,0===x&&k(Kd));return b}function K(){var b;Ld.test(a.charAt(g))?(b=a.charAt(g),g++):(b=d,0===x&&k(Md));return b}function aa(){var b,c,e;b=g;64===a.charCodeAt(g)?(c=Nd,g++):(c=d,0===x&&k(Od));c!==d?(e=p(),e!==d?b=c=[c,e]:(g=b,b=d)):(g=b,b=d);b!==d&&(b={type:"param",value:b[1]});return b}function ia(){var b,c,e;b=g;a.substr(g,7).toLowerCase()===Pd?(c=a.substr(g,7),g+=7):(c=d,0===x&&k(Qd));c!==d?(c=g,x++,e=w(),x--,e===d?c=void 0:(g=c,c=d),c!==d?b="LEADING":(g=b,b=d)):(g=b,b=d);b===
d&&(b=g,a.substr(g,8).toLowerCase()===Rd?(c=a.substr(g,8),g+=8):(c=d,0===x&&k(Sd)),c!==d?(c=g,x++,e=w(),x--,e===d?c=void 0:(g=c,c=d),c!==d?b="TRAILING":(g=b,b=d)):(g=b,b=d),b===d&&(b=g,a.substr(g,4).toLowerCase()===Td?(c=a.substr(g,4),g+=4):(c=d,0===x&&k(Ud)),c!==d?(c=g,x++,e=w(),x--,e===d?c=void 0:(g=c,c=d),c!==d?b="BOTH":(g=b,b=d)):(g=b,b=d)));return b}function Q(){var b,c,e;b=g;var h,f;c=g;e=H();e!==d?(h=y(),h!==d?(h=ea(),h!==d?(h=y(),h!==d?(h=F(),h!==d?(f=y(),f!==d?(f=fa(),f!==d?c=e={type:"interval-period",
period:e.value,precision:h,secondary:null}:(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d)):(g=c,c=d);c===d&&(c=g,e=H(),e!==d&&(e=ub(e)),c=e);if(c!==d)if(e=y(),e!==d)if(e=g,a.substr(g,2).toLowerCase()===Vd?(h=a.substr(g,2),g+=2):(h=d,0===x&&k(Wd)),h!==d?(h=g,x++,f=w(),x--,f===d?h=void 0:(g=h,h=d),h!==d?e="TO":(g=e,e=d)):(g=e,e=d),e!==d)if(e=y(),e!==d){var m;e=g;h=H();h!==d&&(h={type:"interval-period",period:h.value,precision:null,secondary:null});e=h;e===d&&(e=g,h=Fa(),h!==d?(h=y(),
h!==d?(h=ea(),h!==d?(h=y(),h!==d?(h=F(),h!==d?(f=y(),f!==d?(f=Aa(),f!==d?(f=y(),f!==d?(f=l(),f!==d?(m=y(),m!==d?(m=fa(),m!==d?e=h=vb(h,f):(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d),e===d&&(e=g,h=Fa(),h!==d?(h=y(),h!==d?(h=ea(),h!==d?(h=y(),h!==d?(h=F(),h!==d?(f=y(),f!==d?(f=fa(),f!==d?e=h={type:"interval-period",period:"second",precision:h,secondary:null}:(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):
(g=e,e=d),e===d&&(e=g,h=Fa(),h!==d&&(h={type:"interval-period",period:"second",precision:null,secondary:null}),e=h)));e!==d?b=c={type:"interval-qualifier",start:c,end:e}:(g=b,b=d)}else g=b,b=d;else g=b,b=d;else g=b,b=d;else g=b,b=d;b===d&&(b=g,e=H(),e!==d?(c=y(),c!==d?(c=ea(),c!==d?(c=y(),c!==d?(c=l(),c!==d?(h=y(),h!==d?(h=fa(),h!==d?b=e={type:"interval-period",period:e.value,precision:c,secondary:null}:(g=b,b=d)):(g=b,b=d)):(g=b,b=d)):(g=b,b=d)):(g=b,b=d)):(g=b,b=d)):(g=b,b=d),b===d&&(b=g,e=H(),
e!==d&&(e=ub(e)),b=e,b===d&&(b=g,e=Fa(),e!==d?(c=y(),c!==d?(c=ea(),c!==d?(c=y(),c!==d?(c=F(),c!==d?(h=y(),h!==d?(h=Aa(),h!==d?(e=y(),e!==d?(e=l(),e!==d?(h=y(),h!==d?(h=fa(),h!==d?b=e=vb(c,e):(g=b,b=d)):(g=b,b=d)):(g=b,b=d)):(g=b,b=d)):(g=b,b=d)):(g=b,b=d)):(g=b,b=d)):(g=b,b=d)):(g=b,b=d)):(g=b,b=d)):(g=b,b=d),b===d&&(b=g,e=Fa(),e!==d?(c=y(),c!==d?(c=ea(),c!==d?(c=y(),c!==d?(c=l(),c!==d?(h=y(),h!==d?(h=fa(),h!==d?b=e={type:"interval-period",period:"second",precision:c,secondary:null}:(g=b,b=d)):(g=
b,b=d)):(g=b,b=d)):(g=b,b=d)):(g=b,b=d)):(g=b,b=d)):(g=b,b=d),b===d&&(b=g,e=Fa(),e!==d&&(e={type:"interval-period",period:"second",precision:null,secondary:null}),b=e)))));return b}function H(){var a;a=g;a=xc();a!==d&&(a={type:"string",value:"day"});a===d&&(a=g,a=yc(),a!==d&&(a={type:"string",value:"hour"}),a===d&&(a=g,a=zc(),a!==d&&(a={type:"string",value:"minute"}),a===d&&(a=g,a=wc(),a!==d&&(a={type:"string",value:"month"}),a===d&&(a=g,a=vc(),a!==d&&(a={type:"string",value:"year"})))));return a}
function l(){var a;a=W();a!==d&&(a=parseFloat(a));return a}function F(){var a;a=W();a!==d&&(a=parseFloat(a));return a}function N(){var a;a=ma();a===d&&(a=aa());return a}function ma(){var b,c,e;b=g;39===a.charCodeAt(g)?(c=wb,g++):(c=d,0===x&&k(xb));c===d&&(a.substr(g,2)===yb?(c=yb,g+=2):(c=d,0===x&&k(Xd)));if(c!==d){c=[];e=g;a.substr(g,2)===Ea?(e=Ea,g+=2):(e=d,0===x&&k(zb));e!==d&&(e="'");e===d&&(Ab.test(a.charAt(g))?(e=a.charAt(g),g++):(e=d,0===x&&k(Bb)));for(;e!==d;)c.push(e),e=g,a.substr(g,2)===
Ea?(e=Ea,g+=2):(e=d,0===x&&k(zb)),e!==d&&(e="'"),e===d&&(Ab.test(a.charAt(g))?(e=a.charAt(g),g++):(e=d,0===x&&k(Bb)));c!==d?(39===a.charCodeAt(g)?(e=wb,g++):(e=d,0===x&&k(xb)),e!==d?b=c={type:"string",value:c.join("")}:(g=b,b=d)):(g=b,b=d)}else g=b,b=d;return b}function V(){var a,b,c;a=g;b=ab();b!==d?(b=y(),b!==d?(b=z(),b!==d?(c=y(),c!==d?(c=bb(),c!==d?(c=y(),c!==d?(c=z(),c!==d?a=b={type:"when_clause",operand:b,value:c}:(g=a,a=d)):(g=a,a=d)):(g=a,a=d)):(g=a,a=d)):(g=a,a=d)):(g=a,a=d)):(g=a,a=d);return a}
function Z(){var a,b,c;a=g;b=ab();b!==d?(b=y(),b!==d?(b=z(),b!==d?(c=y(),c!==d?(c=bb(),c!==d?(c=y(),c!==d?(c=z(),c!==d?a=b={type:"when_clause",operand:b,value:c}:(g=a,a=d)):(g=a,a=d)):(g=a,a=d)):(g=a,a=d)):(g=a,a=d)):(g=a,a=d)):(g=a,a=d);return a}function ta(){var b,c;b=g;var e,h;c=g;a.substr(g,4).toLowerCase()===Yd?(e=a.substr(g,4),g+=4):(e=d,0===x&&k(Zd));e!==d?(e=g,x++,h=w(),x--,h===d?e=void 0:(g=e,e=d),e!==d?c="ELSE":(g=c,c=d)):(g=c,c=d);c!==d?(c=y(),c!==d?(c=z(),c!==d?b={type:"else_clause",value:c}:
(g=b,b=d)):(g=b,b=d)):(g=b,b=d);return b}function za(){var b,c,e;b=W();b===d&&(b=g,45===a.charCodeAt(g)?(c=ec,g++):(c=d,0===x&&k(fc)),c===d&&(43===a.charCodeAt(g)?(c=cc,g++):(c=d,0===x&&k(dc))),c!==d?(e=W(),e!==d?b=c=c[0]+e:(g=b,b=d)):(g=b,b=d));return b}function sa(){var b,c;b=g;46===a.charCodeAt(g)?(c=$d,g++):(c=d,0===x&&k(ae));c!==d?(c=W(),c===d&&(c=null),c!==d?b="."+(null!=c?c:""):(g=b,b=d)):(g=b,b=d);return b}function ba(){var b,c,e;c=b=g;be.test(a.charAt(g))?(e=a.charAt(g),g++):(e=d,0===x&&
k(ce));e!==d?(de.test(a.charAt(g))?(e=a.charAt(g),g++):(e=d,0===x&&k(ee)),e===d&&(e=null),e!==d?c="e"+(null===e?"":e):(g=c,c=d)):(g=c,c=d);c!==d?(e=W(),e!==d?b=c+e:(g=b,b=d)):(g=b,b=d);return b}function W(){var a,b;a=[];b=Y();if(b!==d)for(;b!==d;)a.push(b),b=Y();else a=d;a!==d&&(a=a.join(""));return a}function Y(){var b;fe.test(a.charAt(g))?(b=a.charAt(g),g++):(b=d,0===x&&k(ge));return b}function L(){var b,c,e;b=g;a.substr(g,2).toLowerCase()===he?(c=a.substr(g,2),g+=2):(c=d,0===x&&k(ie));c!==d?(c=
g,x++,e=w(),x--,e===d?c=void 0:(g=c,c=d),c!==d?b="IN":(g=b,b=d)):(g=b,b=d);return b}function S(){var b,c,e;b=g;a.substr(g,2).toLowerCase()===je?(c=a.substr(g,2),g+=2):(c=d,0===x&&k(ke));c!==d?(c=g,x++,e=w(),x--,e===d?c=void 0:(g=c,c=d),c!==d?b="IS":(g=b,b=d)):(g=b,b=d);return b}function X(){var b,c,e;b=g;a.substr(g,4).toLowerCase()===le?(c=a.substr(g,4),g+=4):(c=d,0===x&&k(me));c!==d?(c=g,x++,e=w(),x--,e===d?c=void 0:(g=c,c=d),c!==d?b="LIKE":(g=b,b=d)):(g=b,b=d);return b}function ha(){var b,c,e;b=
g;a.substr(g,3).toLowerCase()===ne?(c=a.substr(g,3),g+=3):(c=d,0===x&&k(oe));c!==d?(c=g,x++,e=w(),x--,e===d?c=void 0:(g=c,c=d),c!==d?b="NOT":(g=b,b=d)):(g=b,b=d);return b}function da(){var b,c,e;b=g;a.substr(g,3).toLowerCase()===pe?(c=a.substr(g,3),g+=3):(c=d,0===x&&k(qe));c!==d?(c=g,x++,e=w(),x--,e===d?c=void 0:(g=c,c=d),c!==d?b="AND":(g=b,b=d)):(g=b,b=d);return b}function la(){var b,c,e;b=g;a.substr(g,2).toLowerCase()===re?(c=a.substr(g,2),g+=2):(c=d,0===x&&k(se));c!==d?(c=g,x++,e=w(),x--,e===d?
c=void 0:(g=c,c=d),c!==d?b="OR":(g=b,b=d)):(g=b,b=d);return b}function ja(){var b,c,e;b=g;a.substr(g,7).toLowerCase()===te?(c=a.substr(g,7),g+=7):(c=d,0===x&&k(ue));c!==d?(c=g,x++,e=w(),x--,e===d?c=void 0:(g=c,c=d),c!==d?b="BETWEEN":(g=b,b=d)):(g=b,b=d);return b}function Oa(){var b,c,e;b=g;a.substr(g,4).toLowerCase()===ve?(c=a.substr(g,4),g+=4):(c=d,0===x&&k(we));c!==d?(c=g,x++,e=w(),x--,e===d?c=void 0:(g=c,c=d),c!==d?b="FROM":(g=b,b=d)):(g=b,b=d);return b}function Pa(){var b,c,e;b=g;a.substr(g,4).toLowerCase()===
xe?(c=a.substr(g,4),g+=4):(c=d,0===x&&k(ye));c!==d?(c=g,x++,e=w(),x--,e===d?c=void 0:(g=c,c=d),c!==d?b="TRIM":(g=b,b=d)):(g=b,b=d);return b}function $a(){var b,c,e;b=g;a.substr(g,8).toLowerCase()===ze?(c=a.substr(g,8),g+=8):(c=d,0===x&&k(Ae));c!==d?(c=g,x++,e=w(),x--,e===d?c=void 0:(g=c,c=d),c!==d?b="INTERVAL":(g=b,b=d)):(g=b,b=d);return b}function vc(){var b,c,e;b=g;a.substr(g,4).toLowerCase()===Be?(c=a.substr(g,4),g+=4):(c=d,0===x&&k(Ce));c!==d?(c=g,x++,e=w(),x--,e===d?c=void 0:(g=c,c=d),c!==d?
b="YEAR":(g=b,b=d)):(g=b,b=d);return b}function wc(){var b,c,e;b=g;a.substr(g,5).toLowerCase()===De?(c=a.substr(g,5),g+=5):(c=d,0===x&&k(Ee));c!==d?(c=g,x++,e=w(),x--,e===d?c=void 0:(g=c,c=d),c!==d?b="MONTH":(g=b,b=d)):(g=b,b=d);return b}function xc(){var b,c,e;b=g;a.substr(g,3).toLowerCase()===Fe?(c=a.substr(g,3),g+=3):(c=d,0===x&&k(Ge));c!==d?(c=g,x++,e=w(),x--,e===d?c=void 0:(g=c,c=d),c!==d?b="DAY":(g=b,b=d)):(g=b,b=d);return b}function yc(){var b,c,e;b=g;a.substr(g,4).toLowerCase()===He?(c=a.substr(g,
4),g+=4):(c=d,0===x&&k(Ie));c!==d?(c=g,x++,e=w(),x--,e===d?c=void 0:(g=c,c=d),c!==d?b="HOUR":(g=b,b=d)):(g=b,b=d);return b}function zc(){var b,c,e;b=g;a.substr(g,6).toLowerCase()===Je?(c=a.substr(g,6),g+=6):(c=d,0===x&&k(Ke));c!==d?(c=g,x++,e=w(),x--,e===d?c=void 0:(g=c,c=d),c!==d?b="MINUTE":(g=b,b=d)):(g=b,b=d);return b}function Fa(){var b,c,e;b=g;a.substr(g,6).toLowerCase()===Le?(c=a.substr(g,6),g+=6):(c=d,0===x&&k(Me));c!==d?(c=g,x++,e=w(),x--,e===d?c=void 0:(g=c,c=d),c!==d?b="SECOND":(g=b,b=d)):
(g=b,b=d);return b}function Fb(){var b,c,e;b=g;a.substr(g,4).toLowerCase()===Ne?(c=a.substr(g,4),g+=4):(c=d,0===x&&k(Oe));c!==d?(c=g,x++,e=w(),x--,e===d?c=void 0:(g=c,c=d),c!==d?b="CASE":(g=b,b=d)):(g=b,b=d);return b}function Gb(){var b,c,e;b=g;a.substr(g,3).toLowerCase()===Pe?(c=a.substr(g,3),g+=3):(c=d,0===x&&k(Qe));c!==d?(c=g,x++,e=w(),x--,e===d?c=void 0:(g=c,c=d),c!==d?b="END":(g=b,b=d)):(g=b,b=d);return b}function ab(){var b,c,e;b=g;a.substr(g,4).toLowerCase()===Re?(c=a.substr(g,4),g+=4):(c=
d,0===x&&k(Se));c!==d?(c=g,x++,e=w(),x--,e===d?c=void 0:(g=c,c=d),c!==d?b="WHEN":(g=b,b=d)):(g=b,b=d);return b}function bb(){var b,c,e;b=g;a.substr(g,4).toLowerCase()===Te?(c=a.substr(g,4),g+=4):(c=d,0===x&&k(Ue));c!==d?(c=g,x++,e=w(),x--,e===d?c=void 0:(g=c,c=d),c!==d?b="THEN":(g=b,b=d)):(g=b,b=d);return b}function Aa(){var b;44===a.charCodeAt(g)?(b=Ve,g++):(b=d,0===x&&k(We));return b}function ea(){var b;40===a.charCodeAt(g)?(b=Xe,g++):(b=d,0===x&&k(Ye));return b}function fa(){var b;41===a.charCodeAt(g)?
(b=Ze,g++):(b=d,0===x&&k($e));return b}function y(){var a,b;a=[];for(b=Cb();b!==d;)a.push(b),b=Cb();return a}function Cb(){var b;af.test(a.charAt(g))?(b=a.charAt(g),g++):(b=d,0===x&&k(bf));return b}function eb(a,b,c,d){a={type:"binary_expr",operator:a,left:b,right:c};void 0!==d&&(a.escape=d);return a}function Ba(a,b){for(var c=0;c<b.length;c++)a=eb(b[c][1],a,b[c][3]);return a}u=void 0!==u?u:{};var d={},Db={start:r},Eb=r,$c="!",ad=n("!",!1),cb="\x3d",db=n("\x3d",!1),fb="\x3e\x3d",dd=n("\x3e\x3d",!1),
ed="\x3e",fd=n("\x3e",!1),gb="\x3c\x3d",gd=n("\x3c\x3d",!1),hb="\x3c\x3e",hd=n("\x3c\x3e",!1),id="\x3c",jd=n("\x3c",!1),ib="!\x3d",kd=n("!\x3d",!1),cc="+",dc=n("+",!1),ec="-",fc=n("-",!1),ld="*",md=n("*",!1),nd="/",od=n("/",!1),Hd=/^[A-Za-z_\x80-\uFFFF]/,Id=b([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Jd=/^[A-Za-z0-9_]/,Kd=b([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),Ld=/^[A-Za-z0-9_.\x80-\uFFFF]/,Md=b([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),Nd="@",Od=n("@",!1),
ub=function(a){return{type:"interval-period",period:a.value,precision:null,secondary:null}},vb=function(a,b){return{type:"interval-period",period:"second",precision:a,secondary:b}},wb="'",xb=n("'",!1),yb="N'",Xd=n("N'",!1),Ea="''",zb=n("''",!1),Ab=/^[^']/,Bb=b(["'"],!0,!1),$d=".",ae=n(".",!1),fe=/^[0-9]/,ge=b([["0","9"]],!1,!1),be=/^[eE]/,ce=b(["e","E"],!1,!1),de=/^[+\-]/,ee=b(["+","-"],!1,!1),td="null",ud=n("NULL",!0),pd="true",qd=n("TRUE",!0),rd="false",sd=n("FALSE",!0),he="in",ie=n("IN",!0),je=
"is",ke=n("IS",!0),le="like",me=n("LIKE",!0),bd="escape",cd=n("ESCAPE",!0),ne="not",oe=n("NOT",!0),pe="and",qe=n("AND",!0),re="or",se=n("OR",!0),te="between",ue=n("BETWEEN",!0),ve="from",we=n("FROM",!0),Dd="for",Ed=n("FOR",!0),Bd="substring",Cd=n("SUBSTRING",!0),zd="extract",Ad=n("EXTRACT",!0),xe="trim",ye=n("TRIM",!0),Fd="position",Gd=n("POSITION",!0),xd="timestamp",yd=n("TIMESTAMP",!0),vd="date",wd=n("DATE",!0),Pd="leading",Qd=n("LEADING",!0),Rd="trailing",Sd=n("TRAILING",!0),Td="both",Ud=n("BOTH",
!0),Vd="to",Wd=n("TO",!0),ze="interval",Ae=n("INTERVAL",!0),Be="year",Ce=n("YEAR",!0),De="month",Ee=n("MONTH",!0),Fe="day",Ge=n("DAY",!0),He="hour",Ie=n("HOUR",!0),Je="minute",Ke=n("MINUTE",!0),Le="second",Me=n("SECOND",!0),Ne="case",Oe=n("CASE",!0),Pe="end",Qe=n("END",!0),Re="when",Se=n("WHEN",!0),Te="then",Ue=n("THEN",!0),Yd="else",Zd=n("ELSE",!0),Ve=",",We=n(",",!1),Xe="(",Ye=n("(",!1),Ze=")",$e=n(")",!1),af=/^[ \t\n\r]/,bf=b([" ","\t","\n","\r"],!1,!1),Sc="`",Tc=n("`",!1),Uc=/^[^`]/,Vc=b(["`"],
!0,!1),g=0,Ga=[{line:1,column:1}],ka=0,Qa=[],x=0,ya;if("startRule"in u){if(!(u.startRule in Db))throw Error("Can't start parsing from rule \""+u.startRule+'".');Eb=Db[u.startRule]}ya=Eb();if(ya!==d&&g===a.length)return ya;ya!==d&&g<a.length&&k({type:"end"});throw function(a,b,c){return new D(D.buildMessage(a,b),a,b,c)}(Qa,ka<a.length?a.charAt(ka):null,ka<a.length?f(ka,ka+1):f(ka,ka));}}})},"esri/layers/graphics/data/projectionSupport":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(D,a,u,n,b,c,f,k,r){function v(a,b){var c;if(!b)return null;if("x"in b){var e={x:0,y:0};a=a(b.x,b.y,B);e.x=a[0];e.y=a[1];null!=b.z&&(e.z=b.z);null!=b.m&&(e.m=b.m);return e}if("xmin"in b)return e={xmin:0,ymin:0,xmax:0,ymax:0},c=a(b.xmin,b.ymin,B),e.xmin=c[0],e.ymin=c[1],a=a(b.xmax,b.ymax,B),e.xmax=a[0],e.ymax=a[1],b.hasZ&&(e.zmin=b.zmin,e.zmax=b.zmax,e.hasZ=!0),b.hasM&&(e.mmin=b.mmin,e.mmax=b.mmax,e.hasM=!0),e;if("rings"in b)return{rings:z(b.rings,a),hasM:b.hasM,hasZ:b.hasZ};if("paths"in b)return{paths:z(b.paths,
a),hasM:b.hasM,hasZ:b.hasZ};if("points"in b)return{points:t(b.points,a),hasM:b.hasM,hasZ:b.hasZ}}function z(a,b){for(var c=[],e=0;e<a.length;e++)c.push(t(a[e],b));return c}function t(a,b){for(var c=[],e=0;e<a.length;e++){var f=a[e],q=b(f[0],f[1],[0,0]);c.push(q);2<f.length&&q.push(f[2]);3<f.length&&q.push(f[3])}return c}function G(a,b){return!k.isValid(a)||!k.isValid(b)||k.equals(a,b)||r.canProject(a,b)?!1:!0}Object.defineProperty(a,"__esModule",{value:!0});var B=[0,0];a.doesBrowserSupportProjection=
function(a,b){return G(a,b)?f.isSupported():!0};a.checkProjectionSupport=function(a,c){return n(this,void 0,void 0,function(){var e,m,p;return u(this,function(h){if(!c)return[2];if(Array.isArray(a)){e=0;for(m=a;e<m.length;e++)if(p=m[e],G(p.geometry&&p.geometry.spatialReference,c)){if(f.isSupported())return[2,f.load()];throw new b("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:c});}return[2]}if(!G(a,c))return[2];if(f.isSupported())return[2,f.load()];
throw new b("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:c});})})};var C=v.bind(null,r.lngLatToXY),I=v.bind(null,r.xyToLngLat);a.project=function(a,b,c){if(!a)return a;c||(c=b,b=a.spatialReference);return k.isValid(b)&&k.isValid(c)&&!k.equals(b,c)?r.canProject(b,c)?k.isWebMercator(c)?C(a):I(a):f.projectMany([a],b,c,null,!0)[0]:a};var A=new (function(){function a(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}a.prototype.push=
function(a,b,e){return n(this,void 0,void 0,function(){var h,f=this;return u(this,function(p){a&&a.length&&b&&e&&!k.equals(b,e)||c.resolve(a);h={geometries:a,inSpatialReference:b,outSpatialReference:e,resolve:null};this._jobs.push(h);return[2,c.create(function(a){h.resolve=a;null===f._timer&&(f._timer=setTimeout(f._process,10))},function(){var a=f._jobs.indexOf(h);-1<a&&f._jobs.splice(a,1)})]})})};a.prototype._process=function(){this._timer=null;var a=this._jobs.shift();if(a){var b=a.geometries,c=
a.inSpatialReference,e=a.outSpatialReference,a=a.resolve;r.canProject(c,e)?k.isWebMercator(e)?a(b.map(C)):a(b.map(I)):a(f.projectMany(b,c,e,null,!0));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return a}());a.projectMany=function(a,b,c){return n(this,void 0,void 0,function(){return u(this,function(e){return[2,A.push(a,b,c)]})})}})},"esri/geometry/projection":function(){define("require exports ../core/promiseUtils ./pe ./SpatialReference ./support/GeographicTransformation".split(" "),
function(D,a,u,n,b,c){function f(a,f,n,v,u){void 0===v&&(v=null);void 0===u&&(u=!1);if(null===v){var A=c.cacheKey(f,n);void 0!==z[A]?v=z[A]:(v=k(f,n,null),null===v&&(v=new c),z[A]=v)}return r._project(a,f,n instanceof b||!1===u?n:new b(n),v,u)}function k(a,b,f){void 0===f&&(f=null);a=r._getTransformation(a,b,f);return null!==a?c.fromGE(a):null}Object.defineProperty(a,"__esModule",{value:!0});var r=null;a.isLoaded=function(){return!!r&&n.isLoaded()};a.isSupported=function(){return n.isSupported()};
var v=null;a.load=function(){return v?v:v=u.create(function(a,b){var c=n.load();D(["./geometryEngine"],function(f){r=f;c.then(function(){r._enableProjection(n);a()},function(a){b(a)})})})};a.project=function(a,b,c){void 0===c&&(c=null);return a instanceof Array?0===a.length?[]:f(a,a[0].spatialReference,b,c):f([a],a.spatialReference,b,c)[0]};var z={};a.projectMany=f;a.getTransformation=k;a.getTransformations=function(a,b,f){void 0===f&&(f=null);a=r._getTransformationBySuitability(a,b,f);if(null!==
a){b=[];for(f=0;f<a.length;f++)b.push(c.fromGE(a[f]));return b}return[]}})},"esri/geometry/pe":function(){define(["require","exports","../core/tsSupport/extendsHelper","../core/has","../core/promiseUtils"],function(D,a,u,n,b){function c(b){function c(a,b,c){a[b]=c(a[b])}a._pe=b;t.init();G.init();B.init();C.init();I.init();a.PeGCSExtent=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}u(c,b);c.prototype.destroy=function(){a._pe.destroy(this)};return c}(a._pe.PeGCSExtent);for(var f=
0,h=[a._pe.PeDatum,a._pe.PeGeogcs,a._pe.PeGeogtran,a._pe.PeObject,a._pe.PeParameter,a._pe.PePrimem,a._pe.PeProjcs,a._pe.PeSpheroid,a._pe.PeUnit];f<h.length;f++)b=h[f],c(b.prototype,"getName",function(a){return function(){return a.call(this,Array(t.PE_NAME_MAX))}});f=0;for(h=[a._pe.PeGeogtran,a._pe.PeProjcs];f<h.length;f++)b=h[f],c(b.prototype,"getParameters",function(b){return function(){for(var c=Array(t.PE_PARM_MAX),e=b.call(this),h=0;h<c.length;h++){var f=a._pe.getValue(e,"*");c[h]=f?a._pe.wrapPointer(f,
a._pe.PeParameter):null;e+=Int32Array.BYTES_PER_ELEMENT}return c}});c(a._pe.PeHorizon.prototype,"getCoord",function(a){return function(){var b=this.getSize();if(!b)return null;var c=[],e=a.call(this);v(c,b,e);return c}});c(a._pe.PeGTlistExtendedEntry.prototype,"getEntries",function(b){var c=a._pe._pe_getPeGTlistExtendedGTsSize();return function(){var e=null,h=b.call(this);if(!a._pe.compare(h,a._pe.NULL)){var e=[h],f=this.getSteps();if(1<f)for(var h=a._pe.getPointer(h),m=1;m<f;m++)e.push(a._pe.wrapPointer(h+
c*m,a._pe.PeGTlistExtendedGTs))}return e}});var m=a._pe._pe_getPeHorizonSize();b=function(b){return function(){var c=this._cache;c||(this._cache=c=new Map);if(c.has(b))return c.get(b);var e=null,h=b.call(this);if(!a._pe.compare(h,a._pe.NULL)){var e=[h],f=h.getNump();if(1<f)for(var h=a._pe.getPointer(h),p=1;p<f;p++)e.push(a._pe.wrapPointer(h+m*p,a._pe.PeHorizon))}c.set(b,e);return e}};c(a._pe.PeProjcs.prototype,"horizonGcsGenerate",b);c(a._pe.PeProjcs.prototype,"horizonPcsGenerate",b);a._pe.PeObject.prototype.toString=
function(b){void 0===b&&(b=t.PE_STR_OPTS_NONE);a._pe.ensureCache.prepare();var c=a._pe.getPointer(this),e=a._pe.ensureInt8(Array(t.PE_BUFFER_MAX));return a._pe.UTF8ToString(a._pe._pe_object_to_string_ext(c,b,e))}}function f(b){if(b){var c=a._pe.getClass(b);c&&(c=a._pe.getCache(c))&&(b=a._pe.getPointer(b))&&delete c[b]}}function k(b,c){var e=[];c=Array(c);for(var h=0;h<b;h++)e.push(a._pe.ensureInt8(c));return e}function r(a){var b;Array.isArray(a[0])?(b=[],a.forEach(function(a){b.push(a[0],a[1])})):
b=a;return b}function v(b,c,f,h){void 0===h&&(h=!1);if(h)for(h=0;h<2*c;h++)b[h]=a._pe.getValue(f+h*Float64Array.BYTES_PER_ELEMENT,"double");else{var e=0===b.length;for(h=0;h<c;h++)e&&(b[h]=Array(2)),b[h][0]=a._pe.getValue(f,"double"),b[h][1]=a._pe.getValue(f+Float64Array.BYTES_PER_ELEMENT,"double"),f+=2*Float64Array.BYTES_PER_ELEMENT}}Object.defineProperty(a,"__esModule",{value:!0});var z;a._pe=null;a.isLoaded=function(){return!!a._pe};a.isSupported=function(){return!!n("esri-wasm")};a.load=function(){return z?
z:z=b.create(function(a,b){D(["./support/pe-wasm"],function(e){e({locateFile:function(a){return D.toUrl("./support/"+a)},onAbort:function(a){b(Error(a))}}).then(function(b){c(b);a()})})})};(function(b){function c(b,c,e){a._pe.ensureCache.prepare();var h=r(e),f=e===h,h=a._pe.ensureFloat64(h);(b=a._pe._pe_geog_to_proj(a._pe.getPointer(b),c,h))&&v(e,c,h,f);return b}function f(a,b,c){return h(a,b,c,0)}function h(b,c,e,h){a._pe.ensureCache.prepare();var f=r(e),m=e===f,f=a._pe.ensureFloat64(f);(b=a._pe._pe_proj_to_geog_center(a._pe.getPointer(b),
c,f,h))&&v(e,c,f,m);return b}b.geogToProj=c;b.projGeog=function(a,b,e,h){switch(h){case t.PE_TRANSFORM_P_TO_G:return f(a,b,e);case t.PE_TRANSFORM_G_TO_P:return c(a,b,e)}return 0};b.projToGeog=f;b.projToGeogCenter=h})(a.PeCSTransformations||(a.PeCSTransformations={}));var t;(function(b){b.init=function(){b.PE_BUFFER_MAX=a._pe.PeDefs.prototype.PE_BUFFER_MAX;b.PE_NAME_MAX=a._pe.PeDefs.prototype.PE_NAME_MAX;b.PE_MGRS_MAX=a._pe.PeDefs.prototype.PE_MGRS_MAX;b.PE_USNG_MAX=a._pe.PeDefs.prototype.PE_USNG_MAX;
b.PE_DD_MAX=a._pe.PeDefs.prototype.PE_DD_MAX;b.PE_DDM_MAX=a._pe.PeDefs.prototype.PE_DDM_MAX;b.PE_DMS_MAX=a._pe.PeDefs.prototype.PE_DMS_MAX;b.PE_UTM_MAX=a._pe.PeDefs.prototype.PE_UTM_MAX;b.PE_PARM_MAX=a._pe.PeDefs.prototype.PE_PARM_MAX;b.PE_TYPE_NONE=a._pe.PeDefs.prototype.PE_TYPE_NONE;b.PE_TYPE_GEOGCS=a._pe.PeDefs.prototype.PE_TYPE_GEOGCS;b.PE_TYPE_PROJCS=a._pe.PeDefs.prototype.PE_TYPE_PROJCS;b.PE_TYPE_GEOGTRAN=a._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;b.PE_TYPE_COORDSYS=a._pe.PeDefs.prototype.PE_TYPE_COORDSYS;
b.PE_TYPE_UNIT=a._pe.PeDefs.prototype.PE_TYPE_UNIT;b.PE_STR_OPTS_NONE=a._pe.PeDefs.prototype.PE_STR_OPTS_NONE;b.PE_STR_AUTH_NONE=a._pe.PeDefs.prototype.PE_STR_AUTH_NONE;b.PE_STR_AUTH_TOP=a._pe.PeDefs.prototype.PE_STR_AUTH_TOP;b.PE_STR_NAME_CANON=a._pe.PeDefs.prototype.PE_STR_NAME_CANON;b.PE_PARM_X0=a._pe.PeDefs.prototype.PE_PARM_X0;b.PE_PARM_ND=a._pe.PeDefs.prototype.PE_PARM_ND;b.PE_TRANSFORM_1_TO_2=a._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;b.PE_TRANSFORM_2_TO_1=a._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;
b.PE_TRANSFORM_P_TO_G=a._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;b.PE_TRANSFORM_G_TO_P=a._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;b.PE_HORIZON_RECT=a._pe.PeDefs.prototype.PE_HORIZON_RECT;b.PE_HORIZON_POLY=a._pe.PeDefs.prototype.PE_HORIZON_POLY;b.PE_HORIZON_LINE=a._pe.PeDefs.prototype.PE_HORIZON_LINE;b.PE_HORIZON_DELTA=a._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(t=a.PeDefs||(a.PeDefs={}));(function(b){function c(b,c){var e=null,m=h[b];m||(m={},h[b]=m);m.hasOwnProperty(String(c))?e=m[c]:(b=a._pe.PeFactory.prototype.factoryByType(b,
c),a._pe.compare(b,a._pe.NULL)||(e=b,m[c]=e));return e=f(e)}function f(b){if(b){var c=b.getType();switch(c){case t.PE_TYPE_GEOGCS:b=a._pe.castObject(b,a._pe.PeGeogcs);break;case t.PE_TYPE_PROJCS:b=a._pe.castObject(b,a._pe.PeProjcs);break;case t.PE_TYPE_GEOGTRAN:b=a._pe.castObject(b,a._pe.PeGeogtran);break;default:c&t.PE_TYPE_UNIT&&(b=a._pe.castObject(b,a._pe.PeUnit))}}return b}var h={},m={};b.initialize=function(){a._pe.PeFactory.prototype.initialize(null)};b.coordsys=function(a){return c(t.PE_TYPE_COORDSYS,
a)};b.factoryByType=c;b.fromString=function(b,c){var e=null,h=m[b];h||(h={},m[b]=h);h.hasOwnProperty(c)?e=h[c]:(b=a._pe.PeFactory.prototype.fromString(b,c),a._pe.compare(b,a._pe.NULL)||(e=b,h[c]=e));return e=f(e)};b.geogcs=function(a){return c(t.PE_TYPE_GEOGCS,a)};b.geogtran=function(a){return c(t.PE_TYPE_GEOGTRAN,a)};b.getCode=function(b){return a._pe.PeFactory.prototype.getCode(b)};b.projcs=function(a){return c(t.PE_TYPE_PROJCS,a)};b.unit=function(a){return c(t.PE_TYPE_UNIT,a)}})(a.PeFactory||(a.PeFactory=
{}));a.PeGCSExtent=null;var G;(function(b){var c;b.init=function(){b.PE_GTLIST_OPTS_COMMON=a._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;c=a._pe._pe_getPeGTlistExtendedEntrySize()};b.getGTlist=function(b,e,f,p,k,n){var h=null,m=new a._pe.PeInteger(n);try{var q=a._pe.PeGTlistExtended.prototype.getGTlist(b,e,f,p,k,m);if(n=m.val)if(h=[q],1<n){var E=a._pe.getPointer(q);for(b=1;b<n;b++)h.push(a._pe.wrapPointer(E+c*b,a._pe.PeGTlistExtendedEntry))}}finally{a._pe.destroy(m)}return h}})(G=a.PeGTlistExtended||
(a.PeGTlistExtended={}));(function(b){b.destroy=function(b){if(b&&b.length){for(var c=0;c<b.length;c++){var e=b[c];f(e);e.getEntries().forEach(function(a){f(a);a=a.getGeogtran();f(a);a.getParameters().forEach(f);[a.getGeogcs1(),a.getGeogcs2()].forEach(function(a){f(a);var b=a.getDatum();f(b);f(b.getSpheroid());f(a.getPrimem());f(a.getUnit())})})}a._pe.PeGTlistExtendedEntry.prototype.Delete(b[0])}}})(a.PeGTlistExtendedEntry||(a.PeGTlistExtendedEntry={}));(function(b){b.geogToGeog=function(b,c,h,f,
p){a._pe.ensureCache.prepare();var e=r(h),m=h===e,e=a._pe.ensureFloat64(e),k=0;f&&(k=a._pe.ensureFloat64(f));(b=a._pe._pe_geog_to_geog(a._pe.getPointer(b),c,e,k,p))&&v(h,c,e,m);return b}})(a.PeGTTransformations||(a.PeGTTransformations={}));(function(b){function c(b,c,e,f,q,n){a._pe.ensureCache.prepare();var h,m;switch(b){case "dd":h=a._pe._pe_geog_to_dd;m=t.PE_DD_MAX;break;case "ddm":h=a._pe._pe_geog_to_ddm;m=t.PE_DDM_MAX;break;case "dms":h=a._pe._pe_geog_to_dms,m=t.PE_DMS_MAX}b=0;c&&(b=a._pe.getPointer(c));
c=r(f);c=a._pe.ensureFloat64(c);m=k(e,m);f=a._pe.ensureInt32(m);if(q=h(b,e,c,q,f))for(h=0;h<e;h++)n[h]=a._pe.UTF8ToString(m[h]);return q}function f(b,c,e,f,k){a._pe.ensureCache.prepare();var h;switch(b){case "dd":h=a._pe._pe_dd_to_geog;break;case "ddm":h=a._pe._pe_ddm_to_geog;break;case "dms":h=a._pe._pe_dms_to_geog}b=0;c&&(b=a._pe.getPointer(c));c=f.map(function(b){return a._pe.ensureString(b)});f=a._pe.ensureInt32(c);c=a._pe.ensureFloat64(Array(2*e));(h=h(b,e,f,c))&&v(k,e,c);return h}b.geog_to_dms=
function(a,b,e,f,k){return c("dms",a,b,e,f,k)};b.dms_to_geog=function(a,b,c,e){return f("dms",a,b,c,e)};b.geog_to_ddm=function(a,b,e,f,k){return c("ddm",a,b,e,f,k)};b.ddm_to_geog=function(a,b,c,e){return f("ddm",a,b,c,e)};b.geog_to_dd=function(a,b,e,f,k){return c("dd",a,b,e,f,k)};b.dd_to_geog=function(a,b,c,e){return f("dd",a,b,c,e)}})(a.PeNotationDms||(a.PeNotationDms={}));var B;(function(b){b.init=function(){b.PE_MGRS_STYLE_NEW=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;b.PE_MGRS_STYLE_OLD=
a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;b.PE_MGRS_STYLE_AUTO=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;b.PE_MGRS_180_ZONE_1_PLUS=a._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;b.PE_MGRS_ADD_SPACES=a._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};b.geog_to_mgrs_extended=function(b,c,f,m,p,n,w){a._pe.ensureCache.prepare();var e=0;b&&(e=a._pe.getPointer(b));b=r(f);f=a._pe.ensureFloat64(b);b=k(c,t.PE_MGRS_MAX);var h=a._pe.ensureInt32(b);if(m=a._pe._pe_geog_to_mgrs_extended(e,
c,f,m,p,n,h))for(p=0;p<c;p++)w[p]=a._pe.UTF8ToString(b[p]);return m};b.mgrs_to_geog_extended=function(b,c,f,m,k){a._pe.ensureCache.prepare();var e=0;b&&(e=a._pe.getPointer(b));b=f.map(function(b){return a._pe.ensureString(b)});f=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*c));(m=a._pe._pe_mgrs_to_geog_extended(e,c,f,m,b))&&v(k,c,b);return m}})(B=a.PeNotationMgrs||(a.PeNotationMgrs={}));(function(b){b.geog_to_usng=function(b,c,f,m,p,n,w){a._pe.ensureCache.prepare();var e=0;b&&(e=a._pe.getPointer(b));
b=r(f);f=a._pe.ensureFloat64(b);b=k(c,t.PE_MGRS_MAX);var h=a._pe.ensureInt32(b);if(m=a._pe._pe_geog_to_usng(e,c,f,m,p,n,h))for(p=0;p<c;p++)w[p]=a._pe.UTF8ToString(b[p]);return m};b.usng_to_geog=function(b,c,f,m){a._pe.ensureCache.prepare();var e=0;b&&(e=a._pe.getPointer(b));b=f.map(function(b){return a._pe.ensureString(b)});f=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*c));(e=a._pe._pe_usng_to_geog(e,c,f,b))&&v(m,c,b);return e}})(a.PeNotationUsng||(a.PeNotationUsng={}));var C;(function(b){b.init=
function(){b.PE_UTM_OPTS_NONE=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;b.PE_UTM_OPTS_ADD_SPACES=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;b.PE_UTM_OPTS_NS=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};b.geog_to_utm=function(b,c,f,m,p){a._pe.ensureCache.prepare();var e=0;b&&(e=a._pe.getPointer(b));b=r(f);f=a._pe.ensureFloat64(b);b=k(c,t.PE_UTM_MAX);var h=a._pe.ensureInt32(b);if(m=a._pe._pe_geog_to_utm(e,c,f,m,h))for(e=0;e<c;e++)p[e]=a._pe.UTF8ToString(b[e]);return m};b.utm_to_geog=
function(b,c,f,m,k){a._pe.ensureCache.prepare();var e=0;b&&(e=a._pe.getPointer(b));b=f.map(function(b){return a._pe.ensureString(b)});f=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*c));(m=a._pe._pe_utm_to_geog(e,c,f,m,b))&&v(k,c,b);return m}})(C=a.PeNotationUtm||(a.PeNotationUtm={}));var I;(function(b){var c=new Map;b.init=function(){b.PE_PCSINFO_OPTION_NONE=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;b.PE_PCSINFO_OPTION_DOMAIN=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;b.PE_POLE_OUTSIDE_BOUNDARY=
a._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;b.PE_POLE_POINT=a._pe.PePCSInfo.prototype.PE_POLE_POINT};b.generate=function(e,f){void 0===f&&(f=b.PE_PCSINFO_OPTION_DOMAIN);var h,k;c.has(e)&&(k=c.get(e),k[f]&&(h=k[f]));h||(h=a._pe.PePCSInfo.prototype.generate(e,f),k||(k=[],c.set(e,k)),k[f]=h);return h}})(I=a.PePCSInfo||(a.PePCSInfo={}));(function(b){b.version_string=function(){return a._pe.PeVersion.prototype.version_string()}})(a.PeVersion||(a.PeVersion={}));a._init=c})},"esri/geometry/support/GeographicTransformation":function(){define(["require",
"exports","./GeographicTransformationStep"],function(D,a,u){return function(){function a(a){this.steps=[];this._cached_projection={};this._chain="";this._gtlistentry=null;if(a&&a.steps){var b=0;for(a=a.steps;b<a.length;b++){var f=a[b];f instanceof u?this.steps.push(f):this.steps.push(new u({wkid:f.wkid,wkt:f.wkt,isInverse:f.isInverse}))}}}a.cacheKey=function(a,c){return[void 0!==a.wkid&&null!==a.wkid?a.wkid.toString():"-1",void 0!==a.wkt&&null!==a.wkt?a.wkt.toString():"",void 0!==c.wkid&&null!==c.wkid?
c.wkid.toString():"-1",void 0!==c.wkt&&null!==c.wkt?c.wkt.toString():""].join()};a.fromGE=function(b){var c=new a,f="",k=0;for(b=b.steps;k<b.length;k++){var n=u.fromGE(b[k]);c.steps.push(n);f+=n.uid.toString()+","}c._cached_projection={};c._gtlistentry=null;c._chain=f;return c};a.prototype.getInverse=function(){var b=new a;b.steps=[];for(var c=this.steps.length-1;0<=c;c--)b.steps.push(this.steps[c].getInverse());return b};a.prototype.getGTListEntry=function(){for(var a="",c=0,f=this.steps;c<f.length;c++)a+=
f[c].uid.toString()+",";a!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=a);return this._gtlistentry};a.prototype.assignCachedGe=function(b,c,f){this._cached_projection[a.cacheKey(b,c)]=f};a.prototype.getCachedGeTransformation=function(b,c){for(var f="",k=0,n=this.steps;k<n.length;k++)f+=n[k].uid.toString()+",";f!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=f);b=this._cached_projection[a.cacheKey(b,c)];return void 0===b?null:b};return a}()})},
"esri/geometry/support/GeographicTransformationStep":function(){define(["require","exports"],function(D,a){var u=0;return function(){function a(a){void 0===a&&(a=null);this.uid=u++;a?(this._wkt=void 0!==a.wkt?a.wkt:null,this._wkid=void 0!==a.wkid?a.wkid:-1,this._isInverse=void 0!==a.isInverse?!0===a.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}a.fromGE=function(b){var c=new a;c._wkt=b.wkt;c._wkid=b.wkid;c._isInverse=b.isInverse;return c};Object.defineProperty(a.prototype,"wkt",
{get:function(){return this._wkt},set:function(a){this._wkt=a;this.uid=u++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"wkid",{get:function(){return this._wkid},set:function(a){this._wkid=a;this.uid=u++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isInverse",{get:function(){return this._isInverse},set:function(a){this._isInverse=a;this.uid=u++},enumerable:!0,configurable:!0});a.prototype.getInverse=function(){var b=new a;b._wkt=this.wkt;b._wkid=this._wkid;
b._isInverse=!this.isInverse;return b};return a}()})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["require","exports"],function(D,a){Object.defineProperty(a,"__esModule",{value:!0});a.queryCapabilities={supportsStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,
supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/iteratorUtils ../../../core/maybe ../../../core/promiseUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./AttributesBuilder ./attributeSupport ./projectionSupport ./timeSupport ./utils".split(" "),
function(D,a,u,n,b,c,f,k,r,v,z,t,G,B,C,I){Object.defineProperty(a,"__esModule",{value:!0});D=function(){function a(a,b,c){this.items=a;this.queryGeometry=b;this.definitionExpression=c.definitionExpression;this.geometryType=c.geometryType;this.hasM=c.hasM;this.hasZ=c.hasZ;this.objectIdField=c.objectIdField;this.spatialReference=c.spatialReference;this.fieldsIndex=c.fieldsIndex;this.timeInfo=c.timeInfo;this.featureAdapter=c.featureAdapter}Object.defineProperty(a.prototype,"size",{get:function(){return this.items.length},
enumerable:!0,configurable:!0});a.prototype.createQueryResponse=function(a){var b;b=a.outStatistics?a.outStatistics.some(function(a){return"exceedslimit"===a.statisticType})?this._createExceedsLimitQueryResponse(a):this._createStatisticsQueryResponse(a):this._createFeatureQueryResponse(a);a.returnQueryGeometry&&(v.isValid(a.outSR)&&!v.equals(this.queryGeometry.spatialReference,a.outSR)?b.queryGeometry=I.cleanFromGeometryEngine(u({spatialReference:a.outSR},B.project(this.queryGeometry,this.queryGeometry.spatialReference,
a.outSR))):b.queryGeometry=I.cleanFromGeometryEngine(u({spatialReference:a.outSR},this.queryGeometry)));return b};a.prototype.executeAttributesQuery=function(b){var c=G.getWhereClause(b.where,this.fieldsIndex);if(!c)return k.resolve(this);if(c.isStandardized){for(var e=0,f=[],p=0,n=this.items;p<n.length;p++){var r=n[p];c.testFeature(r,this.featureAdapter)&&(f[e++]=r)}c=new a(f,this.queryGeometry,this);c.definitionExpression=b.where;return k.resolve(c)}return k.reject(new TypeError("Where clause is not standardized"))};
a.prototype.executeObjectIdsQuery=function(b){if(!b.objectIds||!b.objectIds.length)return k.resolve(this);var e=c.createSetFromValues(b.objectIds),f=this.featureAdapter.getObjectId;return k.resolve(new a(this.items.filter(function(a){return e.has(f(a))}),this.queryGeometry,this))};a.prototype.executeTimeQuery=function(b){b=C.getTimeOperator(this.timeInfo,b.timeExtent,this.featureAdapter);if(!f.isSome(b))return k.resolve(this);b=this.items.filter(b);return k.resolve(new a(b,this.queryGeometry,this))};
a.prototype.project=function(c){return b(this,void 0,void 0,function(){var b,e,f,k=this;return n(this,function(h){switch(h.label){case 0:if(!c||v.equals(this.spatialReference,c))return[2,this];b=this.featureAdapter;return[4,B.projectMany(this.items.map(function(a){return I.getGeometry(k,b.getGeometry(a))}),this.spatialReference,c)];case 1:return e=h.sent(),f=e.map(function(a,c){return b.cloneWithGeometry(k.items[c],z.convertFromGeometry(a,k.hasZ,k.hasM))}),[2,new a(f,this.queryGeometry,{definitionExpression:this.definitionExpression,
geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:c,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})]}})})};a.prototype._createFeatureQueryResponse=function(a){var b=this,c=this.items,e=this.geometryType,f=this.hasM,k=this.hasZ,n=this.objectIdField,t=this.spatialReference,v=a.outFields,G=a.outSR,Q=a.quantizationParameters,H=a.resultRecordCount,l=a.resultOffset,F=a.returnZ,B=a.returnM,z=!1;null!=H&&
null!=l&&(H=l+H,z=c.length>H,c=c.slice(l,Math.min(c.length,H)));return{exceededTransferLimit:z,features:this._createFeatures(a,c),fields:v&&v.map(function(a){return b.fieldsIndex.get(a)}),geometryType:e,hasM:f&&B,hasZ:k&&F,objectIdFieldName:n,spatialReference:I.cleanFromGeometryEngine(G?G:t),transform:Q&&r.toQuantizationTransform(Q)||null}};a.prototype._createFeatures=function(a,b){var c=new t.default(a,this.featureAdapter,this.fieldsIndex),e=a.orderByFields,f=a.quantizationParameters,k=a.returnGeometry,
n=a.returnCentroid,q=a.maxAllowableOffset,v=a.returnZ;a=a.returnM;var G=this.hasZ&&(void 0===v?!1:v),Q=this.hasM&&(void 0===a?!1:a),v=[];a=0;if(b.length&&e&&e.length){var e=e[0].split(" "),H=e[0],l=this.fieldsIndex.get(H),F="DESC"===e[1];b.sort(function(a,b){a=c.getFieldValue(a,H,l);b=c.getFieldValue(b,H,l);if("number"===typeof a&&"number"===typeof b)return F?b-a:a-b;if("string"===typeof a&&"string"===typeof b)return a=a.toUpperCase(),b=b.toUpperCase(),(F?a>b:a<b)?-1:(F?a<b:a>b)?1:0})}if(k||n)if(f=
r.toQuantizationTransform(f),k&&!n)for(n=0;n<b.length;n++)k=b[n],v[a++]={attributes:c.getAttributes(k),geometry:I.getGeometry(this,this.featureAdapter.getGeometry(k),q,f,G,Q)};else if(!k&&n)for(q=0;q<b.length;q++)k=b[q],v[a++]={attributes:c.getAttributes(k),centroid:I.transformCentroid(this,this.featureAdapter.getCentroid(k,this),f)};else for(n=0;n<b.length;n++)k=b[n],v[a++]={attributes:c.getAttributes(k),centroid:I.transformCentroid(this,this.featureAdapter.getCentroid(k,this),f),geometry:I.getGeometry(this,
this.featureAdapter.getGeometry(k),q,f,G,Q)};else for(q=0;q<b.length;q++)k=b[q],(G=c.getAttributes(k))&&(v[a++]={attributes:G});return v};a.prototype._createExceedsLimitQueryResponse=function(a){var b=!1,c=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,b=Number.POSITIVE_INFINITY,f=0;for(a=a.outStatistics;f<a.length;f++){var k=a[f];if("exceedslimit"===k.statisticType){c=null!=k.maxPointCount?k.maxPointCount:Number.POSITIVE_INFINITY;e=null!=k.maxRecordCount?k.maxRecordCount:Number.POSITIVE_INFINITY;
b=null!=k.maxVertexCount?k.maxVertexCount:Number.POSITIVE_INFINITY;break}}if("esriGeometryPoint"===this.geometryType)b=this.items.length>c;else if(this.items.length>e)b=!0;else var c=this.hasZ?this.hasM?4:3:this.hasM?3:2,n=this.featureAdapter,b=this.items.reduce(function(a,b){b=n.getGeometry(b);return a+(b&&b.coords.length||0)},0)/c>b;return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(b)}}]}};
a.prototype._createStatisticsQueryResponse=function(a){var b=new t.default(a,this.featureAdapter,this.fieldsIndex),c=a.outStatistics,e=[],f=[],k=a.groupByFieldsForStatistics;a=a.having;for(var n=k&&k.length,k=n&&k[0],r=this.fieldsIndex.get(k),v=!r,G={},Q={},H={},l={attributes:{}},F=0;F<c.length;F++){var z=c[F],B=z.outStatisticFieldName,u=z.statisticType,z="exceedslimit"!==u?z.onStatisticField:void 0,A=this.fieldsIndex.get(z),C=n&&(z===k||v)&&"count"===u;if(n){G[z]||(G[z]=this._calculateUniqueValues(b,
k,r));var D=G[z],I;for(I in D){var ba=D[I],W=ba.count,Y=ba.data,L=ba.items;if(!a||b.validateItems(L,a)){var ba=Q[Y]||{attributes:{}},S=null;C?S=W:(W=this._calculateStatistics(L,b,z,A),L="var"===u?"variance":u,S=W[L]);ba.attributes[B]=S;ba.attributes[v?"EXPR_1":k]=Y;Q[Y]=ba}}}else H[z]||(H[z]=this._calculateStatistics(this.items,b,z,A)),W=H[z],L="var"===u?"variance":u,l.attributes[B]=W[L];f.push({name:B,alias:B,type:"esriFieldTypeDouble"})}if(n)for(var X in Q)e.push(Q[X]);else e.push(l);return{fields:f,
features:e}};a.prototype._calculateStatistics=function(a,b,c,f){for(var e=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,k=null,m=null,n=null,q=null,r=[],t=0,l=0;l<a.length;l++){var v=b.getFieldValue(a[l],c,f);"string"===typeof v?t++:null==v||isNaN(v)||(k+=v,e=Math.min(e,v),h=Math.max(h,v),r.push(v),t++)}if(t){m=k/t;for(b=a=0;b<r.length;b++)v=r[b],a+=Math.pow(v-m,2);q=1<t?a/(t-1):0;n=Math.sqrt(q)}else h=e=null;return{avg:m,count:t,max:h,min:e,stddev:n,sum:k,variance:q}};a.prototype._calculateUniqueValues=
function(a,b,c){for(var e={},f=0,h=this.items;f<h.length;f++){var k=h[f],n=a.getFieldValue(k,b,c);if(null==n||"string"===typeof n&&""===n.trim())n=null;null==e[n]?e[n]={count:1,data:n,items:[k]}:(e[n].count++,e[n].items.push(k))}return e};return a}();a.default=D})},"esri/layers/graphics/data/AttributesBuilder":function(){define(["require","exports","../../../core/maybe","./attributeSupport"],function(D,a,u,n){Object.defineProperty(a,"__esModule",{value:!0});D=function(){function a(a,b,k){this._fieldDataCache=
new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=a.returnDistinctValues;this.fieldsIndex=k;this.featureAdapter=b;if((a=a.outFields)&&-1===a.indexOf("*")){this.outFields=a;for(var c=b=0;c<a.length;c++){var f=a[c],z=n.getExpressionFromFieldName(f),t=this.fieldsIndex.get(z),z=t?null:n.getWhereClause(z,k),t=t?t.name:n.getAliasFromFieldName(f)||"FIELD_EXP_"+b++;this._fieldDataCache.set(f,{alias:t,clause:z})}}}a.prototype.getAttributes=function(a){a=this._processAttributesForOutFields(a);
return this._processAttributesForDistinctValues(a)};a.prototype.getFieldValue=function(a,b,k){var c=k?k.name:b,f=null;this._fieldDataCache.has(c)?f=this._fieldDataCache.get(c).clause:k||(f=n.getWhereClause(b,this.fieldsIndex),this._fieldDataCache.set(c,{alias:c,clause:f}));return k?this.featureAdapter.getAttribute(a,c):f.calculateValue(a,this.featureAdapter)};a.prototype.validateItem=function(a,b){this._fieldDataCache.has(b)||this._fieldDataCache.set(b,{alias:b,clause:n.getWhereClause(b,this.fieldsIndex)});
return this._fieldDataCache.get(b).clause.testFeature(a,this.featureAdapter)};a.prototype.validateItems=function(a,b){this._fieldDataCache.has(b)||this._fieldDataCache.set(b,{alias:b,clause:n.getWhereClause(b,this.fieldsIndex)});return this._fieldDataCache.get(b).clause.testSet(a,this.featureAdapter)};a.prototype._processAttributesForOutFields=function(a){var b=this.outFields;if(!b||!b.length)return this.featureAdapter.getAttributes(a);for(var c={},n=0;n<b.length;n++){var v=this._fieldDataCache.get(b[n]),
z=v.alias,v=v.clause;c[z]=v?v.calculateValue(a,this.featureAdapter):this.featureAdapter.getAttribute(a,z)}return c};a.prototype._processAttributesForDistinctValues=function(a){if(u.isNone(a)||!this.returnDistinctValues)return a;var b=this.outFields,c=[];if(b)for(var n=0;n<b.length;n++){var v=this._fieldDataCache.get(b[n]).alias;c.push(a[v])}else for(v in a)c.push(a[v]);b=(b||["*"]).join(",")+"\x3d"+c.join(",");c=this._returnDistinctMap.get(b)||0;this._returnDistinctMap.set(b,++c);return 1<c?null:
a};return a}();a.default=D})},"esri/layers/graphics/data/timeSupport":function(){define(["require","exports"],function(D,a){function u(a,c,f,k,n){if(null!=k&&null!=n&&k===n)return function(b){return k>=a.getAttribute(b,c)&&k<=a.getAttribute(b,f)};if(null!=k&&null!=n)return function(b){var r=a.getAttribute(b,c);b=a.getAttribute(b,f);return!(r>n||b<k)};if(null!=k)return function(b){return!(a.getAttribute(b,f)<k)};if(null!=n)return function(b){return!(a.getAttribute(b,c)>n)}}function n(a,c,f,k){if(null!=
f&&null!=k&&f===k)return function(b){return a.getAttribute(b,c)===f};if(null!=f&&null!=k)return function(b){return a.getAttribute(b,c)>=f&&a.getAttribute(b,c)<=k};if(null!=f)return function(b){return a.getAttribute(b,c)>=f};if(null!=k)return function(b){return a.getAttribute(b,c)<=k}}Object.defineProperty(a,"__esModule",{value:!0});a.getTimeExtent=function(a,c){if(!a)return null;var b=c.featureAdapter,k=a.startTimeField,n=a.endTimeField,v=Number.POSITIVE_INFINITY,z=Number.NEGATIVE_INFINITY;if(k&&
n)c.forEach(function(a){var c=b.getAttribute(a,k);a=b.getAttribute(a,n);null==c||isNaN(c)||(v=Math.min(v,c));null==a||isNaN(a)||(z=Math.max(z,a))});else{var t=k||n;c.forEach(function(a){a=b.getAttribute(a,t);null==a||isNaN(a)||(v=Math.min(v,a),z=Math.max(z,a))})}return{start:v,end:z}};a.getTimeOperator=function(a,c,f){if(!c||!a)return null;var b=a.startTimeField;a=a.endTimeField;if(!b&&!a)return null;var r=c.start;c=c.end;return null==r&&null==c?null:b&&a?u(f,b,a,r,c):n(f,b||a,r,c)}})},"esri/layers/graphics/data/utils":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/jsonMap ../../../core/maybe ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../centroid ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./spatialQuerySupport".split(" "),
function(D,a,u,n,b,c,f,k,r,v,z,t,G,B,C,I,A){function e(a,b,c,e,f){void 0===e&&(e=a.hasZ);void 0===f&&(f=a.hasM);var h=a.hasZ&&e,l=a.hasM&&f;return c?(a=B.quantizeOptimizedGeometry(w,b,a.hasZ,a.hasM,"esriGeometryPoint",c,e,f),B.convertToPoint(a,h,l)):B.convertToPoint(b,h,l)}function q(b,e,f){return n(this,void 0,void 0,function(){var l,k,m,p,n,q;return u(this,function(t){switch(t.label){case 0:if(!b)return[2,null];l=b.where;b.where=l=l&&l.trim();if(!l||/^1 *= *1$/.test(l)||e&&e===l)b.where=null;return b.geometry?
[4,h(b)]:[2,b];case 1:return k=t.sent(),b.distance=0,b.units=null,"esriSpatialRelEnvelopeIntersects"===b.spatialRel&&(m=b.geometry.spatialReference,k=r.getGeometryExtent(k),k.spatialReference=m),b.geometry=k,[4,I.checkProjectionSupport(k.spatialReference,f)];case 2:return t.sent(),[4,z.normalizeCentralMeridian(v.fromJSON(k))];case 3:p=t.sent()[0];if(c.isNone(p))throw a.QUERY_ENGINE_EMPTY_RESULT;n=p.toJSON();return[4,I.project(n,n.spatialReference,f)];case 4:q=t.sent();if(!q)throw a.QUERY_ENGINE_EMPTY_RESULT;
q.spatialReference=f;b.geometry=q;return[2,b]}})})}function h(a){return n(this,void 0,void 0,function(){var b,c,e,h,p,n,q,r,v,w;return u(this,function(l){switch(l.label){case 0:b=a.geometry;c=a.distance;e=a.units;if(null==c)return[2,f.resolve(b)];h=b.spatialReference;p=e&&m.fromJSON(e)||k.getUnitString(h);n=h&&(t.isGeographic(h)||t.isWebMercator(h));if(!n)return[3,1];r=b;return[3,3];case 1:return[4,I.checkProjectionSupport(h,t.WGS84).then(function(){return I.project(b,t.WGS84)})];case 2:r=l.sent(),
l.label=3;case 3:return q=r,[4,A.getGeodesicBufferOperator()];case 4:return v=l.sent(),w=v(q,c,p),[2,w?w.toJSON():null]}})})}Object.defineProperty(a,"__esModule",{value:!0});var m=new b.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});a.QUERY_ENGINE_EMPTY_RESULT=Object.freeze({});var p=new C.default,E=new C.default,w=new C.default,K={esriGeometryPoint:B.convertToPoint,
esriGeometryPolyline:B.convertToPolyline,esriGeometryPolygon:B.convertToPolygon,esriGeometryMultipoint:B.convertToMultipoint};a.transformCentroid=e;a.getCentroid=function(a,b,c){if("esriGeometryPolygon"!==a.geometryType||!b||!b.centroid&&!b.geometry)return null;b.centroid||(b.centroid=G.getCentroidOptimizedGeometry(new C.default,b.geometry,a.hasZ,a.hasM));return e(a,b.centroid,c)};a.getGeometry=function(a,b,c,e,f,h){void 0===f&&(f=a.hasZ);void 0===h&&(h=a.hasM);var l=a.hasZ&&f,k=a.hasM&&h;b=b?"coords"in
b?b:b.geometry:null;if(!b)return null;if(c)return c=B.generalizeOptimizedGeometry(E,b,a.hasZ,a.hasM,a.geometryType,c,f,h),e&&(c=B.quantizeOptimizedGeometry(w,c,l,k,a.geometryType,e)),K[a.geometryType](c,l,k);if(e)return c=B.quantizeOptimizedGeometry(w,b,a.hasZ,a.hasM,a.geometryType,e,f,h),K[a.geometryType](c,l,k);B.removeZMValues(p,b,a.hasZ,a.hasM,f,h);return K[a.geometryType](p,l,k)};a.normalizeQuery=function(a,b,c){return n(this,void 0,void 0,function(){var e,f,h,l,k;return u(this,function(m){e=
a.outFields;f=a.orderByFields;h=a.groupByFieldsForStatistics;l=a.outStatistics;if(e)for(k=0;k<e.length;k++)e[k]=e[k].trim();if(f)for(k=0;k<f.length;k++)f[k]=f[k].trim();if(h)for(k=0;k<h.length;k++)h[k]=h[k].trim();if(l)for(k=0;k<l.length;k++)l[k].onStatisticField&&(l[k].onStatisticField=l[k].onStatisticField.trim());a.geometry&&!a.outSR&&(a.outSR=a.geometry.spatialReference);return[2,q(a,b,c)]})})};a.normalizeFilter=function(a,b,c){return n(this,void 0,void 0,function(){return u(this,function(e){return[2,
q(a,b,c)]})})};a.normalizeQueryLike=q;a.cleanFromGeometryEngine=function(a){return a&&aa in a?JSON.parse(JSON.stringify(a,ia)):a};var aa="_geVersion",ia=function(a,b){return a!==aa?b:void 0}})},"esri/layers/graphics/centroid":function(){define(["require","exports"],function(D,a){function u(a,c,f,k,n,v){v=n?v?4:3:v?3:2;var b=f,t=f+v,r=0,u=0,C=f=0,D=0,A=0;for(--k;A<k;A++,b+=v,t+=v){var e=c[b],q=c[b+1],h=c[b+2],m=c[t],p=c[t+1],E=c[t+2],w=e*p-m*q,C=C+w,r=r+(e+m)*w,u=u+(q+p)*w;n&&(w=e*E-m*h,f+=(h+E)*w,
D+=w);e<a[0]&&(a[0]=e);e>a[1]&&(a[1]=e);q<a[2]&&(a[2]=q);q>a[3]&&(a[3]=q);n&&(h<a[4]&&(a[4]=h),h>a[5]&&(a[5]=h))}0<C&&(C*=-1);0<D&&(D*=-1);if(!C)return null;a=[r,u,.5*C];n&&(a[3]=f,a[4]=.5*D);return a}function n(a,c,f,k,n){n=k?n?4:3:n?3:2;for(var b=c,r=c+n,t=0,u=0,B=0,C=0,D=0,A=f-1;D<A;D++,b+=n,r+=n){var e=a[b],q=a[b+1],h=a[b+2],m=a[r],p=a[r+1],E=a[r+2],w;if(k){w=m-e;var K=p-q,aa=E-h;w=Math.sqrt(w*w+K*K+aa*aa)}else w=m-e,K=p-q,w=Math.sqrt(w*w+K*K);w&&(t+=w,k?(e=[e+.5*(m-e),q+.5*(p-q),h+.5*(E-h)],
u+=w*e[0],B+=w*e[1],C+=w*e[2]):(e=[e+.5*(m-e),q+.5*(p-q)],u+=w*e[0],B+=w*e[1]))}return 0<t?k?[u/t,B/t,C/t]:[u/t,B/t]:0<f?k?[a[c],a[c+1],a[c+2]]:[a[c],a[c+1]]:null}Object.defineProperty(a,"__esModule",{value:!0});a.getCentroidOptimizedGeometry=function(a,c,f,k){if(!c||!c.lengths.length)return null;a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);for(var b=a.coords,v=[],z=f?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,
Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],t=c.lengths,G=c.coords,B=f?k?4:3:k?3:2,C=0,D=0;D<t.length;D++){var A=t[D],e=u(z,G,C,A,f,k);e&&v.push(e);C+=A*B}v.sort(function(a,b){var c=a[2]-b[2];0===c&&f&&(c=a[4]-b[4]);return c});v.length&&(B=6*v[0][2],b[0]=v[0][0]/B,b[1]=v[0][1]/B,f&&(B=6*v[0][4],b[2]=0!==B?v[0][3]/B:0),b[0]<z[0]||b[0]>z[1]||b[1]<z[2]||b[1]>z[3]||f&&(b[2]<z[4]||b[2]>z[5]))&&
(b.length=0);if(!b.length)if(c=c.lengths[0]?n(G,0,t[0],f,k):null)b[0]=c[0],b[1]=c[1],f&&2<c.length&&(b[2]=c[2]);else return null;return a};a.lineCentroid=n})},"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/promiseUtils ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./utils".split(" "),
function(D,a,u,n,b,c,f,k,r,v,z,t,G,B,C){function I(){return c.create(function(a){return D(["../../../geometry/geometryEngine"],a)})}Object.defineProperty(a,"__esModule",{value:!0});var A={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",
esriSpatialRelRelation:null},e={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},q={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},h={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,
esriGeometryPolygon:!0,esriGeometryEnvelope:!1};a.importGeometryEngine=I;a.getGeodesicBufferOperator=function(){return I().then(function(a){return a.geodesicBuffer})};a.getSpatialQueryOperator=function(a,b,e){if(r.isPolygon(b)&&"esriGeometryPoint"===e.geometryType&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a)){var h=t.convertFromPolygon(new G.default,b,!1,!1);return c.resolve(function(a){return z.polygonContainsPoint(h,!1,!1,a)})}if(r.isPolygon(b)&&"esriGeometryMultipoint"===e.geometryType){var m=
t.convertFromPolygon(new G.default,b,!1,!1);if("esriSpatialRelContains"===a)return c.resolve(function(a){return z.polygonContainsMultipoint(m,!1,!1,a,e.hasZ,e.hasM)})}if(r.isExtent(b)&&"esriGeometryPoint"===e.geometryType&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a))return c.resolve(function(a){return f.extentContainsPoint(b,C.getGeometry(e,a))});if(r.isExtent(b)&&"esriGeometryMultipoint"===e.geometryType&&"esriSpatialRelContains"===a)return c.resolve(function(a){return f.extentContainsMultipoint(b,
C.getGeometry(e,a))});if(r.isExtent(b)&&"esriSpatialRelIntersects"===a){var n=k.getExtentIntersector(e.geometryType);return c.resolve(function(a){return n(b,C.getGeometry(e,a))})}return I().then(function(c){var f=c[A[a]].bind(null,b);return function(a){return f(C.getGeometry(e,a))}})};a.checkSpatialQuerySupport=function(a,c,f){return n(this,void 0,void 0,function(){var k,m;return u(this,function(n){k=a.spatialRel;m=a.geometry;if(!m)return[2];if(!0!==e[k])throw new b("feature-store:unsupported-query",
"Unsupported query spatial relationship",{query:a});if(!v.isValid(m.spatialReference)||!v.isValid(f))return[2];if(!0!==q[r.getJsonType(m)])throw new b("feature-store:unsupported-query","Unsupported query geometry type",{query:a});if(!0!==h[c])throw new b("feature-store:unsupported-query","Unsupported layer geometry type",{query:a});return a.outSR?[2,B.checkProjectionSupport(a.geometry&&a.geometry.spatialReference,a.outSR)]:[2]})})};a.canQueryWithRBush=function(a){if(r.isExtent(a))return!0;if(r.isPolygon(a)){var b=
0;for(a=a.rings;b<a.length;b++){var c=a[b];if(5!==c.length||c[0][0]!==c[1][0]||c[0][0]!==c[4][0]||c[2][0]!==c[3][0]||c[0][1]!==c[3][1]||c[0][1]!==c[4][1]||c[1][1]!==c[2][1])return!1}return!0}return!1}})},"esri/layers/graphics/contains":function(){define(["require","exports"],function(D,a){function u(a,b,c,f,k){if(!a)return!1;b=b?c?4:3:c?3:2;c=a.coords;var n=!1,v=0,u=0;for(a=a.lengths;u<a.length;u++){for(var t=a[u],G=v,B=v,C=v+t*b;B<C;B+=b){G=B+b;G===C&&(G=v);var D=c[B],A=c[B+1],e=c[G],G=c[G+1];(A<
k&&G>=k||G<k&&A>=k)&&D+(k-A)/(G-A)*(e-D)<f&&(n=!n)}v+=t*b}return n}Object.defineProperty(a,"__esModule",{value:!0});a.polygonContainsPoint=function(a,b,c,f){return u(a,b,c,f.coords[0],f.coords[1])};a.polygonContainsMultipoint=function(a,b,c,f,k,r){k=k?r?4:3:r?3:2;r=f.coords;f=f.lengths;if(!f)return!1;for(var n=0,z=0;n<f.length;n++,z+=k)if(!u(a,b,c,r[z],r[z+1]))return!1;return!0};a.polygonContainsCoords=u})},"esri/layers/support/PromiseQueue":function(){define(["require","exports","../../core/promiseUtils"],
function(D,a,u){Object.defineProperty(a,"__esModule",{value:!0});D=function(){function a(){this._deferreds=[];this._values=[]}a.prototype.push=function(a){var b=this;return u.create(function(c,k){b._deferreds.push({resolve:c,reject:k});b._values.push(a)})};a.prototype.unshift=function(a){var b=this;return u.create(function(c,k){b._deferreds.unshift({resolve:c,reject:k});b._values.unshift(a)})};Object.defineProperty(a.prototype,"length",{get:function(){return this._deferreds.length},enumerable:!0,
configurable:!0});a.prototype.process=function(){if(0===this.length)return!1;this._deferreds.shift().resolve(this._values.shift());return!0};a.prototype.cancelAll=function(){for(var a=u.createAbortError(),c=0,f=this._deferreds;c<f.length;c++)f[c].reject(a);this._deferreds.length=0;this._values.length=0};return a}();a.PromiseQueue=D})},"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":function(){define(["require","exports","../centroid","../OptimizedFeature","../OptimizedGeometry"],function(D,
a,u,n,b){Object.defineProperty(a,"__esModule",{value:!0});a.optimizedFeatureQueryEngineAdapter={getObjectId:function(a){return a.objectId},getAttributes:function(a){return a.attributes},getAttribute:function(a,b){return a.attributes[b]},cloneWithGeometry:function(a,b){return new n.default(b,a.attributes,null,a.objectId)},getGeometry:function(a){return a.geometry},getCentroid:function(a,f){a.centroid||(a.centroid=u.getCentroidOptimizedGeometry(new b.default,a.geometry,f.hasZ,f.hasM));return a.centroid}};
a.default=a.optimizedFeatureQueryEngineAdapter})},"esri/layers/graphics/sources/support/clientSideDefaults":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/has ../../../../core/lang ../../../../symbols/support/defaultsJSON".split(" "),function(D,a,u,n,b,c){Object.defineProperty(a,"__esModule",{value:!0});a.createDrawingInfo=function(a){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===a||"esriGeometryMultipoint"===a?c.defaultPointSymbolJSON:"esriGeometryPolyline"===
a?c.defaultPolylineSymbolJSON:c.defaultPolygonSymbolJSON}}};a.createDefaultAttributesFunction=function(a,b){if(n("csp-restrictions"))return function(){var c;return u((c={},c[b]=null,c),a)};try{var c="this."+b+" \x3d null;",f;for(f in a)c+="this."+f+" \x3d "+JSON.stringify(a[f])+";";var k=new Function(c);return function(){return new k}}catch(t){return function(){var c;return u((c={},c[b]=null,c),a)}}};a.createDefaultTemplate=function(a){void 0===a&&(a={});return[{name:"New Feature",description:"",
prototype:{attributes:b.clone(a)}}]}})},"esri/layers/graphics/sources/support/sourceUtils":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../support/fieldUtils @dojo/framework/shim/Promise".split(" "),function(D,a,u,n,b){function c(a){return new r(a)}function f(){return n(this,void 0,void 0,function(){return u(this,function(a){switch(a.label){case 0:return t?[2,t]:[4,new Promise(function(a,b){D(["../../../../geometry/geometryEngine"],
a,b)})];case 1:return t=a.sent(),[2,t]}})})}Object.defineProperty(a,"__esModule",{value:!0});var k=function(){return function(){this.description=this.code=null}}(),r=function(){return function(a){this.error=new k;this.objectId=this.globalId=null;this.success=!1;this.uniqueId=null;this.error.description=a}}();a.createFeatureEditErrorResult=c;var v=function(){return function(a){this.globalId=null;this.success=!0;this.objectId=this.uniqueId=a}}();a.createFeatureEditSuccessResult=function(a){return new v(a)};
var z=new Set;a.mixAttributes=function(a,f,k,n,t,e){void 0===t&&(t=!1);z.clear();for(var q in n){var h=a.get(q);if(h){var m=n[q],p;p=h;var r=m,w=r;"string"===typeof r&&b.isNumericField(p)?w=parseFloat(r):null!=r&&b.isStringField(p)&&"string"!==typeof r&&(w=String(r));p=b.sanitizeNullFieldValue(w);p!==m&&e&&e.push({name:"invalid-value-type",message:"attribute value was converted to match the field type",details:{field:h,originalValue:m,sanitizedValue:p}});z.add(h.name);if(h&&(t||h.editable)){if(m=
b.validateFieldValue(h,p))return c(b.validationErrorToString(m,h,p));k[h.name]=p}}}for(a=0;a<f.length;a++)if(k=f[a],!z.has(k.name))return c('missing required field "'+k.name+'"');return null};var t;a.simplify=function(a,b){if(!a)return a;if("rings"in a||"paths"in a){if(!t)throw new TypeError("geometry engine not loaded");a.spatialReference||(a.spatialReference=b);return(a=t.simplify(a))?a.toJSON():null}return a};a.loadGeometryEngine=f;a.loadGeometryEngineForSimplify=function(a){return n(this,void 0,
void 0,function(){return u(this,function(b){switch(b.label){case 0:return"esriGeometryPolygon"!==a&&"esriGeometryPolyline"!==a?[3,2]:[4,f()];case 1:b.sent(),b.label=2;case 2:return[2]}})})}})},"*noref":1}});
define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/tsSupport/assignHelper ../../../../core/Error ../../../../core/promiseUtils ../../../../geometry/support/jsonUtils ../../../../geometry/support/spatialReferenceUtils ../../featureConversionUtils ../../data/FeatureStore ../../data/projectionSupport ../../data/QueryEngine ./clientSideDefaults ./sourceUtils ../../../support/FieldsIndex ../../../support/fieldType ../../../support/fieldUtils".split(" "),function(D,
a,u,n,b,c,f,k,r,v,z,t,G,B,C,I,A,e){function q(a){return k.isPoint(a)?null!=a.z:!!a.hasZ}function h(a){return k.isPoint(a)?null!=a.m:!!a.hasM}Object.defineProperty(a,"__esModule",{value:!0});var m=r.WGS84,p={xmin:-180,ymin:-90,xmax:180,ymax:90,spatialReference:r.WGS84},E={hasAttachments:!1,capabilities:"query, editing, create, delete, update",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,supportsReturningQueryGeometry:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,supportsStatistics:!0,
supportsReturningGeometryCentroid:!0,supportsQueryWithDistance:!0,supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQueryWithResultType:!1,supportsSqlExpression:!0,supportsDisjointSpatialRel:!0}};D=function(){function a(){this._nextObjectId=this._queryEngine=null}a.prototype.destroy=function(){this._queryEngine&&this._queryEngine&&this._queryEngine.destroy();this._queryEngine=this._requiredFields=
this._fieldsIndex=this._createDefaultAttributes=null};a.prototype.load=function(a){return n(this,void 0,void 0,function(){var f,h,k,n,l,q,r,v,w,C,D,K,sa,ba,W,Y,L,S,X,ha,da,la,ja,Oa,Pa,$a;return u(this,function(u){switch(u.label){case 0:f=[];h=a.features;k=this._inferLayerProperties(h,a.fields);n=a.fields||[];l=null!=a.hasM?a.hasM:k.hasM;q=null!=a.hasZ?a.hasZ:k.hasZ;v=(r=!a.spatialReference&&!k.spatialReference)?m:a.spatialReference||k.spatialReference;w=r?p:null;C=a.geometryType||k.geometryType;D=
a.objectIdField||k.objectIdField;K=a.timeInfo;r&&f.push({name:"feature-layer:spatial-reference-not-found",message:"Spatial reference not provided or found in features. Defaults to WGS84"});if(!C)throw new c("feature-layer:missing-property","geometryType not set and couldn't be inferred from the provided features");if(!D)throw new c("feature-layer:missing-property","objectIdField not set and couldn't be found in the provided fields");k.objectIdField&&D!==k.objectIdField&&(f.push({name:"feature-layer:duplicated-oid-field",
message:'Provided objectIdField "'+D+'" doesn\'t match the field name "'+k.objectIdField+'", found in the provided fields'}),D=k.objectIdField);D&&!k.objectIdField&&(sa=null,(ba=n.some(function(a){return a.name===D?(sa=a,!0):!1}))?(sa.type="esriFieldTypeOID",sa.editable=!1,sa.nullable=!1):n.unshift({alias:D,name:D,type:"esriFieldTypeOID",editable:!1,nullable:!1}));W=0;for(Y=n;W<Y.length;W++){L=Y[W];null==L.name&&(L.name=L.alias);null==L.alias&&(L.alias=L.name);if(!L.name)throw new c("feature-layer:invalid-field-name",
"field name is missing",{field:L});L.name===D&&(L.type="esriFieldTypeOID");if(-1===A.kebabDict.jsonValues.indexOf(L.type))throw new c("feature-layer:invalid-field-type",'invalid type for field "'+L.name+'"',{field:L});}S={};this._requiredFields=[];X=0;for(ha=n;X<ha.length;X++)L=ha[X],"esriFieldTypeOID"!==L.type&&"esriFieldTypeGlobalID"!==L.type&&(L.editable=null==L.editable?!0:!!L.editable,L.nullable=null==L.nullable?!0:!!L.nullable,da=e.getFieldDefaultValue(L),L.nullable||void 0!==da?S[L.name]=da:
this._requiredFields.push(L));this._fieldsIndex=new I(n);this._createDefaultAttributes=B.createDefaultAttributesFunction(S,D);K&&(K.startTimeField&&((la=this._fieldsIndex.get(K.startTimeField))?(K.startTimeField=la.name,la.type="esriFieldTypeDate"):K.startTimeField=null),K.endTimeField&&((ja=this._fieldsIndex.get(K.endTimeField))?(K.endTimeField=ja.name,ja.type="esriFieldTypeDate"):K.endTimeField=null),K.trackIdField&&((Oa=this._fieldsIndex.get(K.trackIdField))?K.trackIdField=Oa.name:(K.trackIdField=
null,f.push({name:"feature-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:K}}))),K.startTimeField||K.endTimeField||(f.push({name:"feature-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing or invalid",details:{timeInfo:K}}),K=null));Pa={warnings:f,featureErrors:[],layerDefinition:b({},E,{drawingInfo:B.createDrawingInfo(C),templates:B.createDefaultTemplate(S),extent:w,geometryType:C,objectIdField:D,fields:n,hasZ:!!q,hasM:!!l,timeInfo:K}),
assignedObjectIds:{}};this._queryEngine=new G.default({fields:n,geometryType:C,hasM:l,hasZ:q,objectIdField:D,spatialReference:v,featureStore:new z.default({geometryType:C,hasM:l,hasZ:q}),timeInfo:K});if(!h||!h.length)return this._nextObjectId=1,[2,Pa];$a=h.reduce(function(a,b){b=b.attributes&&b.attributes[D];return null==b||isNaN(b)||!isFinite(b)?a:Math.max(a,b)},0);this._nextObjectId=1+$a;return[4,t.checkProjectionSupport(h,v)];case 1:return u.sent(),[2,this._loadInitialFeatures(Pa,h)]}})})};a.prototype.applyEdits=
function(a){return n(this,void 0,void 0,function(){var b,c,e;return u(this,function(h){switch(h.label){case 0:return b=this._queryEngine,c=b.spatialReference,e=b.geometryType,[4,f.all([C.loadGeometryEngineForSimplify(e),t.checkProjectionSupport(a.adds,c),t.checkProjectionSupport(a.updates,c)])];case 1:return h.sent(),[2,this._applyEdits(a)]}})})};a.prototype.queryFeatures=function(a,b){void 0===b&&(b={});return n(this,void 0,void 0,function(){return u(this,function(c){return[2,this._queryEngine.executeQuery(a,
b.signal)]})})};a.prototype.queryFeatureCount=function(a,b){void 0===b&&(b={});return n(this,void 0,void 0,function(){return u(this,function(c){return[2,this._queryEngine.executeQueryForCount(a,b.signal)]})})};a.prototype.queryObjectIds=function(a,b){void 0===b&&(b={});return n(this,void 0,void 0,function(){return u(this,function(c){return[2,this._queryEngine.executeQueryForIds(a,b.signal)]})})};a.prototype.queryExtent=function(a,b){void 0===b&&(b={});return n(this,void 0,void 0,function(){return u(this,
function(c){return[2,this._queryEngine.executeQueryForExtent(a,b.signal)]})})};a.prototype._inferLayerProperties=function(a,b){for(var c=void 0,e=void 0,f=null,l=null,m=null,n=0;n<a.length;n++){var p=a[n].geometry;if(p&&(f||(f=k.getJsonType(p)),l||(l=p.spatialReference),null==c&&(c=q(p)),null==e&&(e=h(p)),f&&l&&null!=c&&null!=e))break}if(b&&b.length){var t=null;b.some(function(a){var b="esriFieldTypeOID"===a.type,c=!a.type&&a.name&&"objectid"===a.name.toLowerCase();t=a;return b||c})&&(m=t.name)}return{geometryType:f,
spatialReference:l,objectIdField:m,hasM:e,hasZ:c}};a.prototype._loadInitialFeatures=function(a,b){for(var c=this._queryEngine,e=c.geometryType,f=c.hasM,h=c.hasZ,m=c.objectIdField,n=c.spatialReference,c=c.featureStore,p=[],q=0;q<b.length;q++){var r=b[q];null!=r.uid&&(a.assignedObjectIds[r.uid]=-1);if(r.geometry&&e!==k.getJsonType(r.geometry))a.featureErrors.push(C.createFeatureEditErrorResult("Incorrect geometry type."));else{var u=this._createDefaultAttributes(),w=C.mixAttributes(this._fieldsIndex,
this._requiredFields,u,r.attributes,!0,a.warnings);w?a.featureErrors.push(w):(this._assignObjectId(u,r.attributes,!0),r.attributes=u,null!=r.uid&&(a.assignedObjectIds[r.uid]=r.attributes[m]),r.geometry&&(r.geometry=t.project(r.geometry,r.geometry.spatialReference,n)),p.push(r))}}c.addMany(v.convertFromFeatures([],p,e,h,f,m));a.layerDefinition.extent=this._queryEngine.fullExtent;a.layerDefinition.timeInfo&&(b=this._queryEngine.timeExtent,a.layerDefinition.timeInfo.timeExtent=[b.start,b.end]);return a};
a.prototype._applyEdits=function(a){var b=a.adds,c=a.updates;a=a.deletes;var e={addResults:[],deleteResults:[],updateResults:[],uidToObjectId:{}};b&&b.length&&this._applyAddEdits(e,b);c&&c.length&&this._applyUpdateEdits(e,c);if(a&&a.length){for(b=0;b<a.length;b++)e.deleteResults.push(C.createFeatureEditSuccessResult(a[b]));this._queryEngine.featureStore.removeManyById(a)}return{fullExtent:this._queryEngine.fullExtent,featureEditResults:e}};a.prototype._applyAddEdits=function(a,b){for(var c=a.addResults,
e=this._queryEngine,f=e.geometryType,h=e.hasM,m=e.hasZ,n=e.objectIdField,p=e.spatialReference,e=e.featureStore,q=[],r=0;r<b.length;r++){var u=b[r];if(u.geometry&&f!==k.getJsonType(u.geometry))c.push(C.createFeatureEditErrorResult("Incorrect geometry type."));else{var w=this._createDefaultAttributes(),z=C.mixAttributes(this._fieldsIndex,this._requiredFields,w,u.attributes);z?c.push(z):(this._assignObjectId(w,u.attributes),u.attributes=w,null!=u.uid&&(a.uidToObjectId[u.uid]=u.attributes[n]),u.geometry&&
(u.geometry=t.project(C.simplify(u.geometry,p),u.geometry.spatialReference,p)),q.push(u),c.push(C.createFeatureEditSuccessResult(u.attributes[n])))}}e.addMany(v.convertFromFeatures([],q,f,m,h,n))};a.prototype._applyUpdateEdits=function(a,b){a=a.updateResults;for(var c=this._queryEngine,e=c.geometryType,f=c.hasM,h=c.hasZ,m=c.objectIdField,n=c.spatialReference,c=c.featureStore,p=0;p<b.length;p++){var q=b[p],r=q.attributes,u=q.geometry,q=r&&r[m];if(null==q)a.push(C.createFeatureEditErrorResult("Identifier field "+
m+" missing"));else if(c.has(q)){var w=v.convertToFeature(c.getFeature(q),e,h,f);if(u){if(e!==k.getJsonType(u)){a.push(C.createFeatureEditErrorResult("Incorrect geometry type."));continue}w.geometry=t.project(C.simplify(u,n),u.spatialReference,n)}if(r&&(r=C.mixAttributes(this._fieldsIndex,this._requiredFields,w.attributes,r))){a.push(r);continue}c.add(v.convertFromFeature(w,e,h,f,m));a.push(C.createFeatureEditSuccessResult(q))}else a.push(C.createFeatureEditErrorResult("Feature with object id "+q+
" missing"))}};a.prototype._assignObjectId=function(a,b,c){void 0===c&&(c=!1);var e=this._queryEngine.objectIdField;c?b&&isFinite(b[e])?a[e]=b[e]:a[e]=this._nextObjectId++:a[e]=this._nextObjectId++};return a}();a.default=D});